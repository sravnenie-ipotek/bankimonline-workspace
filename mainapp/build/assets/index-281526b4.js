import{j as e}from"./ui-vendor-19e4e52b.js";import{r as I,f as ee,b as Se,j as Pe,k as Ae}from"./react-vendor-9ed0ad78.js";import{c as Re,u as $e,a as _e,W as Te,T as Y,D as O,E as J,b as he,A as Ve,d as Le,B as ze,L as Ue}from"./index-3333763f.js";import{P as Be}from"./ProgressBar-f8ded9a7.js";import{c as Ne,a as se,u as M,k as ye,F as X,m as We,d as Oe,n,o as Ze,p as He,q as Ye,r as Ge,t as Je,v as Ke,w as Qe,x as Xe,y as ea,z as aa,A as qe,B as ra,N as ta}from"./index-6e45afc9.js";import{u as fe,F as xe,b as je,a as ne,c as x,f as N,g as ve}from"./form-vendor-67b0fc1d.js";import{V as oa}from"./VideoPoster-36364f6b.js";import{A as ke,S as Ce,a as na,M as sa,U as ia,F as la,B as ca,b as da,c as ga,O as ma}from"./SourceOfIncomeModal-2f50d7a8.js";import{u as pa}from"./useDropdownData-05964376.js";import{C as c}from"./Column-a8ef8409.js";import{D as K}from"./DropdownMenu-dc5040a3.js";import{F as be}from"./FormContainer-e92386a0.js";import{F as ge}from"./FormattedInput-a9b4c8dd.js";import{R as y}from"./Row-389aebbb.js";import{C as pe}from"./Calendar-bb4f5a89.js";import{I as ua,c as me}from"./IncreasePayment-cbf5fc51.js";import{F as le}from"./FormCaption-192297af.js";import{D as we}from"./DeleteIcon-3538ba96.js";import{P as De}from"./PercentIcon-65a66346.js";import{A as Q,U as oe}from"./AddButton-23292c66.js";import{E as _a,N as Ie}from"./ExitModule-02111446.js";import{C as re}from"./Control-ea4fbaf0.js";import{b as ue,M as ha,A as fa,a as xa,O as ja,c as Fe,g as ba}from"./componentsByIncomeSource-dc390bb7.js";import{u as G}from"./i18n-vendor-e8db3f4c.js";import{D as Me}from"./DoubleButtons-a5f374ca.js";import{R as ya}from"./RowTwo-b38b6984.js";import{B as wa,P as Da,A as va}from"./PartnerPayMortgage-ee8f6548.js";import{N as Ma,B as Sa,E as Pa,A as Ba,T as qa,C as Ca,M as Ia,I as Fa,P as Na}from"./Taxes-97e3a2c4.js";import{C as Oa,a as ka,H as Ea}from"./HowMuchChildrens-9499306b.js";import{F as Aa}from"./FamilyStatus-c8680f7f.js";import{I as Ra}from"./Info-52842d63.js";import{D as $a}from"./components-vendor-66cd084e.js";import"./utils-vendor-f2764326.js";import"./state-vendor-8e443ca8.js";import"./MortgageParameters-5c900b37.js";import"./ShieldCheckIcon-7bae9c5d.js";const Ta="_container_1pft3_60",Va="_col_1pft3_66",La="_title_1pft3_143",za={"mortgage-data":"_mortgage-data_1pft3_1","mortgage-data-title":"_mortgage-data-title_1pft3_6","mortgage-data-title__text":"_mortgage-data-title__text_1pft3_20","mortgage-data-title__button":"_mortgage-data-title__button_1pft3_26","mortgage-data-form":"_mortgage-data-form_1pft3_42","mortgage-data-form__items":"_mortgage-data-form__items_1pft3_48","button-left__icon":"_button-left__icon_1pft3_54",container:Ta,col:Va,"col-1":"_col-1_1pft3_72","col-2":"_col-2_1pft3_82","col-3":"_col-3_1pft3_92","col-4":"_col-4_1pft3_102","col-5":"_col-5_1pft3_112","delete-icon":"_delete-icon_1pft3_126",title:La,delete:"_delete_1pft3_126"},f=Ne.bind(za),Ua=()=>{const[a,i]=I.useState([]),[t,s]=I.useState(null),{values:m,setFieldValue:l,errors:p,touched:_,setFieldTouched:u}=fe(),[ce,{open:de,close:ie}]=Re(!1),{isDesktop:B,isTablet:F,isMobile:A}=$e(),{t:D,i18n:ae}=G(),{getContent:d}=_e("refinance_step1");I.useEffect(()=>{i(m.mortgageData)},[m.mortgageData]);const j=()=>{const w={id:ue(a),program:"",balance:null,endDate:"",bid:null};l("mortgageData",[...a,w])},h=r=>{s(r),de()},v=()=>{if(t!==null){const r=a.filter(w=>w.id!==t);l("mortgageData",r)}ie()},S=[{value:"option_1",label:d("program_refinance_mortgage_option_1","program_refinance_mortgage_option_1")},{value:"option_2",label:d("program_refinance_mortgage_option_2","program_refinance_mortgage_option_2")},{value:"option_3",label:d("program_refinance_mortgage_option_3","program_refinance_mortgage_option_3")},{value:"option_4",label:d("program_refinance_mortgage_option_4","program_refinance_mortgage_option_4")},{value:"option_5",label:d("program_refinance_mortgage_option_5","program_refinance_mortgage_option_5")}],R=a.reduce((r,w)=>r+w.balance,0);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:f("mortgage-data"),children:[e.jsxs("div",{className:f("mortgage-data-title"),children:[e.jsx("h4",{className:f("mortgage-data-title__text"),children:d("enter_mortgage_info","enter_mortgage_info")}),_.mortgageData&&p.mortgageData&&e.jsx(ke,{filled:!0,icon:e.jsx(Te,{size:24,color:"#E76143"}),children:e.jsx("p",{children:(()=>{var o;const r=((o=m==null?void 0:m.mortgageBalance)==null?void 0:o.toLocaleString("en-US"))||"0",w=R.toLocaleString("en-US"),g=(m.mortgageBalance-R).toLocaleString("en-US");return d("error_balance",D("error_balance",{fullBalance:r,sumBalance:w,notEnoughBalance:g})).replace(/\{\{fullBalance\}\}/g,r).replace(/\{\{sumBalance\}\}/g,w).replace(/\{\{notEnoughBalance\}\}/g,g)})()})})]}),B&&e.jsxs("div",{className:f("mortgage-data-form"),children:[e.jsxs("div",{className:f("container","title"),children:[e.jsx("p",{className:f("col","col-1"),children:d("programm","programm")}),e.jsx("p",{className:f("col","col-2"),children:d("balance","balance")}),e.jsx("p",{className:f("col","col-3"),children:d("end_date","end_date")}),e.jsx("p",{className:f("col","col-4"),children:d("bid","bid")}),e.jsx("div",{className:f("col","col-5")})]}),e.jsxs("div",{className:f("mortgage-data-form__items"),children:[a.map(r=>{var w,g,b,o,q,k,E,$,T,V,L,z,U,W,Z,H;return e.jsxs("div",{className:f("container"),children:[e.jsx("div",{className:f("col","col-1"),children:e.jsx(K,{data:S,placeholder:D("calculate_mortgage_first_ph"),value:r.program,onChange:C=>{l(`mortgageData.${r.id-1}.program`,C),setTimeout(()=>u(`mortgageData.${r.id-1}.program`,!0),0)},error:((g=(w=_.mortgageData)==null?void 0:w[r.id-1])==null?void 0:g.program)&&((o=(b=p.mortgageData)==null?void 0:b[r.id-1])==null?void 0:o.program)})}),e.jsx("div",{className:f("col","col-2"),children:e.jsx(re,{placeholder:"10,000",value:r.balance,handleChange:C=>l(`mortgageData.${r.id-1}.balance`,C),onBlur:()=>u(`mortgageData.${r.id-1}.balance`),error:((k=(q=_.mortgageData)==null?void 0:q[r.id-1])==null?void 0:k.balance)&&(($=(E=p.mortgageData)==null?void 0:E[r.id-1])==null?void 0:$.balance)})}),e.jsx("div",{className:f("col","col-3"),children:e.jsx(pe,{placeholder:D("date_ph"),value:r.endDate,allowFuture:!0,blockPastDates:!0,onChange:C=>l(`mortgageData.${r.id-1}.endDate`,C),onBlur:()=>u(`mortgageData.${r.id-1}.endDate`),error:((V=(T=_.mortgageData)==null?void 0:T[r.id-1])==null?void 0:V.endDate)&&((z=(L=p.mortgageData)==null?void 0:L[r.id-1])==null?void 0:z.endDate)})}),e.jsx("div",{className:f("col","col-4"),children:e.jsx(re,{placeholder:"1",type:"numeric",value:r.bid,handleChange:C=>l(`mortgageData.${r.id-1}.bid`,C),onBlur:()=>u(`mortgageData.${r.id-1}.bid`),error:((W=(U=_.mortgageData)==null?void 0:U[r.id-1])==null?void 0:W.bid)&&((H=(Z=p.mortgageData)==null?void 0:Z[r.id-1])==null?void 0:H.bid),rightSection:e.jsx(De,{color:"#FFF"})})}),e.jsx("div",{className:f("col","col-5"),children:r.id!==1&&e.jsx(we,{onClick:()=>h(r.id),className:f("delete")})})]},r.id)}),e.jsxs("div",{className:f("container"),children:[e.jsx("div",{className:f("col","col-1"),children:e.jsx(Q,{variant:"none",color:"#FBE54D",value:d("add_programm","add_programm"),onClick:j})}),e.jsx("div",{className:f("col","col-2")}),e.jsx("div",{className:f("col","col-3")}),e.jsx("div",{className:f("col","col-4")}),e.jsx("div",{className:f("col","col-5")})]})]})]}),F&&e.jsx("div",{className:f("mortgage-data-form"),children:e.jsx("div",{className:f("mortgage-data-form__items"),children:e.jsxs(y,{children:[a.map((r,w)=>{var g,b,o,q,k,E,$,T,V,L,z,U,W,Z,H,C;return e.jsxs(I.Fragment,{children:[e.jsxs(c,{children:[e.jsx(Y,{title:`${d("programm","programm")} #${r.id}`}),e.jsx(K,{data:S,placeholder:D("calculate_mortgage_first_ph"),value:r.program,onChange:P=>{l(`mortgageData.${r.id-1}.program`,P),setTimeout(()=>u(`mortgageData.${r.id-1}.program`,!0),0)},error:((b=(g=_.mortgageData)==null?void 0:g[r.id-1])==null?void 0:b.program)&&((q=(o=p.mortgageData)==null?void 0:o[r.id-1])==null?void 0:q.program)})]}),e.jsxs(c,{children:[e.jsx(Y,{title:d("balance","balance")}),e.jsx(re,{placeholder:"10,000",value:r.balance,handleChange:P=>l(`mortgageData.${r.id-1}.balance`,P),onBlur:()=>u(`mortgageData.${r.id-1}.balance`),error:((E=(k=_.mortgageData)==null?void 0:k[r.id-1])==null?void 0:E.balance)&&((T=($=p.mortgageData)==null?void 0:$[r.id-1])==null?void 0:T.balance)})]}),e.jsx(c,{children:e.jsx(pe,{title:d("end_date","end_date"),placeholder:D("date_ph"),value:r.endDate,allowFuture:!0,blockPastDates:!0,onChange:P=>l(`mortgageData.${r.id-1}.endDate`,P),onBlur:()=>u(`mortgageData.${r.id-1}.endDate`),error:((L=(V=_.mortgageData)==null?void 0:V[r.id-1])==null?void 0:L.endDate)&&((U=(z=p.mortgageData)==null?void 0:z[r.id-1])==null?void 0:U.endDate)})}),e.jsxs(c,{children:[e.jsx(Y,{title:d("bid","bid")}),e.jsx(re,{placeholder:"1",value:r.bid,handleChange:P=>l(`mortgageData.${r.id-1}.bid`,P),onBlur:()=>u(`mortgageData.${r.id-1}.bid`),error:((Z=(W=_.mortgageData)==null?void 0:W[r.id-1])==null?void 0:Z.bid)&&((C=(H=p.mortgageData)==null?void 0:H[r.id-1])==null?void 0:C.bid),rightSection:e.jsx(De,{color:"#FFF"})})]}),r.id!==1&&e.jsx(c,{children:e.jsxs("div",{className:f("delete-icon"),children:[e.jsx(we,{onClick:()=>h(r.id)}),D("delete")]})}),w!==a.length-1&&e.jsx(O,{})]},r.id)}),e.jsx(c,{children:e.jsx(Q,{variant:"none",color:"#FBE54D",value:d("add_programm","add_programm"),onClick:j})})]})})}),A&&e.jsx("div",{className:f("mortgage-data-form"),children:e.jsx("div",{className:f("mortgage-data-form__items"),children:e.jsxs(y,{children:[a.map((r,w)=>{var g,b,o,q,k,E,$,T,V,L,z,U,W,Z,H,C;return e.jsxs(I.Fragment,{children:[e.jsxs(c,{children:[e.jsx(Y,{title:`${d("programm","programm")} #${r.id}`}),e.jsx(K,{data:S,placeholder:D("calculate_mortgage_first_ph"),value:r.program,onChange:P=>{l(`mortgageData.${r.id-1}.program`,P),setTimeout(()=>u(`mortgageData.${r.id-1}.program`,!0),0)},error:((b=(g=_.mortgageData)==null?void 0:g[r.id-1])==null?void 0:b.program)&&((q=(o=p.mortgageData)==null?void 0:o[r.id-1])==null?void 0:q.program)})]}),e.jsxs(c,{children:[e.jsx(Y,{title:d("balance","balance")}),e.jsx(re,{placeholder:"10,000",value:r.balance,handleChange:P=>l(`mortgageData.${r.id-1}.balance`,P),onBlur:()=>u(`mortgageData.${r.id-1}.balance`),error:((E=(k=_.mortgageData)==null?void 0:k[r.id-1])==null?void 0:E.balance)&&((T=($=p.mortgageData)==null?void 0:$[r.id-1])==null?void 0:T.balance)})]}),e.jsx(c,{children:e.jsx(pe,{title:d("end_date","end_date"),placeholder:D("date_ph"),value:r.endDate,allowFuture:!0,blockPastDates:!0,onChange:P=>l(`mortgageData.${r.id-1}.endDate`,P),onBlur:()=>u(`mortgageData.${r.id-1}.endDate`),error:((L=(V=_.mortgageData)==null?void 0:V[r.id-1])==null?void 0:L.endDate)&&((U=(z=p.mortgageData)==null?void 0:z[r.id-1])==null?void 0:U.endDate)})}),e.jsxs(c,{children:[e.jsx(Y,{title:d("bid","bid")}),e.jsx(re,{placeholder:"1",value:r.bid,handleChange:P=>l(`mortgageData.${r.id-1}.bid`,P),onBlur:()=>u(`mortgageData.${r.id-1}.bid`),error:((Z=(W=_.mortgageData)==null?void 0:W[r.id-1])==null?void 0:Z.bid)&&((C=(H=p.mortgageData)==null?void 0:H[r.id-1])==null?void 0:C.bid),rightSection:e.jsx(De,{color:"#FFF"})})]}),r.id!==1&&e.jsx(c,{children:e.jsxs("div",{className:f("delete-icon"),children:[e.jsx(we,{onClick:()=>h(r.id)}),D("delete")]})}),w!==a.length-1&&e.jsx(O,{})]},r.id)}),e.jsx(c,{children:e.jsx(Q,{variant:"none",color:"#FBE54D",value:d("add_programm","add_programm"),onClick:j})})]})})})]}),e.jsx(_a,{text:D("remove_programm"),subtitle:D("remove_mortgage_program_subtitle"),isVisible:ce,onCancel:ie,onSubmit:v})]})},Wa=()=>{const{t:a,i18n:i}=G(),{getContent:t}=_e("refinance_step1"),[s,m]=I.useState(51130),[l,p]=I.useState(2654),_=se(),u=M(g=>g.activeField),{data:ce,loading:de,error:ie,getDropdownProps:B}=pa("refinance_step1"),F=B("why"),A=B("property_type"),D=B("registration"),ae=B("bank"),{setFieldValue:d,values:j,errors:h,touched:v,setFieldTouched:S}=fe(),R=(j.whyRefinancingMortgage||"").toLowerCase(),r=R==="reduce_monthly_payment"||R==="option_2",w=R==="consolidate_debts"||R==="option_5";return I.useLayoutEffect(()=>{(async()=>{try{const b=await me.calculateMortgagePayment(j.mortgageBalance,0,4),o=await me.calculateMortgagePayment(j.mortgageBalance,0,30);Number.isNaN(b)||m(b),b===0&&m(1),Number.isNaN(o)||p(o)}catch(b){console.error("❌ Error calculating mortgage payment limits:",b),m(51130),p(2654)}})()},[j.mortgageBalance]),I.useEffect(()=>{(async()=>{try{if(u==="period"){const b=await me.calculateMortgagePayment(j.mortgageBalance,0,j.period);Number.isNaN(b)||d("monthlyPayment",b)}else{const b=await me.calculateLoanPeriod(j.mortgageBalance,0,j.monthlyPayment);Number.isNaN(b)||d("period",b)}}catch(b){console.error("❌ Error calculating mortgage refinance values:",b)}})()},[u,d,j.monthlyPayment,j.mortgageBalance,j.period]),e.jsx(e.Fragment,{children:e.jsxs(be,{children:[e.jsx(le,{title:t("app.refinance.step1.title",a("app.refinance.step1.title"))}),e.jsxs(y,{children:[e.jsx(c,{children:e.jsx(K,{data:F.options,title:F.label||t("app.refinance.step1.why_label",a("app.refinance.step1.why_label")),placeholder:F.placeholder||a("mortgage_refinance_why_ph"),value:j.whyRefinancingMortgage,onChange:g=>d("whyRefinancingMortgage",g),onBlur:()=>S("whyRefinancingMortgage"),error:v.whyRefinancingMortgage&&h.whyRefinancingMortgage})}),e.jsxs(c,{children:[e.jsx(ge,{name:"PriceOfEstate",title:t("app.refinance.step1.balance_label",a("app.refinance.step1.balance_label")),value:j.mortgageBalance,placeholder:"1,000,000",handleChange:g=>{_(ye("period")),d("mortgageBalance",g)},onBlur:()=>S("mortgageBalance"),error:v.mortgageBalance&&h.mortgageBalance}),v.mortgageBalance&&h.mortgageBalance&&e.jsx(J,{error:h.mortgageBalance})]}),e.jsxs(c,{children:[e.jsx(ge,{handleChange:g=>d("priceOfEstate",g),name:"PriceOfEstate",title:t("app.refinance.step1.property_value_label",a("app.refinance.step1.property_value_label")),value:j.priceOfEstate,placeholder:"1,000,000",error:h.priceOfEstate}),h.priceOfEstate&&e.jsx(J,{error:h.priceOfEstate})]})]}),e.jsxs(y,{children:[e.jsx(c,{children:e.jsx(K,{data:A.options,title:A.label||t("app.refinance.step1.property_type_label",a("app.refinance.step1.property_type_label")),placeholder:A.placeholder||a("mortgage_refinance_type_ph"),value:j.typeSelect,onChange:g=>d("typeSelect",g),onBlur:()=>S("typeSelect"),error:v.typeSelect&&h.typeSelect})}),e.jsx(c,{children:e.jsx(K,{data:ae.options,title:ae.label||t("app.refinance.step1.current_bank_label",a("app.refinance.step1.current_bank_label")),placeholder:ae.placeholder||a("mortgage_refinance_bank_ph"),value:j.bank,onChange:g=>d("bank",g),onBlur:()=>S("bank"),error:v.bank&&h.bank})}),e.jsx(c,{children:e.jsx(K,{data:D.options,title:D.label||t("app.refinance.step1.registered_label",a("app.refinance.step1.registered_label")),placeholder:D.placeholder||a("mortgage_refinance_registered_ph"),value:j.propertyRegistered,onChange:g=>d("propertyRegistered",g),onBlur:()=>S("propertyRegistered"),error:v.propertyRegistered&&h.propertyRegistered})})]}),e.jsxs(y,{children:[e.jsxs(c,{children:[e.jsx(pe,{title:t("app.refinance.step1.start_date_label",a("app.refinance.step1.start_date_label")),placeholder:a("date_ph"),value:j.startDate,onChange:g=>d("startDate",g),onBlur:()=>S("startDate"),error:v.startDate&&h.startDate}),v.startDate&&h.startDate&&e.jsx(J,{error:h.startDate})]}),r&&e.jsxs(c,{children:[e.jsx(ge,{handleChange:g=>d("decreaseMortgage",g),name:"PriceOfEstate",title:a("mortgage_refinance_decrease"),value:j.decreaseMortgage,placeholder:"1,000,000",onBlur:()=>S("decreaseMortgage"),error:v.decreaseMortgage&&h.decreaseMortgage}),v.decreaseMortgage&&h.decreaseMortgage&&e.jsx(J,{error:h.decreaseMortgage})]}),w&&e.jsxs(c,{children:[e.jsx(ge,{handleChange:g=>d("increaseMortgage",g),name:"PriceOfEstate",title:t("mortgage_refinance_increase",a("mortgage_refinance_increase")),value:j.increaseMortgage,placeholder:"1,000,000",onBlur:()=>S("increaseMortgage"),error:v.increaseMortgage&&h.increaseMortgage}),v.increaseMortgage&&h.increaseMortgage&&e.jsx(J,{error:h.increaseMortgage})]}),e.jsx(c,{})]}),e.jsx(O,{}),e.jsx(y,{children:e.jsx(Ua,{})}),e.jsx(O,{}),e.jsxs(y,{children:[e.jsxs(c,{children:[e.jsx(Ce,{disableCurrency:!0,unitsMax:a("calculate_mortgage_period_units_max"),unitsMin:a("calculate_mortgage_period_units_min"),value:j.period,name:"Period",min:4,max:30,error:h.period,title:a("calculate_mortgage_period"),handleChange:g=>{_(ye("period")),d("period",g)}}),h.period&&e.jsx(J,{error:h.period})]}),e.jsxs(c,{children:[e.jsx(Ce,{unitsMax:"₪",unitsMin:"₪",value:j.monthlyPayment,name:"monthlyPayment",min:l,max:s,error:h.monthlyPayment,title:a("calculate_mortgage_initial_payment"),handleChange:g=>{_(ye("monthlyPayment")),d("monthlyPayment",g),S("monthlyPayment")}}),e.jsx(ua,{}),v.monthlyPayment&&h.monthlyPayment&&e.jsx(J,{error:h.monthlyPayment})]}),e.jsx(c,{})]})]})})},Za=I.memo(Wa),Ha=()=>ne().shape({whyRefinancingMortgage:x().required(n("error_refinance_why_required","Please specify why you want to refinance")),mortgageBalance:N().test("is-less",n("error_refinance_balance_greater_than_property","Mortgage balance cannot exceed property value"),function(a){const{priceOfEstate:i}=this.parent;return typeof a>"u"?!0:typeof i=="number"?a<=i:!0}).required(n("error_required_to_fill_out","This field is required")),priceOfEstate:N().test("is-greater",n("error_refinance_property_less_than_balance","Property value must be at least the mortgage balance"),function(a){const{mortgageBalance:i}=this.parent;return typeof a>"u"?!0:typeof i=="number"?a>=i:!0}).required(n("error_required_to_fill_out","This field is required")),typeSelect:x().required(n("error_refinance_type_required","Property type is required")),bank:x().required(n("error_refinance_bank_required","Current bank is required")),propertyRegistered:x().required(n("error_refinance_registered_required","Property registration status is required")),startDate:x().required(n("error_refinance_start_date_required","Mortgage start date is required")),period:N().min(4,n("error_min_period","Minimum period is 4 years")).max(30,n("error_max_period","Maximum period is 30 years")).required(n("error_required_to_fill_out","This field is required")),monthlyPayment:N().positive(n("error_mortgage_payment_positive","Monthly payment must be positive")).required(n("error_required_to_fill_out","This field is required")),decreaseMortgage:x().when("whyRefinancingMortgage",{is:a=>(a||"").toLowerCase()==="reduce_monthly_payment"||(a||"").toLowerCase()==="option_2",then:a=>a.required(n("error_required_to_fill_out","This field is required")),otherwise:a=>a.notRequired()}),increaseMortgage:x().when("whyRefinancingMortgage",{is:a=>(a||"").toLowerCase()==="consolidate_debts"||(a||"").toLowerCase()==="option_5",then:a=>a.required(n("error_required_to_fill_out","This field is required")),otherwise:a=>a.notRequired()}),mortgageData:ve().of(ne().shape({program:x().required(n("error_mortgage_program_required","Mortgage program is required")),balance:N().positive(n("error_mortgage_balance_positive","Balance must be positive")).required(n("error_mortgage_balance_required","Mortgage balance is required")),endDate:x().required(n("error_mortgage_end_date_required","End date is required")),bid:N().positive(n("error_mortgage_bid_positive","Bid must be positive")).required(n("error_mortgage_bid_required","Bid is required"))})).test("is-balance-sum-equal",n("error_refinance_mortgage_balance_mismatch","Total mortgage balance must match individual balances"),function(){return this.parent.mortgageData.reduce((i,t)=>i+(t.balance||0),0)===this.parent.mortgageBalance})}),Ya=()=>{const{t:a,i18n:i}=G(),t=se();ee();const s=M(l=>l.refinanceMortgage);M(l=>l.login.isLogin);const m={whyRefinancingMortgage:s.whyRefinancingMortgage||"",mortgageBalance:s.mortgageBalance||2e5,priceOfEstate:s.priceOfEstate||1e6,typeSelect:s.typeSelect||"",bank:s.bank||"",startDate:s.startDate||"",propertyRegistered:s.propertyRegistered||"",period:s.period||4,monthlyPayment:s.monthlyPayment||4605,decreaseMortgage:s.decreaseMortgage||null,increaseMortgage:s.increaseMortgage||null,mortgageData:s.mortgageData||[{id:1,program:"",balance:null,endDate:"",bid:null}]};return e.jsxs(e.Fragment,{children:[e.jsx(xe,{initialValues:m,validationSchema:Ha(),validateOnMount:!0,onSubmit:l=>{t(X(l)),t(We()),t(Oe("phoneVerification"))},children:e.jsxs(je,{children:[e.jsxs(he,{children:[e.jsx(oa,{title:a("sidebar_sub_refinance_mortgage"),text:a("refinance_mortgage_promo_text"),size:"small"}),e.jsx(Za,{})]}),e.jsx(na,{})]})}),e.jsx(sa,{}),e.jsx(Ve,{})]})},Ga=()=>{const{t:a,i18n:i}=G(),t=M(m=>m.login.loginData),s=M(m=>m.refinanceMortgage);return e.jsxs(be,{children:[e.jsx(le,{title:a("refinance_mortgage_final")}),e.jsx(ia,{cost:s==null?void 0:s.priceOfEstate,initialPayment:s==null?void 0:s.mortgageBalance,period:s==null?void 0:s.period,nameSurname:t==null?void 0:t.nameSurname,phoneNumber:t==null?void 0:t.phoneNumber}),e.jsx(ke,{text:a("refinance_mortgage_warning")}),e.jsx(y,{children:e.jsx(la,{})}),e.jsx(ca,{})]})},Ja={selectedBank:"",selectedOffer:null},Ka=ne().shape({selectedBank:x(),selectedOffer:ne().nullable()}),Qa=()=>{const a=se(),i=ee(),t=M(m=>m.login.loginData),s=M(m=>m.login.isLogin);return e.jsx(xe,{initialValues:Ja,validationSchema:Ka,validateOnMount:!0,onSubmit:m=>{a(X(m)),!s||!(t!=null&&t.phoneNumber)?(a(Ze()),a(Oe("signUp"))):i("/services/application-submitted")},children:e.jsxs(je,{children:[e.jsx(he,{children:e.jsx(Ga,{})}),e.jsx(Me,{})]})})},Xa=()=>{G();const{getContent:a}=_e("refinance_step2"),{values:i}=fe(),t=M(p=>p.login.loginData),[s,m]=I.useState(null);I.useEffect(()=>{if(!(t!=null&&t.nameSurname)||!(t!=null&&t.phoneNumber)){const p=localStorage.getItem("USER_DATA");if(p)try{const _=JSON.parse(p);m({nameSurname:_.nameSurname||_.name_surname,phoneNumber:_.phoneNumber||_.mobile_number})}catch(_){console.error("Error parsing localStorage USER_DATA:",_)}}},[t]);const l=t!=null&&t.nameSurname?t:s;return console.log("RefinanceMortgage SecondStep user data:",l),e.jsxs(be,{children:[e.jsx(le,{title:a("refinance_step2_title","calculate_mortgage_step2_title")}),e.jsxs(ya,{children:[e.jsx(Ra,{}),e.jsx(oe,{name:l==null?void 0:l.nameSurname,phone:l==null?void 0:l.phoneNumber})]}),e.jsxs(y,{children:[e.jsx(Ma,{}),e.jsx(Sa,{}),e.jsx(Pa,{screenLocation:"refinance_step2"})]}),e.jsxs(y,{children:[e.jsxs(c,{style:{gap:"2rem"},children:[e.jsx(Ba,{}),i.additionalCitizenships==="yes"&&e.jsx(Oa,{})]}),e.jsxs(c,{style:{gap:"2rem"},children:[e.jsx(qa,{}),i.taxes==="yes"&&e.jsx(ka,{})]}),e.jsxs(c,{style:{gap:"2rem"},children:[e.jsx(Ca,{}),i.childrens==="yes"&&e.jsx(Ea,{})]})]}),e.jsx(O,{}),e.jsxs(y,{children:[e.jsx(Ia,{}),e.jsx(Fa,{}),e.jsx(Na,{})]}),e.jsx(O,{}),e.jsxs(y,{children:[e.jsx(wa,{}),e.jsx(c,{}),e.jsx(c,{})]}),e.jsx(O,{}),e.jsxs(y,{children:[e.jsx(Aa,{}),e.jsx(c,{children:i.familyStatus==="option_2"&&e.jsx(Da,{})}),e.jsx(c,{children:i.partnerPayMortgage==="yes"&&i.familyStatus==="option_2"&&e.jsx(va,{})})]})]})},er=()=>ne().shape({nameSurname:x().required(n("error_name_surname","Please enter your name and surname")),birthday:x().required(n("error_date","Please enter a valid date")),education:x().required(n("error_select_answer","Please select an answer")),additionalCitizenships:x().required(n("error_select_answer","Please select an answer")),citizenshipsDropdown:ve().when("additionalCitizenships",{is:"yes",then:a=>a.min(1,n("error_select_answer","Please select an answer")),otherwise:a=>a.min(0)}),taxes:x().required(n("error_select_answer","Please select an answer")),countriesPayTaxes:ve().when("taxes",{is:"yes",then:a=>a.min(1,n("error_select_answer","Please select an answer")),otherwise:a=>a.min(0)}),childrens:x().required(n("error_select_answer","Please select an answer")),howMuchChildrens:N().required(n("error_fill_field","Please fill this field")),medicalInsurance:x().required(n("error_select_answer","Please select an answer")),isForeigner:x().required(n("error_select_answer","Please select an answer")),publicPerson:x().required(n("error_select_answer","Please select an answer")),borrowers:N().min(1,n("error_quantity_borrowers","Please specify number of borrowers")).required(n("error_quantity_borrowers","Please specify number of borrowers")),familyStatus:x().required(n("error_select_answer","Please select an answer")),partnerPayMortgage:x().when("familyStatus",{is:"option_2",then:a=>a.required(n("error_select_answer","Please select an answer")),otherwise:a=>a.notRequired()})}),ar=er(),rr=()=>{const a=se(),i=ee(),t=M(l=>l.refinanceMortgage),m={nameSurname:M(l=>l.login.loginData).nameSurname||t.nameSurname||"",birthday:t.birthday||new Date(new Date().setFullYear(new Date().getFullYear()-18)).getTime(),education:t.education||"",additionalCitizenships:t.additionalCitizenships||null,citizenshipsDropdown:t.citizenshipsDropdown||[],taxes:t.taxes||null,countriesPayTaxes:t.countriesPayTaxes||[],childrens:t.childrens||null,howMuchChildrens:t.howMuchChildrens||1,medicalInsurance:t.medicalInsurance||null,isForeigner:t.isForeigner||null,publicPerson:t.publicPerson||null,borrowers:t.borrowers||null,familyStatus:t.familyStatus||"",partnerPayMortgage:t.partnerPayMortgage||null,addPartner:t.addPartner||""};return e.jsx(xe,{initialValues:m,validationSchema:ar,validateOnMount:!0,onSubmit:l=>{a(X(l)),i("/services/refinance-mortgage/3")},children:e.jsxs(je,{children:[e.jsx(he,{children:e.jsx(Xa,{})}),e.jsx(Me,{})]})})},tr=()=>{const{t:a}=G(),{getContent:i}=_e("refinance_step3"),t=ee(),{values:s}=fe(),m=ba("refinance_step3"),{mainSourceOfIncome:l,additionalIncome:p,obligation:_}=s,u=se(),ce=M(o=>o.borrowers.sourceOfIncomeModal),de=M(o=>o.borrowers.additionalIncomeModal),ie=M(o=>o.borrowers.obligationModal),B=M(o=>o.otherBorrowers.otherBorrowers),F=M(o=>o.login.loginData),A=l||"";console.log("RefinanceMortgage ThirdStep debug:",{incomeSourceKey:A,allFormValues:s}),console.log("RefinanceMortgage ThirdStep validation completed");const D=()=>{u(X(s)),u(He())},ae=()=>{u(X(s)),u(Ye())},d=()=>{u(X(s)),u(Ge())},j=o=>{u(Je({id:o}))},h=o=>{u(Ke({id:o}))},v=o=>{u(Qe({id:o}))},S=o=>{u(Xe(o))},R=o=>{u(ea(o))},r=o=>{u(aa(o))},w=o=>{u(qe(o));const k=!B.some(E=>E.id===o)?ue(B):o;t({pathname:"/services/other-borrowers/1/",search:Pe({pageId:String(k)}).toString()})},g=()=>{u(qe(ue(B))),t({pathname:"/services/other-borrowers/1/",search:Pe({pageId:ue(B).toString()}).toString()})},b=o=>{u(ra(o))};return e.jsxs(be,{children:[e.jsx(le,{title:i("refinance_step3_title","calculate_mortgage_step3_title")}),e.jsx(oe,{name:F==null?void 0:F.nameSurname,phone:F==null?void 0:F.phoneNumber}),e.jsxs(y,{children:[e.jsx(ha,{}),m[A]&&m[A].map((o,q)=>e.jsx(Se.Fragment,{children:o},q))]}),e.jsx(y,{children:e.jsx(c,{children:l&&e.jsxs(e.Fragment,{children:[ce.map(o=>e.jsx(oe,{onEdit:()=>S(o.id),onDelete:()=>j(o.id),enableEdit:!0,name:`${i("source_of_income_label","Source of Income")} ${o.id+1}`},o.id)),e.jsx(Q,{onClick:D,color:"#FBE54D",value:i("add_place_to_work_button","Add Place to Work"),variant:"none"})]})})}),e.jsx(O,{}),e.jsxs(y,{children:[e.jsx(fa,{}),p&&p!=="option_1"&&p!=="no_additional_income"&&e.jsx(xa,{}),e.jsx(c,{})]}),p&&p!=="option_1"&&p!=="no_additional_income"&&e.jsx(y,{children:e.jsxs(c,{children:[de.map(o=>e.jsx(oe,{onEdit:()=>R(o.id),onDelete:()=>h(o.id),enableEdit:!0,name:`${i("additional_source_of_income_label","Additional Source of Income")} ${o.id+1}`},o.id)),e.jsx(Q,{onClick:ae,color:"#FBE54D",value:i("add_additional_source_of_income_button","Add Additional Source of Income"),variant:"none"})]})}),e.jsx(O,{}),e.jsxs(y,{children:[e.jsx(ja,{}),Fe[_]&&Fe[_].map((o,q)=>e.jsx(Se.Fragment,{children:o},q)),e.jsx(c,{})]}),_&&_!=="no_obligations"&&e.jsx(y,{children:e.jsxs(c,{children:[ie.map(o=>e.jsx(oe,{onEdit:()=>r(o.id),onDelete:()=>v(o.id),enableEdit:!0,name:`${i("obligation_label","Obligation")} ${o.id+1}`},o.id)),e.jsx(Q,{onClick:d,color:"#FBE54D",value:i("add_obligation_button","Add Obligation"),variant:"none"})]})}),e.jsx(O,{}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[B&&e.jsx(Y,{title:a("borrower")}),e.jsxs(y,{style:{columnGap:"2rem"},children:[B.map(o=>e.jsx(c,{children:e.jsx(oe,{onEdit:()=>w(o.id),onDelete:()=>b(o.id),enableEdit:!0,name:o.nameSurname},o.id)},o.id)),!B&&e.jsx(Y,{title:a("borrower")}),e.jsx(c,{children:e.jsx(Q,{value:a("add_borrower"),onClick:g,style:{height:"3.5rem",borderRadius:"0.25rem",padding:"0",width:"13.125rem"}})}),e.jsx(c,{})]})]})]})},or=(a,i)=>n(a,i),Ee=()=>ne().shape({mainSourceOfIncome:x().required(n("error_select_answer","Please select an answer")).test("not-empty",n("error_select_answer","Please select an answer"),a=>a!=null&&a!==""),monthlyIncome:N().when("mainSourceOfIncome",{is:a=>["employee","selfemployed","pension","student","other"].includes(a),then:a=>a.required(n("error_fill_field","Please fill this field")),otherwise:a=>a.notRequired()}),startDate:x().when("mainSourceOfIncome",{is:a=>["employee","selfemployed"].includes(a),then:a=>a.required(n("error_date","Please enter a valid date")),otherwise:a=>a.notRequired()}),fieldOfActivity:x().when("mainSourceOfIncome",{is:a=>["employee","selfemployed"].includes(a),then:a=>a.required(n("error_select_field_of_activity","Please select field of activity")),otherwise:a=>a.notRequired()}),profession:x().when("mainSourceOfIncome",{is:a=>["employee","selfemployed"].includes(a),then:a=>a.required(n("error_fill_field","Please fill this field")),otherwise:a=>a.notRequired()}),companyName:x().when("mainSourceOfIncome",{is:a=>["employee","selfemployed"].includes(a),then:a=>a.required(n("error_fill_field","Please fill this field")),otherwise:a=>a.notRequired()}),additionalIncome:x().required(n("error_select_one_of_the_options","Please select one of the options")),additionalIncomeAmount:N().when("additionalIncome",{is:a=>a!=null&&a!==""&&a!=="option_1"&&a!=="no_additional_income",then:a=>a.required(n("error_fill_field","Please fill this field")),otherwise:a=>a.notRequired()}),obligation:x().required(or("error_select_one_of_the_options","Please select one of the options")),bank:x().when("obligation",{is:a=>a!=null&&a!==""&&a!=="option_1"&&a!=="no_obligations",then:a=>a.required(n("error_select_bank","Please select a bank")),otherwise:a=>a.notRequired()}),monthlyPaymentForAnotherBank:N().when("obligation",{is:a=>a!=null&&a!==""&&a!=="option_1"&&a!=="no_obligations",then:a=>a.required(n("error_fill_field","Please fill this field")),otherwise:a=>a.notRequired()}),endDate:x().when("obligation",{is:a=>a!=null&&a!==""&&a!=="option_1"&&a!=="no_obligations",then:a=>a.required(n("error_date","Please enter a valid date")),otherwise:a=>a.notRequired()})});Ee();const nr=()=>{const a=se(),i=ee(),t=M(m=>m.refinanceMortgage),s={mainSourceOfIncome:t.mainSourceOfIncome||"",monthlyIncome:t.monthlyIncome||null,startDate:t.startDate||null,fieldOfActivity:t.fieldOfActivity||"",profession:t.profession||"",companyName:t.companyName||"",additionalIncome:t.additionalIncome||"option_1",additionalIncomeAmount:t.additionalIncomeAmount||null,obligation:t.obligation||"option_1",bank:t.bank||"",monthlyPaymentForAnotherBank:t.monthlyPaymentForAnotherBank||null,endDate:t.endDate||null,amountIncomeCurrentYear:(t==null?void 0:t.amountIncomeCurrentYear)||null,noIncome:t.noIncome||null};return e.jsxs(e.Fragment,{children:[e.jsx(xe,{initialValues:s,validationSchema:Ee(),validateOnMount:!0,onSubmit:m=>{a(X(m)),i("/services/refinance-mortgage/4")},children:e.jsxs(je,{children:[e.jsx(he,{children:e.jsx(tr,{})}),e.jsx(Me,{})]})}),e.jsx(da,{}),e.jsx(ga,{}),e.jsx(ma,{})]})},sr=a=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",...a,children:e.jsx("path",{fill:"#FBE54D",d:"M21 9.75a.75.75 0 1 1-1.5 0V5.561l-6.218 6.22a.75.75 0 1 1-1.062-1.062L18.44 4.5H14.25a.75.75 0 1 1 0-1.5h6a.75.75 0 0 1 .75.75v6ZM17.25 12a.75.75 0 0 0-.75.75v6.75h-12v-12h6.75a.75.75 0 1 0 0-1.5H4.5A1.5 1.5 0 0 0 3 7.5v12A1.5 1.5 0 0 0 4.5 21h12a1.5 1.5 0 0 0 1.5-1.5v-6.75a.75.75 0 0 0-.75-.75Z"})}),ir=a=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",...a,children:e.jsx("path",{fill:"#fff",d:"M21.788 10.734 8.28 2.47a1.5 1.5 0 0 0-2.075.516A1.487 1.487 0 0 0 6 3.738v16.525a1.494 1.494 0 0 0 1.5 1.487c.277 0 .548-.076.784-.22l13.504-8.263a1.481 1.481 0 0 0 0-2.531v-.002ZM7.5 20.244V3.75L20.984 12 7.5 20.245Z"})}),lr=a=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:33,height:32,fill:"none",...a,children:e.jsx("path",{fill:"#fff",d:"M28.5 19v7a2 2 0 0 1-2 2h-20a2 2 0 0 1-2-2v-7a1 1 0 1 1 2 0v7h20v-7a1 1 0 0 1 2 0Zm-16.293-8.293L15.5 7.414V19a1 1 0 0 0 2 0V7.414l3.293 3.293a1 1 0 1 0 1.415-1.415l-5-5a1 1 0 0 0-1.415 0l-5 5a1 1 0 0 0 1.415 1.415Z"})}),cr={"upload-buttons":"_upload-buttons_3j3y8_1","upload-report-file":"_upload-report-file_3j3y8_6","upload-report-file__wrapper":"_upload-report-file__wrapper_3j3y8_22","upload-report-file__text":"_upload-report-file__text_3j3y8_28","submit-buttons":"_submit-buttons_3j3y8_34","submit-buttons__wrapper":"_submit-buttons__wrapper_3j3y8_44"},te=Ne.bind(cr),dr=()=>{const{t:a,i18n:i}=G(),t=ee();return e.jsx("div",{className:"step1",children:e.jsxs("div",{className:"home step1-container noborder",children:[e.jsx(le,{title:a("upload_report_title"),subtitle:a("upload_report_subtitle")}),e.jsxs("div",{className:te("upload-buttons"),children:[e.jsx(Ie,{text:a("video_instruction"),leftSection:e.jsx(ir,{})}),e.jsx(Ie,{text:a("download_report_here"),rightSection:e.jsx(sr,{}),onClick:()=>window.open("https://www.creditdata.org.il/","_blank")})]}),e.jsx(O,{}),e.jsx($a,{onDrop:s=>console.log("Files uploaded:",s),children:({getRootProps:s,getInputProps:m})=>e.jsx("section",{className:te("upload-report-file"),children:e.jsxs("div",{...s(),className:te("upload-report-file__wrapper"),children:[e.jsx("input",{...m()}),e.jsx(lr,{}),e.jsxs("p",{className:te("upload-report-file__text"),children:[a("dropzone_upload_report"),e.jsx("span",{style:{color:"#FBE54D"},children:a("dropzone_comp_upload_report")})]})]})})}),e.jsx("div",{className:te("submit-buttons"),children:e.jsxs("div",{className:te("submit-buttons__wrapper"),children:[e.jsx(Le,{title:a("button_back"),handleClick:()=>t("/services/refinance-mortgage/1")}),e.jsx(ze,{onClick:()=>t("/services/refinance-mortgage/1"),children:a("button_next_save")})]})})]})})},gr=()=>{const{stepNumber:a}=Ae(),{t:i,i18n:t}=G(),s=ee();if(!M(u=>u.login.isLogin)&&a!=="1"){s("/services/refinance-mortgage/1");return}const l=[i("mobile_step_1"),i("mobile_step_2"),i("mobile_step_3"),i("mobile_step_4")];let p;switch(a){case"1":p=e.jsx(Ya,{});break;case"2":p=e.jsx(rr,{});break;case"3":p=e.jsx(nr,{});break;case"4":p=e.jsx(Qa,{});break;case"upload-report":p=e.jsx(dr,{});break;default:p=e.jsx(ta,{type:"NOT_FOUND"});break}const _=a==="upload-report"?"1":a;return e.jsxs(e.Fragment,{children:[a!=="upload-report"&&e.jsx(Be,{progress:_,data:l}),a==="upload-report"&&e.jsx(Be,{progress:"1",data:[i("upload_report_progress"),i("mobile_step_2"),i("mobile_step_3")]}),e.jsx(I.Suspense,{fallback:e.jsx(Ue,{}),children:p})]})},Yr=gr;export{Yr as RefinanceMortgage};
