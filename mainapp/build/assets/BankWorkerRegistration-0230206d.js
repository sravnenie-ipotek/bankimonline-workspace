import{c as M,j as e}from"./index-285bd66e.js";import{k as $,f as L,r as c}from"./react-vendor-ede63a09.js";import{F as w,b as z,a as H,c as h,h as O}from"./form-vendor-f8824fb5.js";import{Q}from"./components-vendor-632ebedf.js";import{L as Z,b as T,T as R,E as g,B as f,M as G}from"./index-473a0f80.js";import{F as x}from"./FormattedInput-58967167.js";import{D as J}from"./DropdownMenu-9e994606.js";import{b as _}from"./bankWorkerApi-ca6927d2.js";import{s as K}from"./BankWorkerRegistration.module-6b38b727.js";import{u as X}from"./i18n-vendor-aaeace9f.js";import"./state-vendor-c4e6020a.js";import"./ui-vendor-d73673ed.js";import"./utils-vendor-dcc8b708.js";import"./Control-b03900da.js";const s=M.bind(K),Y=i=>H({fullName:h().min(2,i("validation.fullName.min")).max(100,i("validation.fullName.max")).matches(/^[\u0590-\u05FF\u0020A-Za-z\s]+$/,i("validation.fullName.format")).required(i("validation.fullName.required")),position:h().min(2,i("validation.position.min")).max(100,i("validation.position.max")).required(i("validation.position.required")),branchId:h().required(i("validation.branchId.required")),bankNumber:h().matches(/^[0-9]+$/,i("validation.bankNumber.format")).min(3,i("validation.bankNumber.min")).max(10,i("validation.bankNumber.max")).required(i("validation.bankNumber.required")),termsAccepted:O().oneOf([!0],i("validation.termsAccepted.required")).required(i("validation.termsAccepted.required"))}),de=()=>{const{token:i}=$(),N=L(),{t:a,i18n:V}=X(),[P,v]=c.useState(!0),[B,D]=c.useState(!1),[l,U]=c.useState(null),[A,S]=c.useState([]),[d,k]=c.useState(null),[j,W]=c.useState([]),[I,y]=c.useState(!1),[u,C]=c.useState(null),p=V.language||"en";c.useEffect(()=>{(async()=>{if(!i){k(a("errors.invalidToken")),v(!1);return}try{v(!0);const n=await _.getRegistrationForm(i);n.status==="success"?(U(n.data.invitation),S(n.data.branches),k(null)):k(n.message||a("errors.failedToLoadForm"))}catch(n){console.error("Error loading invitation data:",n),k(n.message||a("errors.networkError"))}finally{v(!1)}})()},[i,a]);const F=async(o,{setFieldError:n,setSubmitting:b})=>{try{D(!0),W([]),k(null);const t={invitationToken:i,fullName:o.fullName.trim(),position:o.position.trim(),branchId:o.branchId,bankNumber:o.bankNumber.trim(),termsAccepted:o.termsAccepted,language:p},m=await _.completeRegistration(t);m.status==="success"?(C(m.data),y(!0),Q.success(a("registration.success.message"))):m.errors&&Array.isArray(m.errors)?(W(m.errors),m.errors.forEach(r=>{n(r.field,r.message)})):k(m.message||a("errors.registrationFailed"))}catch(t){console.error("Registration error:",t),k(t.message||a("errors.networkError"))}finally{D(!1),b(!1)}},E=()=>{y(!1),u!=null&&u.id?N(`/bank-worker/status/${u.id}`):N("/")};return P?e.jsxDEV(Z,{},void 0,!1,{fileName:"/Users/michaelmishayev/Projects/bankDev2_standalone/mainapp/src/pages/BankWorker/BankWorkerRegistration.tsx",lineNumber:224,columnNumber:12},globalThis):d&&!l?e.jsxDEV(T,{children:e.jsxDEV("div",{className:s("errorContainer"),children:[e.jsxDEV(R,{title:a("registration.error.title")},void 0,!1,{fileName:"/Users/michaelmishayev/Projects/bankDev2_standalone/mainapp/src/pages/BankWorker/BankWorkerRegistration.tsx",lineNumber:232,columnNumber:11},globalThis),e.jsxDEV(g,{message:d},void 0,!1,{fileName:"/Users/michaelmishayev/Projects/bankDev2_standalone/mainapp/src/pages/BankWorker/BankWorkerRegistration.tsx",lineNumber:233,columnNumber:11},globalThis),e.jsxDEV(f,{variant:"primary",onClick:()=>N("/"),className:s("backButton"),children:a("common.backToHome")},void 0,!1,{fileName:"/Users/michaelmishayev/Projects/bankDev2_standalone/mainapp/src/pages/BankWorker/BankWorkerRegistration.tsx",lineNumber:234,columnNumber:11},globalThis)]},void 0,!0,{fileName:"/Users/michaelmishayev/Projects/bankDev2_standalone/mainapp/src/pages/BankWorker/BankWorkerRegistration.tsx",lineNumber:231,columnNumber:9},globalThis)},void 0,!1,{fileName:"/Users/michaelmishayev/Projects/bankDev2_standalone/mainapp/src/pages/BankWorker/BankWorkerRegistration.tsx",lineNumber:230,columnNumber:7},globalThis):e.jsxDEV(T,{children:e.jsxDEV("div",{className:s("registrationContainer"),children:[e.jsxDEV("div",{className:s("header"),children:[e.jsxDEV(R,{title:a("registration.title"),tooltip:a("registration.tooltip")},void 0,!1,{fileName:"/Users/michaelmishayev/Projects/bankDev2_standalone/mainapp/src/pages/BankWorker/BankWorkerRegistration.tsx",lineNumber:252,columnNumber:11},globalThis),e.jsxDEV("div",{className:s("invitationInfo"),children:[e.jsxDEV("p",{className:s("bankName"),children:l==null?void 0:l.bankName},void 0,!1,{fileName:"/Users/michaelmishayev/Projects/bankDev2_standalone/mainapp/src/pages/BankWorker/BankWorkerRegistration.tsx",lineNumber:257,columnNumber:13},globalThis),e.jsxDEV("p",{className:s("email"),children:l==null?void 0:l.email},void 0,!1,{fileName:"/Users/michaelmishayev/Projects/bankDev2_standalone/mainapp/src/pages/BankWorker/BankWorkerRegistration.tsx",lineNumber:258,columnNumber:13},globalThis)]},void 0,!0,{fileName:"/Users/michaelmishayev/Projects/bankDev2_standalone/mainapp/src/pages/BankWorker/BankWorkerRegistration.tsx",lineNumber:256,columnNumber:11},globalThis)]},void 0,!0,{fileName:"/Users/michaelmishayev/Projects/bankDev2_standalone/mainapp/src/pages/BankWorker/BankWorkerRegistration.tsx",lineNumber:251,columnNumber:9},globalThis),e.jsxDEV(w,{initialValues:{fullName:"",position:"",branchId:(l==null?void 0:l.branchId)||"",bankNumber:"",termsAccepted:!1,language:p},validationSchema:Y(a),onSubmit:F,enableReinitialize:!0,children:({values:o,errors:n,touched:b,setFieldValue:t,isSubmitting:m})=>e.jsxDEV(z,{className:s("form"),children:[e.jsxDEV("div",{className:s("formField"),children:e.jsxDEV(x,{name:"fullName",title:a("registration.fields.fullName.label"),placeholder:a("registration.fields.fullName.placeholder"),value:o.fullName,handleChange:r=>t("fullName",r),error:b.fullName&&n.fullName,tooltip:a("registration.fields.fullName.tooltip")},void 0,!1,{fileName:"/Users/michaelmishayev/Projects/bankDev2_standalone/mainapp/src/pages/BankWorker/BankWorkerRegistration.tsx",lineNumber:280,columnNumber:17},globalThis)},void 0,!1,{fileName:"/Users/michaelmishayev/Projects/bankDev2_standalone/mainapp/src/pages/BankWorker/BankWorkerRegistration.tsx",lineNumber:279,columnNumber:15},globalThis),e.jsxDEV("div",{className:s("formField"),children:e.jsxDEV(x,{name:"position",title:a("registration.fields.position.label"),placeholder:a("registration.fields.position.placeholder"),value:o.position,handleChange:r=>t("position",r),error:b.position&&n.position,tooltip:a("registration.fields.position.tooltip")},void 0,!1,{fileName:"/Users/michaelmishayev/Projects/bankDev2_standalone/mainapp/src/pages/BankWorker/BankWorkerRegistration.tsx",lineNumber:293,columnNumber:17},globalThis)},void 0,!1,{fileName:"/Users/michaelmishayev/Projects/bankDev2_standalone/mainapp/src/pages/BankWorker/BankWorkerRegistration.tsx",lineNumber:292,columnNumber:15},globalThis),e.jsxDEV("div",{className:s("formField"),children:e.jsxDEV(J,{name:"branchId",title:a("registration.fields.branch.label"),placeholder:a("registration.fields.branch.placeholder"),options:A.map(r=>({value:r.id,label:p==="he"?r.name_he:p==="ru"?r.name_ru:r.name_en,subtitle:`${r.branch_code} - ${r.city}`})),value:o.branchId,onChange:r=>t("branchId",r),error:b.branchId&&n.branchId,tooltip:a("registration.fields.branch.tooltip")},void 0,!1,{fileName:"/Users/michaelmishayev/Projects/bankDev2_standalone/mainapp/src/pages/BankWorker/BankWorkerRegistration.tsx",lineNumber:306,columnNumber:17},globalThis)},void 0,!1,{fileName:"/Users/michaelmishayev/Projects/bankDev2_standalone/mainapp/src/pages/BankWorker/BankWorkerRegistration.tsx",lineNumber:305,columnNumber:15},globalThis),e.jsxDEV("div",{className:s("formField"),children:e.jsxDEV(x,{name:"bankNumber",title:a("registration.fields.bankNumber.label"),placeholder:a("registration.fields.bankNumber.placeholder"),value:o.bankNumber,handleChange:r=>t("bankNumber",r),error:b.bankNumber&&n.bankNumber,tooltip:a("registration.fields.bankNumber.tooltip")},void 0,!1,{fileName:"/Users/michaelmishayev/Projects/bankDev2_standalone/mainapp/src/pages/BankWorker/BankWorkerRegistration.tsx",lineNumber:326,columnNumber:17},globalThis)},void 0,!1,{fileName:"/Users/michaelmishayev/Projects/bankDev2_standalone/mainapp/src/pages/BankWorker/BankWorkerRegistration.tsx",lineNumber:325,columnNumber:15},globalThis),e.jsxDEV("div",{className:s("formField","termsField"),children:[e.jsxDEV("label",{className:s("termsLabel"),children:[e.jsxDEV("input",{type:"checkbox",name:"termsAccepted",checked:o.termsAccepted,onChange:r=>t("termsAccepted",r.target.checked),className:s("termsCheckbox")},void 0,!1,{fileName:"/Users/michaelmishayev/Projects/bankDev2_standalone/mainapp/src/pages/BankWorker/BankWorkerRegistration.tsx",lineNumber:340,columnNumber:19},globalThis),e.jsxDEV("span",{className:s("termsText"),children:[a("registration.fields.terms.text"),e.jsxDEV("a",{href:"/terms",target:"_blank",className:s("termsLink"),children:a("registration.fields.terms.link")},void 0,!1,{fileName:"/Users/michaelmishayev/Projects/bankDev2_standalone/mainapp/src/pages/BankWorker/BankWorkerRegistration.tsx",lineNumber:349,columnNumber:21},globalThis)]},void 0,!0,{fileName:"/Users/michaelmishayev/Projects/bankDev2_standalone/mainapp/src/pages/BankWorker/BankWorkerRegistration.tsx",lineNumber:347,columnNumber:19},globalThis)]},void 0,!0,{fileName:"/Users/michaelmishayev/Projects/bankDev2_standalone/mainapp/src/pages/BankWorker/BankWorkerRegistration.tsx",lineNumber:339,columnNumber:17},globalThis),b.termsAccepted&&n.termsAccepted&&e.jsxDEV(g,{message:n.termsAccepted},void 0,!1,{fileName:"/Users/michaelmishayev/Projects/bankDev2_standalone/mainapp/src/pages/BankWorker/BankWorkerRegistration.tsx",lineNumber:359,columnNumber:19},globalThis)]},void 0,!0,{fileName:"/Users/michaelmishayev/Projects/bankDev2_standalone/mainapp/src/pages/BankWorker/BankWorkerRegistration.tsx",lineNumber:338,columnNumber:15},globalThis),j.length>0&&e.jsxDEV("div",{className:s("validationErrors"),children:j.map((r,q)=>e.jsxDEV(g,{message:r.message},q,!1,{fileName:"/Users/michaelmishayev/Projects/bankDev2_standalone/mainapp/src/pages/BankWorker/BankWorkerRegistration.tsx",lineNumber:367,columnNumber:21},globalThis))},void 0,!1,{fileName:"/Users/michaelmishayev/Projects/bankDev2_standalone/mainapp/src/pages/BankWorker/BankWorkerRegistration.tsx",lineNumber:365,columnNumber:17},globalThis),d&&e.jsxDEV("div",{className:s("errorMessage"),children:e.jsxDEV(g,{message:d},void 0,!1,{fileName:"/Users/michaelmishayev/Projects/bankDev2_standalone/mainapp/src/pages/BankWorker/BankWorkerRegistration.tsx",lineNumber:375,columnNumber:19},globalThis)},void 0,!1,{fileName:"/Users/michaelmishayev/Projects/bankDev2_standalone/mainapp/src/pages/BankWorker/BankWorkerRegistration.tsx",lineNumber:374,columnNumber:17},globalThis),e.jsxDEV("div",{className:s("submitSection"),children:e.jsxDEV(f,{type:"submit",variant:"primary",size:"full",disabled:B||m,className:s("submitButton"),children:a(B?"common.submitting":"registration.submit")},void 0,!1,{fileName:"/Users/michaelmishayev/Projects/bankDev2_standalone/mainapp/src/pages/BankWorker/BankWorkerRegistration.tsx",lineNumber:381,columnNumber:17},globalThis)},void 0,!1,{fileName:"/Users/michaelmishayev/Projects/bankDev2_standalone/mainapp/src/pages/BankWorker/BankWorkerRegistration.tsx",lineNumber:380,columnNumber:15},globalThis)]},void 0,!0,{fileName:"/Users/michaelmishayev/Projects/bankDev2_standalone/mainapp/src/pages/BankWorker/BankWorkerRegistration.tsx",lineNumber:277,columnNumber:13},globalThis)},void 0,!1,{fileName:"/Users/michaelmishayev/Projects/bankDev2_standalone/mainapp/src/pages/BankWorker/BankWorkerRegistration.tsx",lineNumber:263,columnNumber:9},globalThis),e.jsxDEV(G,{isVisible:I,title:a("registration.success.title"),onCancel:E,className:s("successModal"),children:e.jsxDEV("div",{className:s("successContent"),children:[e.jsxDEV("p",{className:s("successMessage"),children:a("registration.success.description")},void 0,!1,{fileName:"/Users/michaelmishayev/Projects/bankDev2_standalone/mainapp/src/pages/BankWorker/BankWorkerRegistration.tsx",lineNumber:403,columnNumber:13},globalThis),e.jsxDEV("div",{className:s("successDetails"),children:[e.jsxDEV("p",{children:[e.jsxDEV("strong",{children:[a("registration.success.id"),":"]},void 0,!0,{fileName:"/Users/michaelmishayev/Projects/bankDev2_standalone/mainapp/src/pages/BankWorker/BankWorkerRegistration.tsx",lineNumber:407,columnNumber:18},globalThis)," ",u==null?void 0:u.id]},void 0,!0,{fileName:"/Users/michaelmishayev/Projects/bankDev2_standalone/mainapp/src/pages/BankWorker/BankWorkerRegistration.tsx",lineNumber:407,columnNumber:15},globalThis),e.jsxDEV("p",{children:[e.jsxDEV("strong",{children:[a("registration.success.status"),":"]},void 0,!0,{fileName:"/Users/michaelmishayev/Projects/bankDev2_standalone/mainapp/src/pages/BankWorker/BankWorkerRegistration.tsx",lineNumber:408,columnNumber:18},globalThis)," ",a("registration.success.pendingApproval")]},void 0,!0,{fileName:"/Users/michaelmishayev/Projects/bankDev2_standalone/mainapp/src/pages/BankWorker/BankWorkerRegistration.tsx",lineNumber:408,columnNumber:15},globalThis)]},void 0,!0,{fileName:"/Users/michaelmishayev/Projects/bankDev2_standalone/mainapp/src/pages/BankWorker/BankWorkerRegistration.tsx",lineNumber:406,columnNumber:13},globalThis),e.jsxDEV(f,{variant:"primary",onClick:E,className:s("successButton"),children:a("registration.success.continue")},void 0,!1,{fileName:"/Users/michaelmishayev/Projects/bankDev2_standalone/mainapp/src/pages/BankWorker/BankWorkerRegistration.tsx",lineNumber:410,columnNumber:13},globalThis)]},void 0,!0,{fileName:"/Users/michaelmishayev/Projects/bankDev2_standalone/mainapp/src/pages/BankWorker/BankWorkerRegistration.tsx",lineNumber:402,columnNumber:11},globalThis)},void 0,!1,{fileName:"/Users/michaelmishayev/Projects/bankDev2_standalone/mainapp/src/pages/BankWorker/BankWorkerRegistration.tsx",lineNumber:396,columnNumber:9},globalThis)]},void 0,!0,{fileName:"/Users/michaelmishayev/Projects/bankDev2_standalone/mainapp/src/pages/BankWorker/BankWorkerRegistration.tsx",lineNumber:249,columnNumber:7},globalThis)},void 0,!1,{fileName:"/Users/michaelmishayev/Projects/bankDev2_standalone/mainapp/src/pages/BankWorker/BankWorkerRegistration.tsx",lineNumber:248,columnNumber:5},globalThis)};export{de as BankWorkerRegistration,de as default};
