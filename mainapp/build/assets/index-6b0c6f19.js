import{j as e}from"./ui-vendor-99260b86.js";import{r,f as t,b as i,j as o,k as a}from"./react-vendor-21ec1e1c.js";import{E as n,a as s,D as l,b as d,A as c,T as p,L as u}from"./index-83602c60.js";import{P as m}from"./ProgressBar-0c0c7aba.js";import{c as _,u as h,a as g,k as y,l as f,m as x,d as j,n as w,p as v,q as b,r as q,t as P,v as F,w as O,x as S,y as I,z as E,A as C,B as D,N as M}from"./index-a394eb59.js";import{u as N,F as B,b as Y,a as k,f as T,c as A,g as R}from"./form-vendor-6d56d196.js";import{V as z}from"./VideoPoster-6ad49667.js";import{S as L,a as V,M as W,U as $,A as U,F as H,B as G,b as J,c as K,O as Q}from"./SourceOfIncomeModal-90688e53.js";import{M as X,U as Z,A as ee}from"./AddButton-af8674b6.js";import{u as re}from"./i18n-vendor-18addd5f.js";import{I as te,c as ie}from"./IncreasePayment-3490cc07.js";import{C as oe}from"./Column-1049feee.js";import{R as ae}from"./Row-38cc6147.js";import{D as ne}from"./DropdownMenu-fce1e579.js";import{F as se}from"./FormattedInput-873f3620.js";import{F as le}from"./FormCaption-061cdd41.js";import{F as de}from"./FormContainer-b4a58025.js";import{u as ce}from"./useDropdownData-1fd3cd06.js";import{D as pe}from"./DoubleButtons-9c8561cd.js";import{R as ue}from"./RowTwo-d64a19e7.js";import{B as me,P as _e,A as he}from"./PartnerPayMortgage-3c77302e.js";import{N as ge,B as ye,E as fe,A as xe,T as je,C as we,M as ve,I as be,P as qe}from"./Taxes-28457a4b.js";import{C as Pe,a as Fe,H as Oe}from"./HowMuchChildrens-6abd4ef1.js";import{F as Se}from"./FamilyStatus-0fc25cbe.js";import{I as Ie}from"./Info-0a49130c.js";import{M as Ee,A as Ce,a as De,O as Me,c as Ne,g as Be,b as Ye}from"./componentsByIncomeSource-3b301742.js";import"./components-vendor-62dc47c0.js";import"./utils-vendor-8f040048.js";import"./state-vendor-069efcec.js";import"./MortgageParameters-9a1cc0b6.js";import"./PercentIcon-e1c53aea.js";import"./Control-b90d9ff7.js";import"./Calendar-6e892777.js";import"./ShieldCheckIcon-30f9c17a.js";const ke={image:"_image_1435f_1","inner-div":"_inner-div_1435f_8","bold-text":"_bold-text_1435f_16"},Te=_.bind(ke),Ae=()=>{const{t:r,i18n:t}=re(),{values:i}=N(),o=(i.priceOfEstate-i.initialFee).toLocaleString("en-US"),a=Math.trunc((i.priceOfEstate-i.initialFee)/i.priceOfEstate*100);return e.jsxs(X,{style:{marginTop:"2px"},children:[e.jsx("span",{className:Te("margin-sides"),children:r("calc_mortrage_subtext_1")}),e.jsxs("b",{className:Te("bold-text"),children:[o," ₪"]}),e.jsx("br",{}),e.jsx("span",{className:Te("margin-sides"),children:r("calc_mortrage_subtext_3")}),e.jsxs("b",{className:Te("bold-text"),children:[isNaN(a)||a<0?0:a,"%"]})]})};function Re(){const[t,i]=r.useState(51130),[o,a]=r.useState(2654),[s,l]=r.useState({min:4,max:30}),{t:d,i18n:c}=re(),{setFieldValue:p,values:u,errors:m}=N(),_=h(e=>e.activeField),f=g();r.useEffect(()=>{(async()=>{var e,r,t,i,o,a;try{const n=await ie.getAllParameters("mortgage"),s=(null==(t=null==(r=null==(e=n.standards)?void 0:e.loan_terms)?void 0:r.min_years)?void 0:t.value)||4,d=(null==(a=null==(o=null==(i=n.standards)?void 0:i.loan_terms)?void 0:o.max_years)?void 0:a.value)||30;l({min:s,max:d})}catch(n){}})()},[]);return r.useEffect(()=>{(async()=>{try{if("period"===_){const e=await ie.calculateMortgagePayment(u.priceOfEstate,u.initialFee,u.period);Number.isNaN(e)||p("monthlyPayment",e)}else{const e=await ie.calculateLoanPeriod(u.priceOfEstate,u.initialFee,u.monthlyPayment);Number.isNaN(e)||p("period",e)}}catch(e){}})()},[_,p,u.initialFee,u.monthlyPayment,u.period,u.priceOfEstate]),r.useLayoutEffect(()=>{(async()=>{var e,r,t,o,n,l;try{const e=await ie.calculateMortgagePayment(u.priceOfEstate,u.initialFee,s.min),r=await ie.calculateMortgagePayment(u.priceOfEstate,u.initialFee,s.max);Number.isNaN(e)||i(e),0===e&&i(1),Number.isNaN(r)||a(r)}catch(d){try{const s=await ie.getAllParameters("mortgage"),d=(null==(t=null==(r=null==(e=s.standards)?void 0:e.payment_limits)?void 0:r.default_max)?void 0:t.value)||51130,c=(null==(l=null==(n=null==(o=s.standards)?void 0:o.payment_limits)?void 0:n.default_min)?void 0:l.value)||2654;i(d),a(c)}catch(c){i(51130),a(2654)}}})()},[u.initialFee,u.priceOfEstate,s]),e.jsxs(ae,{children:[e.jsxs(oe,{children:[e.jsx(L,{disableCurrency:!0,unitsMax:d("calculate_mortgage_period_units_max"),unitsMin:d("calculate_mortgage_period_units_min"),value:u.period,name:"Period",min:s.min,max:s.max,error:m.period,title:d("calculate_mortgage_period"),handleChange:e=>{f(y("period")),p("period",e)}}),m.period&&e.jsx(n,{error:m.period})]}),e.jsxs(oe,{children:[e.jsx(L,{unitsMax:"₪",unitsMin:"₪",name:"MonthlyPayment",min:o,max:t,error:m.monthlyPayment,title:d("calculate_mortgage_initial_payment"),handleChange:e=>{f(y("monthlyPayment")),p("monthlyPayment",e)},value:u.monthlyPayment}),e.jsx(te,{}),m.monthlyPayment&&e.jsx(n,{error:m.monthlyPayment})]}),e.jsx(oe,{})]})}const ze=()=>{const{t:t,i18n:i}=re(),{getContent:o}=s("mortgage_step1"),a=g(),{data:d,loading:c,error:p,getDropdownProps:u}=ce("mortgage_step1"),[m,_]=r.useState([]),[h,f]=r.useState({}),[x,j]=r.useState(!0);r.useEffect(()=>{(async()=>{try{const e=await fetch(`/api/get-cities?lang=${i.language}`),r=await e.json();if("success"===r.status){const e=r.data.map(e=>({value:e.value,label:e.name}));_(e)}}catch(e){}})(),(async()=>{var e,r,t,i,o,a,s;try{j(!0);const r=("localhost"===window.location.hostname||window.location.hostname,"/api"),t=await fetch(`${r}/v1/calculation-parameters?business_path=mortgage`),i=await t.json();if("success"===i.status&&i.data.property_ownership_ltvs){const e={};Object.keys(i.data.property_ownership_ltvs).forEach(r=>{e[r]=i.data.property_ownership_ltvs[r].ltv/100}),f(e)}else{if("error"!==i.status||!(null==(e=i.data)?void 0:e.property_ownership_ltvs))throw new n("No LTV data in response");{const e={};Object.keys(i.data.property_ownership_ltvs).forEach(r=>{e[r]=i.data.property_ownership_ltvs[r].ltv/100}),f(e)}}}catch(l){try{const e=await ie.getAllParameters("mortgage");f({no_property:(null==(t=null==(r=e.property_ownership_ltvs)?void 0:r.no_property)?void 0:t.ltv)/100||.75,has_property:(null==(o=null==(i=e.property_ownership_ltvs)?void 0:i.has_property)?void 0:o.ltv)/100||.5,selling_property:(null==(s=null==(a=e.property_ownership_ltvs)?void 0:a.selling_property)?void 0:s.ltv)/100||.7})}catch(d){f({no_property:.75,has_property:.5,selling_property:.7})}}finally{j(!1)}})()},[i.language]);const w=u("when_needed"),v=u("type"),b=u("first_home"),q=u("property_ownership"),P=[{value:"no_property",label:t("calculate_mortgage_property_ownership_option_1","I don't own any property")},{value:"has_property",label:t("calculate_mortgage_property_ownership_option_2","I own a property")},{value:"selling_property",label:t("calculate_mortgage_property_ownership_option_3","I'm selling a property")}],{setFieldValue:F,values:O,errors:S,touched:I,setFieldTouched:E}=N(),C=(e,r)=>{if(!e||0===e)return 0;const t=((e,r)=>e&&0!==e?e*(h[r]||h.no_property||.75):1)(e,r);return e-t};return r.useEffect(()=>{if(O.propertyOwnership&&O.priceOfEstate){const e=C(O.priceOfEstate,O.propertyOwnership),r=O.priceOfEstate;O.initialFee<e?F("initialFee",e):O.initialFee>r&&F("initialFee",r)}},[O.propertyOwnership,O.priceOfEstate,O.initialFee,F]),e.jsx(e.Fragment,{children:e.jsxs(de,{children:[e.jsx(le,{title:o("mortgage_step1.header.title","calculate_mortgage_title")}),e.jsxs(ae,{children:[e.jsxs(oe,{children:[e.jsx(se,{handleChange:e=>{a(y("period")),F("priceOfEstate",e)},name:"PriceOfEstate",title:o("mortgage_step1.field.property_price","calculate_mortgage_price"),value:O.priceOfEstate,placeholder:"1,000,000",error:S.priceOfEstate,"data-testid":"property-price-input"}),S.priceOfEstate&&e.jsx(n,{error:S.priceOfEstate})]}),e.jsx(oe,{children:e.jsx(ne,{title:o("mortgage_step1.field.city","calculate_mortgage_city"),data:m,placeholder:o("mortgage_step1.field.city_ph","Select city"),value:O.cityWhereYouBuy,onChange:e=>F("cityWhereYouBuy",e),onBlur:()=>E("cityWhereYouBuy",!0),searchable:!0,searchPlaceholder:o("mortgage_step1.field.search_ph","Search..."),nothingFoundText:o("mortgage_step1.field.nothing_found","Nothing found"),error:I.cityWhereYouBuy&&S.cityWhereYouBuy,dataTestId:"city-dropdown"})}),e.jsxs(oe,{children:[e.jsx(ne,{title:w.label||o("mortgage_step1.field.when_needed","calculate_mortgage_when"),data:w.options,placeholder:w.placeholder||o("mortgage_step1.field.when_needed_ph","calculate_mortgage_when_options_ph"),value:O.whenDoYouNeedMoney,onChange:e=>F("whenDoYouNeedMoney",e),onBlur:()=>E("whenDoYouNeedMoney",!0),error:I.whenDoYouNeedMoney&&S.whenDoYouNeedMoney,dataTestId:"when-needed-dropdown",disabled:c}),p&&e.jsx(n,{error:o("error_dropdown_load_failed","Failed to load options. Please refresh the page.")})]})]}),e.jsxs(ae,{children:[e.jsxs(oe,{children:[e.jsx(L,{name:"InitialFee",value:O.initialFee,min:C(O.priceOfEstate,O.propertyOwnership),max:O.priceOfEstate||1,title:o("mortgage_step1.field.initial_fee","calculate_mortgage_initial_fee"),handleChange:e=>{a(y("period")),F("initialFee",e)},tooltip:o("mortgage_step1.field.initial_payment_tooltip","Minimum down payment depends on property ownership status"),error:S.initialFee,disableRangeValues:!0,"data-testid":"initial-fee-input"}),e.jsx(Ae,{}),S.initialFee&&e.jsx(n,{error:S.initialFee})]}),e.jsxs(oe,{children:[e.jsx(ne,{title:v.label||o("mortgage_step1.field.type","calculate_mortgage_type"),data:v.options,placeholder:v.placeholder||o("mortgage_step1.field.type_ph","calculate_mortgage_type_ph"),value:O.typeSelect,onChange:e=>F("typeSelect",e),onBlur:()=>E("typeSelect",!0),error:I.typeSelect&&S.typeSelect,dataTestId:"property-type-dropdown",disabled:c}),p&&e.jsx(n,{error:o("error_dropdown_load_failed","Failed to load type options. Please refresh the page.")})]}),e.jsxs(oe,{children:[e.jsx(ne,{title:b.label||o("mortgage_step1.field.first_home","calculate_mortgage_first"),data:b.options,placeholder:b.placeholder||o("mortgage_step1.field.first_home_ph","calculate_mortgage_first_ph"),value:O.willBeYourFirst,onChange:e=>F("willBeYourFirst",e),onBlur:()=>E("willBeYourFirst",!0),error:I.willBeYourFirst&&S.willBeYourFirst,dataTestId:"first-home-dropdown",disabled:c}),p&&e.jsx(n,{error:o("error_dropdown_load_failed","Failed to load first home options. Please refresh the page.")})]})]}),e.jsxs(ae,{children:[e.jsxs(oe,{children:[e.jsx(ne,{title:q.label||o("mortgage_step1.field.property_ownership","calculate_mortgage_property_ownership"),data:q.options.length>0?q.options:P,placeholder:q.placeholder||o("mortgage_step1.field.property_ownership_ph","calculate_mortgage_property_ownership_ph"),value:O.propertyOwnership,onChange:e=>F("propertyOwnership",e),onBlur:()=>E("propertyOwnership",!0),error:I.propertyOwnership&&S.propertyOwnership,dataTestId:"property-ownership-dropdown",disabled:!1}),p&&e.jsx(n,{error:o("error_dropdown_load_failed","Failed to load property ownership options. Please refresh the page.")})]}),e.jsx(oe,{}),e.jsx(oe,{})]}),e.jsx(l,{}),e.jsx(Re,{})]})})},Le=()=>k().shape({priceOfEstate:T().max(1e7,w("error_max_price",'ערך הנכס המקסימלי הוא 10,000,000 ש"ח')).required(w("error_property_value_required","ערך הנכס נדרש")),cityWhereYouBuy:A().required(w("error_city_required","עיר נדרשת")),whenDoYouNeedMoney:A().required(w("error_when_need_mortgage","יש לבחור מתי תזדקק למשכנתא")),initialFee:T().test("initial-payment-percentage",w("error_initial_fee","תשלום ראשוני לא יכול לעלות על 75% מערך הנכס"),function(e){return function(e,r){const t=.25*e;if(void 0===r)return!1;return r>=t}(this.parent.priceOfEstate||0,e)}).required(w("error_initial_payment_required","תשלום ראשוני נדרש")),typeSelect:A().required(w("error_mortgage_type_required","סוג משכנתה נדרש")),willBeYourFirst:A().required(w("error_first_home_required","אנא ציין אם זה הבית הראשון שלך")),propertyOwnership:A().required(w("error_property_ownership_required","סטטוס בעלות על נכס נדרש")),period:T().min(4,w("error_min_period","תקופה מינימלית היא 4 שנים")).max(30,w("error_max_period","תקופה מקסימלית היא 30 שנה")).required(w("error_period_required","תקופת המשכנתה נדרשת")),monthlyPayment:T().min(2654,w("error_min_monthly_payment",'תשלום חודשי מינימלי הוא 2,664 ש"ח')).required(w("error_monthly_payment_required","תשלום חודשי נדרש"))});const Ve=()=>{re();const{getContent:r}=s("mortgage_step1"),i=g(),o=t(),a=h(e=>e.mortgage),n=h(e=>e.login.isLogin),l={priceOfEstate:a.priceOfEstate||1e6,cityWhereYouBuy:a.cityWhereYouBuy||"",whenDoYouNeedMoney:a.whenDoYouNeedMoney||"",initialFee:a.initialFee||5e5,typeSelect:a.typeSelect||"",willBeYourFirst:a.willBeYourFirst||"",propertyOwnership:a.propertyOwnership||"",period:a.period||4,monthlyPayment:a.monthlyPayment||11514};return e.jsxs(e.Fragment,{children:[e.jsx(B,{initialValues:l,validationSchema:Le(),validateOnMount:!0,onSubmit:e=>{i(f(e)),n?o("/services/calculate-mortgage/2"):(i(x()),i(j("phoneVerification")))},children:e.jsxs(Y,{children:[e.jsxs(d,{children:[e.jsx(z,{title:r("video_calculate_mortgage_title","video_calculate_mortgage_title"),text:r("show_offers","show_offers"),size:"small"}),e.jsx(ze,{})]}),e.jsx(V,{})]})}),e.jsx(W,{}),e.jsx(c,{})]})},We=()=>{re();const{getContent:r}=s("mortgage_step4"),t=h(e=>e.login.loginData),i=h(e=>e.mortgage);return e.jsxs(de,{children:[e.jsx(le,{title:r("calculate_mortgage_final","calculate_mortgage_final")}),e.jsx($,{cost:i.priceOfEstate,initialPayment:i.initialFee,period:i.period,nameSurname:null==t?void 0:t.nameSurname,phoneNumber:null==t?void 0:t.phoneNumber}),e.jsx(U,{text:r("calculate_mortgage_warning","calculate_mortgage_warning")}),e.jsx(ae,{children:e.jsx(H,{})}),e.jsx(G,{})]})},$e={selectedBank:"",selectedOffer:null},Ue=k().shape({selectedBank:A(),selectedOffer:k().nullable()}),He=()=>{const r=g(),i=t();return h(e=>e.login.loginData),h(e=>e.login.isLogin),e.jsx(B,{initialValues:$e,validationSchema:Ue,validateOnMount:!0,onSubmit:e=>{r(f(e)),i("/services/application-submitted")},children:e.jsxs(Y,{children:[e.jsx(d,{children:e.jsx(We,{})}),e.jsx(pe,{})]})})},Ge=()=>{re();const{getContent:r}=s("mortgage_step2"),{values:t}=N(),i=h(e=>e.login.loginData);return e.jsx(e.Fragment,{children:e.jsxs(de,{children:[e.jsx(le,{title:r("mortgage_step2_title","Personal Details")}),e.jsxs(ue,{children:[e.jsx(Ie,{}),e.jsx(Z,{name:null==i?void 0:i.nameSurname,phone:null==i?void 0:i.phoneNumber})]}),e.jsxs(ae,{children:[e.jsx(ge,{}),e.jsx(ye,{}),e.jsx(fe,{})]}),e.jsxs(ae,{children:[e.jsxs(oe,{style:{gap:"2rem"},children:[e.jsx(xe,{}),"yes"===t.additionalCitizenships&&e.jsx(Pe,{})]}),e.jsxs(oe,{style:{gap:"2rem"},children:[e.jsx(je,{}),"yes"===t.taxes&&e.jsx(Fe,{})]}),e.jsxs(oe,{style:{gap:"2rem"},children:[e.jsx(we,{}),"yes"===t.childrens&&e.jsx(Oe,{})]})]}),e.jsx(l,{}),e.jsxs(ae,{children:[e.jsx(ve,{}),e.jsx(be,{}),e.jsx(qe,{})]}),e.jsx(l,{}),e.jsxs(ae,{children:[e.jsx(me,{}),e.jsx(oe,{}),e.jsx(oe,{})]}),e.jsx(l,{}),e.jsxs(ae,{children:[e.jsx(Se,{}),e.jsx(oe,{children:"married"===t.familyStatus&&e.jsx(_e,{})}),e.jsx(oe,{children:"yes"===t.partnerPayMortgage&&"married"===t.familyStatus&&e.jsx(he,{})})]})]})})},Je=()=>k().shape({nameSurname:A().required(w("error_name_surname","Please enter your name and surname")),birthday:A().required(w("error_date","Please enter a valid date")),education:A().required(w("error_education_required","Education is required")),additionalCitizenships:A().required(w("error_citizenship_required","Citizenship information is required")),citizenshipsDropdown:R().when("additionalCitizenships",{is:"yes",then:e=>e.min(1,w("error_citizenship_countries_required","Please select at least one citizenship country")),otherwise:e=>e.min(0)}),taxes:A().required(w("error_taxes_required","Tax payment information is required")),countriesPayTaxes:R().when("taxes",{is:"yes",then:e=>e.min(1,w("error_tax_countries_required","Please select at least one tax country")),otherwise:e=>e.min(0)}),childrens:A().required(w("error_children_required","Children information is required")),howMuchChildrens:T().required(w("error_children_count_required","Number of children is required")),medicalInsurance:A().required(w("error_medical_insurance_required","Medical insurance information is required")),isForeigner:A().required(w("error_foreigner_required","Foreigner status is required")),publicPerson:A().required(w("error_public_person_required","Public person status is required")),borrowers:T().min(1,w("error_quantity_borrowers","At least one borrower is required")).required(w("error_quantity_borrowers","Number of borrowers is required")),familyStatus:A().required(w("error_family_status_required","Family status is required")),partnerPayMortgage:A().when("familyStatus",{is:"married",then:e=>e.required(w("error_partner_mortgage_required","Partner mortgage information is required")),otherwise:e=>e.notRequired()})});Je();const Ke=()=>{const r=g(),i=t(),o=h(e=>e.mortgage),a={nameSurname:h(e=>e.login.loginData).nameSurname||o.nameSurname||"",birthday:o.birthday||new Date((new Date).setFullYear((new Date).getFullYear()-18)).getTime(),education:o.education||"",additionalCitizenships:o.additionalCitizenships||null,citizenshipsDropdown:o.citizenshipsDropdown||[],taxes:o.taxes||null,countriesPayTaxes:o.countriesPayTaxes||[],childrens:o.childrens||null,howMuchChildrens:o.howMuchChildrens||1,medicalInsurance:o.medicalInsurance||null,isForeigner:o.isForeigner||null,publicPerson:o.publicPerson||null,borrowers:o.borrowers||null,familyStatus:o.familyStatus||"",partnerPayMortgage:o.partnerPayMortgage||null,addPartner:o.addPartner||""};return e.jsx(B,{initialValues:a,validationSchema:Je(),validateOnMount:!0,onSubmit:e=>{r(f(e)),i("/services/calculate-mortgage/3")},children:e.jsxs(Y,{children:[e.jsx(d,{children:e.jsx(Ge,{})}),e.jsx(pe,{})]})})},Qe=e=>{if(!e)return!1;const r=e.toLowerCase();return"option_1"===r||"1"===r||r.includes("no_additional")||r.includes("no additional")||r.includes("none")},Xe=e=>{if(!e)return!1;const r=e.toLowerCase();return"option_1"===r||r.includes("no_obligation")||r.includes("no obligation")||r.includes("none")},Ze=()=>{re();const{getContent:r}=s("mortgage_step3"),a=t(),{values:n}=N(),d=Be("mortgage_step3"),{mainSourceOfIncome:c,additionalIncome:u,obligation:m}=n,_=g(),y=h(e=>e.borrowers.sourceOfIncomeModal),x=h(e=>e.borrowers.additionalIncomeModal),j=h(e=>e.borrowers.obligationModal),w=h(e=>e.otherBorrowers.otherBorrowers),M=h(e=>e.login.loginData),B=c||"",Y="no_obligations"===m?"":m||"";return e.jsxs(de,{children:[e.jsx(le,{title:r("mortgage_step3_title","Income & Employment Information")}),e.jsx(Z,{name:null==M?void 0:M.nameSurname,phone:null==M?void 0:M.phoneNumber}),e.jsxs(ae,{children:[e.jsx(Ee,{}),d[B]&&d[B].map((r,t)=>e.jsx(i.Fragment,{children:r},t))]}),e.jsx(ae,{children:e.jsx(oe,{children:c&&e.jsxs(e.Fragment,{children:[y.map(t=>e.jsx(Z,{onEdit:()=>{return e=t.id,void _(S(e));var e},onDelete:()=>{return e=t.id,void _(P({id:e}));var e},enableEdit:!0,name:`${r("source_of_income","source_of_income")}${t.id+1}`},t.id)),e.jsx(ee,{onClick:()=>{_(f(n)),_(v())},color:"#FBE54D",value:r("add_place_to_work","add_place_to_work"),variant:"none"})]})})}),e.jsx(l,{}),e.jsxs(ae,{children:[e.jsx(Ce,{}),u&&!Qe(u)&&e.jsx(De,{}),e.jsx(oe,{})]}),u&&!Qe(u)&&e.jsx(ae,{children:e.jsxs(oe,{children:[x.map(t=>e.jsx(Z,{onEdit:()=>{return e=t.id,void _(I(e));var e},onDelete:()=>{return e=t.id,void _(F({id:e}));var e},enableEdit:!0,name:`${r("additional_source_of_income","additional_source_of_income")}${t.id+1}`},t.id)),e.jsx(ee,{onClick:()=>{_(f(n)),_(b())},color:"#FBE54D",value:r("add_additional_source_of_income","add_additional_source_of_income"),variant:"none"})]})}),e.jsx(l,{}),e.jsxs(ae,{children:[e.jsx(Me,{}),Ne[Y]&&Ne[Y].map((r,t)=>e.jsx(i.Fragment,{children:r},t)),e.jsx(oe,{})]}),m&&!Xe(m)&&e.jsx(ae,{children:e.jsxs(oe,{children:[j.map(t=>e.jsx(Z,{onEdit:()=>{return e=t.id,void _(E(e));var e},onDelete:()=>{return e=t.id,void _(O({id:e}));var e},enableEdit:!0,name:`${r("obligation","obligation")}${t.id+1}`},t.id)),e.jsx(ee,{onClick:()=>{_(f(n)),_(q())},color:"#FBE54D",value:r("add_obligation","add_obligation"),variant:"none"})]})}),e.jsx(l,{}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[w&&e.jsx(p,{title:r("borrower","borrower")}),e.jsxs(ae,{style:{columnGap:"2rem"},children:[w.map(r=>e.jsx(oe,{children:e.jsx(Z,{onEdit:()=>(e=>{_(C(e));const r=w.some(r=>r.id===e)?e:Ye(w);a({pathname:"/services/other-borrowers/1/",search:o({pageId:String(r)}).toString()})})(r.id),onDelete:()=>{return e=r.id,void _(D(e));var e},enableEdit:!0,name:r.nameSurname},r.id)},r.id)),!w&&e.jsx(p,{title:r("borrower","borrower")}),e.jsx(oe,{children:e.jsx(ee,{value:r("add_borrower","add_borrower"),onClick:()=>{_(C(Ye(w))),_(f(n)),a({pathname:"/services/other-borrowers/1/",search:o({pageId:Ye(w).toString()}).toString()})},style:{height:"3.5rem",borderRadius:"0.25rem",padding:"0",width:"13.125rem"}})}),e.jsx(oe,{})]})]})]})},er=e=>{if(!e)return!1;const r=e.toLowerCase();return r.includes("unemployed")||r.includes("no_income")||r.includes("no income")||r.includes("option_5")||r.includes("option_6")||"app.mortgage.step3.main_source_income_option_5"===r||"app.mortgage.step3.main_source_income_option_6"===r||"other"===r||"unpaid_leave"===r},rr=e=>{if(!e)return!1;const r=e.toLowerCase();return"option_1"===r||"no_obligations"===r||r.includes("no_obligation")||r.includes("no obligation")||r.includes("none")},tr=k().shape({mainSourceOfIncome:A().required(w("error_select_answer","Please select an answer")).test("not-empty",w("error_select_answer","Please select an answer"),e=>null!=e&&""!==e),monthlyIncome:T().when("mainSourceOfIncome",{is:e=>!er(e),then:e=>e.required(w("error_fill_field","Please fill this field")),otherwise:e=>e.notRequired()}),startDate:A().when("mainSourceOfIncome",{is:e=>!er(e),then:e=>e.required(w("error_date","Please enter a valid date")),otherwise:e=>e.notRequired()}),fieldOfActivity:A().when("mainSourceOfIncome",{is:e=>null!=e&&""!==e&&!er(e),then:e=>e.required(w("error_select_field_of_activity","Please select field of activity")),otherwise:e=>e.notRequired()}),profession:A().when("mainSourceOfIncome",{is:e=>!er(e),then:e=>e.required(w("error_fill_field","Please fill this field")),otherwise:e=>e.notRequired()}),companyName:A().when("mainSourceOfIncome",{is:e=>!er(e),then:e=>e.required(w("error_fill_field","Please fill this field")),otherwise:e=>e.notRequired()}),additionalIncome:A().required(w("error_select_one_of_the_options","Please select one of the options")).test("not-empty",w("error_select_one_of_the_options","Please select one of the options"),e=>null!=e&&""!==e),additionalIncomeAmount:T().when("additionalIncome",{is:e=>null!=e&&""!==e&&!(e=>{if(!e)return!1;const r=e.toLowerCase();return"option_1"===r||"1"===r||r.includes("no_additional")||r.includes("no additional")||r.includes("none")})(e),then:e=>e.required(w("error_fill_field","Please fill this field")),otherwise:e=>e.notRequired()}),obligation:A().required(w("error_select_one_of_the_options","Please select one of the options")),bank:A().when("obligation",{is:e=>null!=e&&""!==e&&!rr(e),then:e=>e.required(w("error_select_bank","Please select a bank")),otherwise:e=>e.notRequired()}),monthlyPaymentForAnotherBank:T().when("obligation",{is:e=>null!=e&&""!==e&&!rr(e),then:e=>e.required(w("error_fill_field","Please fill this field")),otherwise:e=>e.notRequired()}),endDate:A().when("obligation",{is:e=>null!=e&&""!==e&&!rr(e),then:e=>e.required(w("error_date","Please enter a valid date")),otherwise:e=>e.notRequired()})}),ir=()=>{const r=g(),i=t(),o=h(e=>e.mortgage),a={mainSourceOfIncome:o.mainSourceOfIncome||"",monthlyIncome:o.monthlyIncome||null,startDate:o.startDate||(new Date).getTime(),fieldOfActivity:o.fieldOfActivity||"",profession:o.profession||"",companyName:o.companyName||"",additionalIncome:o.additionalIncome||"",additionalIncomeAmount:o.additionalIncomeAmount||null,obligation:o.obligation||"option_1",bank:o.bank||"",monthlyPaymentForAnotherBank:o.monthlyPaymentForAnotherBank||null,endDate:o.endDate||(new Date).getTime(),amountIncomeCurrentYear:o.amountIncomeCurrentYear||null,noIncome:o.noIncome||(new Date).getTime()};return e.jsxs(e.Fragment,{children:[e.jsx(B,{initialValues:a,validationSchema:tr,validateOnMount:!0,onSubmit:e=>{r(f(e)),i("/services/calculate-mortgage/4")},children:e.jsxs(Y,{children:[e.jsx(d,{children:e.jsx(Ze,{})}),e.jsx(pe,{})]})}),e.jsx(J,{}),e.jsx(K,{}),e.jsx(Q,{})]})},or=()=>{const{stepNumber:i}=a();re();const{getContent:o}=s("mortgage_calculation"),n=t(),l=h(e=>e.login.isLogin);r.useEffect(()=>{l||"1"===i||n("/services/calculate-mortgage/1")},[l,i,n]);const d=[o("mobile_step_1","mobile_step_1"),o("mobile_step_2","mobile_step_2"),o("mobile_step_3","mobile_step_3"),o("mobile_step_4","mobile_step_4")];let c;switch(i){case"1":c=e.jsx(Ve,{});break;case"2":c=e.jsx(Ke,{});break;case"3":c=e.jsx(ir,{});break;case"4":c=e.jsx(He,{});break;default:c=e.jsx(M,{type:"NOT_FOUND"})}return e.jsxs(e.Fragment,{children:["4"!==i&&e.jsx(m,{progress:i,data:d}),e.jsx(r.Suspense,{fallback:e.jsx(u,{}),children:c})]})};export{or as CalculateMortgage};
