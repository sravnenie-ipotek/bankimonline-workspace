import{j as e}from"./ui-vendor-99260b86.js";import{r as a,f as r,b as t,j as o,k as n}from"./react-vendor-21ec1e1c.js";import{c as i,u as l,a as s,W as d,T as c,D as m,E as g,b as u,A as p,d as _,B as h,L as j}from"./index-062129a7.js";import{P as x}from"./ProgressBar-06019092.js";import{c as f,a as b,u as v,k as y,F as w,m as D,d as P,n as q,o as M,p as S,q as B,r as C,t as N,v as k,w as F,x as I,y as E,z as O,A as R,B as $,N as A}from"./index-bbd07903.js";import{u as T,F as L,b as V,a as z,c as U,f as Z,g as H}from"./form-vendor-6d56d196.js";import{V as Y}from"./VideoPoster-05e132c7.js";import{A as W,S as G,a as J,M as K,U as Q,F as X,B as ee,b as ae,c as re,O as te}from"./SourceOfIncomeModal-1bc1cd37.js";import{u as oe}from"./useDropdownData-1fd3cd06.js";import{C as ne}from"./Column-c62812bf.js";import{D as ie}from"./DropdownMenu-37b00287.js";import{F as le}from"./FormContainer-cf11bb19.js";import{F as se}from"./FormattedInput-0a0b0810.js";import{R as de}from"./Row-3a0166fc.js";import{C as ce}from"./Calendar-ff4e3494.js";import{I as me,c as ge}from"./IncreasePayment-eb7052a8.js";import{F as ue}from"./FormCaption-0d007f9f.js";import{D as pe}from"./DeleteIcon-eb6b754c.js";import{P as _e}from"./PercentIcon-e1c53aea.js";import{A as he,U as je}from"./AddButton-37c4295d.js";import{E as xe,N as fe}from"./ExitModule-a4195ae5.js";import{C as be}from"./Control-2a01a100.js";import{b as ve,M as ye,A as we,a as De,O as Pe,c as qe,g as Me}from"./componentsByIncomeSource-32b82075.js";import{u as Se}from"./i18n-vendor-18addd5f.js";import{D as Be}from"./DoubleButtons-e30ac87c.js";import{R as Ce}from"./RowTwo-299b9241.js";import{B as Ne,P as ke,A as Fe}from"./PartnerPayMortgage-63648180.js";import{N as Ie,B as Ee,E as Oe,A as Re,T as $e,C as Ae,M as Te,I as Le,P as Ve}from"./Taxes-415aacd4.js";import{C as ze,a as Ue,H as Ze}from"./HowMuchChildrens-b8851e30.js";import{F as He}from"./FamilyStatus-5d61e8b4.js";import{I as Ye}from"./Info-5b25ac89.js";import{D as We}from"./components-vendor-62dc47c0.js";import"./utils-vendor-8f040048.js";import"./state-vendor-069efcec.js";import"./MortgageParameters-eb19a421.js";import"./ShieldCheckIcon-30f9c17a.js";const Ge={"mortgage-data":"_mortgage-data_1pft3_1","mortgage-data-title":"_mortgage-data-title_1pft3_6","mortgage-data-title__text":"_mortgage-data-title__text_1pft3_20","mortgage-data-title__button":"_mortgage-data-title__button_1pft3_26","mortgage-data-form":"_mortgage-data-form_1pft3_42","mortgage-data-form__items":"_mortgage-data-form__items_1pft3_48","button-left__icon":"_button-left__icon_1pft3_54",container:"_container_1pft3_60",col:"_col_1pft3_66","col-1":"_col-1_1pft3_72","col-2":"_col-2_1pft3_82","col-3":"_col-3_1pft3_92","col-4":"_col-4_1pft3_102","col-5":"_col-5_1pft3_112","delete-icon":"_delete-icon_1pft3_126",title:"_title_1pft3_143",delete:"_delete_1pft3_126"},Je=f.bind(Ge),Ke=()=>{const[r,t]=a.useState([]),[o,n]=a.useState(null),{values:g,setFieldValue:u,errors:p,touched:_,setFieldTouched:h}=T(),[j,{open:x,close:f}]=i(!1),{isDesktop:b,isTablet:v,isMobile:y}=l(),{t:w,i18n:D}=Se(),{getContent:P}=s("refinance_step1");a.useEffect(()=>{t(g.mortgageData)},[g.mortgageData]);const q=()=>{const e={id:ve(r),program:"",balance:null,endDate:"",bid:null};u("mortgageData",[...r,e])},M=e=>{n(e),x()},S=[{value:"option_1",label:P("program_refinance_mortgage_option_1","program_refinance_mortgage_option_1")},{value:"option_2",label:P("program_refinance_mortgage_option_2","program_refinance_mortgage_option_2")},{value:"option_3",label:P("program_refinance_mortgage_option_3","program_refinance_mortgage_option_3")},{value:"option_4",label:P("program_refinance_mortgage_option_4","program_refinance_mortgage_option_4")},{value:"option_5",label:P("program_refinance_mortgage_option_5","program_refinance_mortgage_option_5")}],B=r.reduce((e,a)=>e+a.balance,0);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:Je("mortgage-data"),children:[e.jsxs("div",{className:Je("mortgage-data-title"),children:[e.jsx("h4",{className:Je("mortgage-data-title__text"),children:P("enter_mortgage_info","enter_mortgage_info")}),_.mortgageData&&p.mortgageData&&e.jsx(W,{filled:!0,icon:e.jsx(d,{size:24,color:"#E76143"}),children:e.jsx("p",{children:(()=>{var e;const a=(null==(e=null==g?void 0:g.mortgageBalance)?void 0:e.toLocaleString("en-US"))||"0",r=B.toLocaleString("en-US"),t=(g.mortgageBalance-B).toLocaleString("en-US");return P("error_balance",w("error_balance",{fullBalance:a,sumBalance:r,notEnoughBalance:t})).replace(/\{\{fullBalance\}\}/g,a).replace(/\{\{sumBalance\}\}/g,r).replace(/\{\{notEnoughBalance\}\}/g,t)})()})})]}),b&&e.jsxs("div",{className:Je("mortgage-data-form"),children:[e.jsxs("div",{className:Je("container","title"),children:[e.jsx("p",{className:Je("col","col-1"),children:P("programm","programm")}),e.jsx("p",{className:Je("col","col-2"),children:P("balance","balance")}),e.jsx("p",{className:Je("col","col-3"),children:P("end_date","end_date")}),e.jsx("p",{className:Je("col","col-4"),children:P("bid","bid")}),e.jsx("div",{className:Je("col","col-5")})]}),e.jsxs("div",{className:Je("mortgage-data-form__items"),children:[r.map(a=>{var r,t,o,n,i,l,s,d,c,m,g,j,x,f,b,v;return e.jsxs("div",{className:Je("container"),children:[e.jsx("div",{className:Je("col","col-1"),children:e.jsx(ie,{data:S,placeholder:w("calculate_mortgage_first_ph"),value:a.program,onChange:e=>{u(`mortgageData.${a.id-1}.program`,e),setTimeout(()=>h(`mortgageData.${a.id-1}.program`,!0),0)},error:(null==(t=null==(r=_.mortgageData)?void 0:r[a.id-1])?void 0:t.program)&&(null==(n=null==(o=p.mortgageData)?void 0:o[a.id-1])?void 0:n.program)})}),e.jsx("div",{className:Je("col","col-2"),children:e.jsx(be,{placeholder:"10,000",value:a.balance,handleChange:e=>u(`mortgageData.${a.id-1}.balance`,e),onBlur:()=>h(`mortgageData.${a.id-1}.balance`),error:(null==(l=null==(i=_.mortgageData)?void 0:i[a.id-1])?void 0:l.balance)&&(null==(d=null==(s=p.mortgageData)?void 0:s[a.id-1])?void 0:d.balance)})}),e.jsx("div",{className:Je("col","col-3"),children:e.jsx(ce,{placeholder:w("date_ph"),value:a.endDate,allowFuture:!0,blockPastDates:!0,onChange:e=>u(`mortgageData.${a.id-1}.endDate`,e),onBlur:()=>h(`mortgageData.${a.id-1}.endDate`),error:(null==(m=null==(c=_.mortgageData)?void 0:c[a.id-1])?void 0:m.endDate)&&(null==(j=null==(g=p.mortgageData)?void 0:g[a.id-1])?void 0:j.endDate)})}),e.jsx("div",{className:Je("col","col-4"),children:e.jsx(be,{placeholder:"1",type:"numeric",value:a.bid,handleChange:e=>u(`mortgageData.${a.id-1}.bid`,e),onBlur:()=>h(`mortgageData.${a.id-1}.bid`),error:(null==(f=null==(x=_.mortgageData)?void 0:x[a.id-1])?void 0:f.bid)&&(null==(v=null==(b=p.mortgageData)?void 0:b[a.id-1])?void 0:v.bid),rightSection:e.jsx(_e,{color:"#FFF"})})}),e.jsx("div",{className:Je("col","col-5"),children:1!==a.id&&e.jsx(pe,{onClick:()=>M(a.id),className:Je("delete")})})]},a.id)}),e.jsxs("div",{className:Je("container"),children:[e.jsx("div",{className:Je("col","col-1"),children:e.jsx(he,{variant:"none",color:"#FBE54D",value:P("add_programm","add_programm"),onClick:q})}),e.jsx("div",{className:Je("col","col-2")}),e.jsx("div",{className:Je("col","col-3")}),e.jsx("div",{className:Je("col","col-4")}),e.jsx("div",{className:Je("col","col-5")})]})]})]}),v&&e.jsx("div",{className:Je("mortgage-data-form"),children:e.jsx("div",{className:Je("mortgage-data-form__items"),children:e.jsxs(de,{children:[r.map((t,o)=>{var n,i,l,s,d,g,j,x,f,b,v,y,D,q,B,C;return e.jsxs(a.Fragment,{children:[e.jsxs(ne,{children:[e.jsx(c,{title:`${P("programm","programm")} #${t.id}`}),e.jsx(ie,{data:S,placeholder:w("calculate_mortgage_first_ph"),value:t.program,onChange:e=>{u(`mortgageData.${t.id-1}.program`,e),setTimeout(()=>h(`mortgageData.${t.id-1}.program`,!0),0)},error:(null==(i=null==(n=_.mortgageData)?void 0:n[t.id-1])?void 0:i.program)&&(null==(s=null==(l=p.mortgageData)?void 0:l[t.id-1])?void 0:s.program)})]}),e.jsxs(ne,{children:[e.jsx(c,{title:P("balance","balance")}),e.jsx(be,{placeholder:"10,000",value:t.balance,handleChange:e=>u(`mortgageData.${t.id-1}.balance`,e),onBlur:()=>h(`mortgageData.${t.id-1}.balance`),error:(null==(g=null==(d=_.mortgageData)?void 0:d[t.id-1])?void 0:g.balance)&&(null==(x=null==(j=p.mortgageData)?void 0:j[t.id-1])?void 0:x.balance)})]}),e.jsx(ne,{children:e.jsx(ce,{title:P("end_date","end_date"),placeholder:w("date_ph"),value:t.endDate,allowFuture:!0,blockPastDates:!0,onChange:e=>u(`mortgageData.${t.id-1}.endDate`,e),onBlur:()=>h(`mortgageData.${t.id-1}.endDate`),error:(null==(b=null==(f=_.mortgageData)?void 0:f[t.id-1])?void 0:b.endDate)&&(null==(y=null==(v=p.mortgageData)?void 0:v[t.id-1])?void 0:y.endDate)})}),e.jsxs(ne,{children:[e.jsx(c,{title:P("bid","bid")}),e.jsx(be,{placeholder:"1",value:t.bid,handleChange:e=>u(`mortgageData.${t.id-1}.bid`,e),onBlur:()=>h(`mortgageData.${t.id-1}.bid`),error:(null==(q=null==(D=_.mortgageData)?void 0:D[t.id-1])?void 0:q.bid)&&(null==(C=null==(B=p.mortgageData)?void 0:B[t.id-1])?void 0:C.bid),rightSection:e.jsx(_e,{color:"#FFF"})})]}),1!==t.id&&e.jsx(ne,{children:e.jsxs("div",{className:Je("delete-icon"),children:[e.jsx(pe,{onClick:()=>M(t.id)}),w("delete")]})}),o!==r.length-1&&e.jsx(m,{})]},t.id)}),e.jsx(ne,{children:e.jsx(he,{variant:"none",color:"#FBE54D",value:P("add_programm","add_programm"),onClick:q})})]})})}),y&&e.jsx("div",{className:Je("mortgage-data-form"),children:e.jsx("div",{className:Je("mortgage-data-form__items"),children:e.jsxs(de,{children:[r.map((t,o)=>{var n,i,l,s,d,g,j,x,f,b,v,y,D,q,B,C;return e.jsxs(a.Fragment,{children:[e.jsxs(ne,{children:[e.jsx(c,{title:`${P("programm","programm")} #${t.id}`}),e.jsx(ie,{data:S,placeholder:w("calculate_mortgage_first_ph"),value:t.program,onChange:e=>{u(`mortgageData.${t.id-1}.program`,e),setTimeout(()=>h(`mortgageData.${t.id-1}.program`,!0),0)},error:(null==(i=null==(n=_.mortgageData)?void 0:n[t.id-1])?void 0:i.program)&&(null==(s=null==(l=p.mortgageData)?void 0:l[t.id-1])?void 0:s.program)})]}),e.jsxs(ne,{children:[e.jsx(c,{title:P("balance","balance")}),e.jsx(be,{placeholder:"10,000",value:t.balance,handleChange:e=>u(`mortgageData.${t.id-1}.balance`,e),onBlur:()=>h(`mortgageData.${t.id-1}.balance`),error:(null==(g=null==(d=_.mortgageData)?void 0:d[t.id-1])?void 0:g.balance)&&(null==(x=null==(j=p.mortgageData)?void 0:j[t.id-1])?void 0:x.balance)})]}),e.jsx(ne,{children:e.jsx(ce,{title:P("end_date","end_date"),placeholder:w("date_ph"),value:t.endDate,allowFuture:!0,blockPastDates:!0,onChange:e=>u(`mortgageData.${t.id-1}.endDate`,e),onBlur:()=>h(`mortgageData.${t.id-1}.endDate`),error:(null==(b=null==(f=_.mortgageData)?void 0:f[t.id-1])?void 0:b.endDate)&&(null==(y=null==(v=p.mortgageData)?void 0:v[t.id-1])?void 0:y.endDate)})}),e.jsxs(ne,{children:[e.jsx(c,{title:P("bid","bid")}),e.jsx(be,{placeholder:"1",value:t.bid,handleChange:e=>u(`mortgageData.${t.id-1}.bid`,e),onBlur:()=>h(`mortgageData.${t.id-1}.bid`),error:(null==(q=null==(D=_.mortgageData)?void 0:D[t.id-1])?void 0:q.bid)&&(null==(C=null==(B=p.mortgageData)?void 0:B[t.id-1])?void 0:C.bid),rightSection:e.jsx(_e,{color:"#FFF"})})]}),1!==t.id&&e.jsx(ne,{children:e.jsxs("div",{className:Je("delete-icon"),children:[e.jsx(pe,{onClick:()=>M(t.id)}),w("delete")]})}),o!==r.length-1&&e.jsx(m,{})]},t.id)}),e.jsx(ne,{children:e.jsx(he,{variant:"none",color:"#FBE54D",value:P("add_programm","add_programm"),onClick:q})})]})})})]}),e.jsx(xe,{text:w("remove_programm"),subtitle:w("remove_mortgage_program_subtitle"),isVisible:j,onCancel:f,onSubmit:()=>{if(null!==o){const e=r.filter(e=>e.id!==o);u("mortgageData",e)}f()}})]})},Qe=a.memo(()=>{const{t:r,i18n:t}=Se(),{getContent:o}=s("refinance_step1"),[n,i]=a.useState(51130),[l,d]=a.useState(2654),c=b(),u=v(e=>e.activeField),{data:p,loading:_,error:h,getDropdownProps:j}=oe("refinance_step1"),x=j("why"),f=j("property_type"),w=j("registration"),D=j("bank"),{setFieldValue:P,values:q,errors:M,touched:S,setFieldTouched:B}=T(),C=(q.whyRefinancingMortgage||"").toLowerCase(),N="reduce_monthly_payment"===C||"option_2"===C,k="consolidate_debts"===C||"option_5"===C;return a.useLayoutEffect(()=>{(async()=>{try{const e=await ge.calculateMortgagePayment(q.mortgageBalance,0,4),a=await ge.calculateMortgagePayment(q.mortgageBalance,0,30);Number.isNaN(e)||i(e),0===e&&i(1),Number.isNaN(a)||d(a)}catch(e){i(51130),d(2654)}})()},[q.mortgageBalance]),a.useEffect(()=>{(async()=>{try{if("period"===u){const e=await ge.calculateMortgagePayment(q.mortgageBalance,0,q.period);Number.isNaN(e)||P("monthlyPayment",e)}else{const e=await ge.calculateLoanPeriod(q.mortgageBalance,0,q.monthlyPayment);Number.isNaN(e)||P("period",e)}}catch(e){}})()},[u,P,q.monthlyPayment,q.mortgageBalance,q.period]),e.jsx(e.Fragment,{children:e.jsxs(le,{children:[e.jsx(ue,{title:o("app.refinance.step1.title",r("app.refinance.step1.title"))}),e.jsxs(de,{children:[e.jsx(ne,{children:e.jsx(ie,{data:x.options,title:x.label||o("app.refinance.step1.why_label",r("app.refinance.step1.why_label")),placeholder:x.placeholder||r("mortgage_refinance_why_ph"),value:q.whyRefinancingMortgage,onChange:e=>P("whyRefinancingMortgage",e),onBlur:()=>B("whyRefinancingMortgage"),error:S.whyRefinancingMortgage&&M.whyRefinancingMortgage})}),e.jsxs(ne,{children:[e.jsx(se,{name:"PriceOfEstate",title:o("app.refinance.step1.balance_label",r("app.refinance.step1.balance_label")),value:q.mortgageBalance,placeholder:"1,000,000",handleChange:e=>{c(y("period")),P("mortgageBalance",e)},onBlur:()=>B("mortgageBalance"),error:S.mortgageBalance&&M.mortgageBalance}),S.mortgageBalance&&M.mortgageBalance&&e.jsx(g,{error:M.mortgageBalance})]}),e.jsxs(ne,{children:[e.jsx(se,{handleChange:e=>P("priceOfEstate",e),name:"PriceOfEstate",title:o("app.refinance.step1.property_value_label",r("app.refinance.step1.property_value_label")),value:q.priceOfEstate,placeholder:"1,000,000",error:M.priceOfEstate}),M.priceOfEstate&&e.jsx(g,{error:M.priceOfEstate})]})]}),e.jsxs(de,{children:[e.jsx(ne,{children:e.jsx(ie,{data:f.options,title:f.label||o("app.refinance.step1.property_type_label",r("app.refinance.step1.property_type_label")),placeholder:f.placeholder||r("mortgage_refinance_type_ph"),value:q.typeSelect,onChange:e=>P("typeSelect",e),onBlur:()=>B("typeSelect"),error:S.typeSelect&&M.typeSelect})}),e.jsx(ne,{children:e.jsx(ie,{data:D.options,title:D.label||o("app.refinance.step1.current_bank_label",r("app.refinance.step1.current_bank_label")),placeholder:D.placeholder||r("mortgage_refinance_bank_ph"),value:q.bank,onChange:e=>P("bank",e),onBlur:()=>B("bank"),error:S.bank&&M.bank})}),e.jsx(ne,{children:e.jsx(ie,{data:w.options,title:w.label||o("app.refinance.step1.registered_label",r("app.refinance.step1.registered_label")),placeholder:w.placeholder||r("mortgage_refinance_registered_ph"),value:q.propertyRegistered,onChange:e=>P("propertyRegistered",e),onBlur:()=>B("propertyRegistered"),error:S.propertyRegistered&&M.propertyRegistered})})]}),e.jsxs(de,{children:[e.jsxs(ne,{children:[e.jsx(ce,{title:o("app.refinance.step1.start_date_label",r("app.refinance.step1.start_date_label")),placeholder:r("date_ph"),value:q.startDate,onChange:e=>P("startDate",e),onBlur:()=>B("startDate"),error:S.startDate&&M.startDate}),S.startDate&&M.startDate&&e.jsx(g,{error:M.startDate})]}),N&&e.jsxs(ne,{children:[e.jsx(se,{handleChange:e=>P("decreaseMortgage",e),name:"PriceOfEstate",title:r("mortgage_refinance_decrease"),value:q.decreaseMortgage,placeholder:"1,000,000",onBlur:()=>B("decreaseMortgage"),error:S.decreaseMortgage&&M.decreaseMortgage}),S.decreaseMortgage&&M.decreaseMortgage&&e.jsx(g,{error:M.decreaseMortgage})]}),k&&e.jsxs(ne,{children:[e.jsx(se,{handleChange:e=>P("increaseMortgage",e),name:"PriceOfEstate",title:o("mortgage_refinance_increase",r("mortgage_refinance_increase")),value:q.increaseMortgage,placeholder:"1,000,000",onBlur:()=>B("increaseMortgage"),error:S.increaseMortgage&&M.increaseMortgage}),S.increaseMortgage&&M.increaseMortgage&&e.jsx(g,{error:M.increaseMortgage})]}),e.jsx(ne,{})]}),e.jsx(m,{}),e.jsx(de,{children:e.jsx(Ke,{})}),e.jsx(m,{}),e.jsxs(de,{children:[e.jsxs(ne,{children:[e.jsx(G,{disableCurrency:!0,unitsMax:r("calculate_mortgage_period_units_max"),unitsMin:r("calculate_mortgage_period_units_min"),value:q.period,name:"Period",min:4,max:30,error:M.period,title:r("calculate_mortgage_period"),handleChange:e=>{c(y("period")),P("period",e)}}),M.period&&e.jsx(g,{error:M.period})]}),e.jsxs(ne,{children:[e.jsx(G,{unitsMax:"₪",unitsMin:"₪",value:q.monthlyPayment,name:"monthlyPayment",min:l,max:n,error:M.monthlyPayment,title:r("calculate_mortgage_initial_payment"),handleChange:e=>{c(y("monthlyPayment")),P("monthlyPayment",e),B("monthlyPayment")}}),e.jsx(me,{}),S.monthlyPayment&&M.monthlyPayment&&e.jsx(g,{error:M.monthlyPayment})]}),e.jsx(ne,{})]})]})})}),Xe=()=>z().shape({whyRefinancingMortgage:U().required(q("error_refinance_why_required","Please specify why you want to refinance")),mortgageBalance:Z().test("is-less",q("error_refinance_balance_greater_than_property","Mortgage balance cannot exceed property value"),function(e){const{priceOfEstate:a}=this.parent;return void 0===e||("number"!=typeof a||e<=a)}).required(q("error_required_to_fill_out","This field is required")),priceOfEstate:Z().test("is-greater",q("error_refinance_property_less_than_balance","Property value must be at least the mortgage balance"),function(e){const{mortgageBalance:a}=this.parent;return void 0===e||("number"!=typeof a||e>=a)}).required(q("error_required_to_fill_out","This field is required")),typeSelect:U().required(q("error_refinance_type_required","Property type is required")),bank:U().required(q("error_refinance_bank_required","Current bank is required")),propertyRegistered:U().required(q("error_refinance_registered_required","Property registration status is required")),startDate:U().required(q("error_refinance_start_date_required","Mortgage start date is required")),period:Z().min(4,q("error_min_period","Minimum period is 4 years")).max(30,q("error_max_period","Maximum period is 30 years")).required(q("error_required_to_fill_out","This field is required")),monthlyPayment:Z().positive(q("error_mortgage_payment_positive","Monthly payment must be positive")).required(q("error_required_to_fill_out","This field is required")),decreaseMortgage:U().when("whyRefinancingMortgage",{is:e=>"reduce_monthly_payment"===(e||"").toLowerCase()||"option_2"===(e||"").toLowerCase(),then:e=>e.required(q("error_required_to_fill_out","This field is required")),otherwise:e=>e.notRequired()}),increaseMortgage:U().when("whyRefinancingMortgage",{is:e=>"consolidate_debts"===(e||"").toLowerCase()||"option_5"===(e||"").toLowerCase(),then:e=>e.required(q("error_required_to_fill_out","This field is required")),otherwise:e=>e.notRequired()}),mortgageData:H().of(z().shape({program:U().required(q("error_mortgage_program_required","Mortgage program is required")),balance:Z().positive(q("error_mortgage_balance_positive","Balance must be positive")).required(q("error_mortgage_balance_required","Mortgage balance is required")),endDate:U().required(q("error_mortgage_end_date_required","End date is required")),bid:Z().positive(q("error_mortgage_bid_positive","Bid must be positive")).required(q("error_mortgage_bid_required","Bid is required"))})).test("is-balance-sum-equal",q("error_refinance_mortgage_balance_mismatch","Total mortgage balance must match individual balances"),function(){return this.parent.mortgageData.reduce((e,a)=>e+(a.balance||0),0)===this.parent.mortgageBalance})}),ea=()=>{const{t:a,i18n:t}=Se(),o=b();r();const n=v(e=>e.refinanceMortgage);v(e=>e.login.isLogin);const i={whyRefinancingMortgage:n.whyRefinancingMortgage||"",mortgageBalance:n.mortgageBalance||2e5,priceOfEstate:n.priceOfEstate||1e6,typeSelect:n.typeSelect||"",bank:n.bank||"",startDate:n.startDate||"",propertyRegistered:n.propertyRegistered||"",period:n.period||4,monthlyPayment:n.monthlyPayment||4605,decreaseMortgage:n.decreaseMortgage||null,increaseMortgage:n.increaseMortgage||null,mortgageData:n.mortgageData||[{id:1,program:"",balance:null,endDate:"",bid:null}]};return e.jsxs(e.Fragment,{children:[e.jsx(L,{initialValues:i,validationSchema:Xe(),validateOnMount:!0,onSubmit:e=>{o(w(e)),o(D()),o(P("phoneVerification"))},children:e.jsxs(V,{children:[e.jsxs(u,{children:[e.jsx(Y,{title:a("sidebar_sub_refinance_mortgage"),text:a("refinance_mortgage_promo_text"),size:"small"}),e.jsx(Qe,{})]}),e.jsx(J,{})]})}),e.jsx(K,{}),e.jsx(p,{})]})},aa=()=>{const{t:a,i18n:r}=Se(),t=v(e=>e.login.loginData),o=v(e=>e.refinanceMortgage);return e.jsxs(le,{children:[e.jsx(ue,{title:a("refinance_mortgage_final")}),e.jsx(Q,{cost:null==o?void 0:o.priceOfEstate,initialPayment:null==o?void 0:o.mortgageBalance,period:null==o?void 0:o.period,nameSurname:null==t?void 0:t.nameSurname,phoneNumber:null==t?void 0:t.phoneNumber}),e.jsx(W,{text:a("refinance_mortgage_warning")}),e.jsx(de,{children:e.jsx(X,{})}),e.jsx(ee,{})]})},ra={selectedBank:"",selectedOffer:null},ta=z().shape({selectedBank:U(),selectedOffer:z().nullable()}),oa=()=>{const a=b(),t=r(),o=v(e=>e.login.loginData),n=v(e=>e.login.isLogin);return e.jsx(L,{initialValues:ra,validationSchema:ta,validateOnMount:!0,onSubmit:e=>{a(w(e)),n&&(null==o?void 0:o.phoneNumber)?t("/services/application-submitted"):(a(M()),a(P("signUp")))},children:e.jsxs(V,{children:[e.jsx(u,{children:e.jsx(aa,{})}),e.jsx(Be,{})]})})},na=()=>{Se();const{getContent:r}=s("refinance_step2"),{values:t}=T(),o=v(e=>e.login.loginData),[n,i]=a.useState(null);a.useEffect(()=>{if(!(null==o?void 0:o.nameSurname)||!(null==o?void 0:o.phoneNumber)){const a=localStorage.getItem("USER_DATA");if(a)try{const e=JSON.parse(a);i({nameSurname:e.nameSurname||e.name_surname,phoneNumber:e.phoneNumber||e.mobile_number})}catch(e){}}},[o]);const l=(null==o?void 0:o.nameSurname)?o:n;return e.jsxs(le,{children:[e.jsx(ue,{title:r("refinance_step2_title","calculate_mortgage_step2_title")}),e.jsxs(Ce,{children:[e.jsx(Ye,{}),e.jsx(je,{name:null==l?void 0:l.nameSurname,phone:null==l?void 0:l.phoneNumber})]}),e.jsxs(de,{children:[e.jsx(Ie,{}),e.jsx(Ee,{}),e.jsx(Oe,{screenLocation:"refinance_step2"})]}),e.jsxs(de,{children:[e.jsxs(ne,{style:{gap:"2rem"},children:[e.jsx(Re,{}),"yes"===t.additionalCitizenships&&e.jsx(ze,{})]}),e.jsxs(ne,{style:{gap:"2rem"},children:[e.jsx($e,{}),"yes"===t.taxes&&e.jsx(Ue,{})]}),e.jsxs(ne,{style:{gap:"2rem"},children:[e.jsx(Ae,{}),"yes"===t.childrens&&e.jsx(Ze,{})]})]}),e.jsx(m,{}),e.jsxs(de,{children:[e.jsx(Te,{}),e.jsx(Le,{}),e.jsx(Ve,{})]}),e.jsx(m,{}),e.jsxs(de,{children:[e.jsx(Ne,{}),e.jsx(ne,{}),e.jsx(ne,{})]}),e.jsx(m,{}),e.jsxs(de,{children:[e.jsx(He,{}),e.jsx(ne,{children:"married"===t.familyStatus&&e.jsx(ke,{})}),e.jsx(ne,{children:"yes"===t.partnerPayMortgage&&"married"===t.familyStatus&&e.jsx(Fe,{})})]})]})},ia=z().shape({nameSurname:U().required(q("error_name_surname","Please enter your name and surname")),birthday:U().required(q("error_date","Please enter a valid date")),education:U().required(q("error_select_answer","Please select an answer")),additionalCitizenships:U().required(q("error_select_answer","Please select an answer")),citizenshipsDropdown:H().when("additionalCitizenships",{is:"yes",then:e=>e.min(1,q("error_select_answer","Please select an answer")),otherwise:e=>e.min(0)}),taxes:U().required(q("error_select_answer","Please select an answer")),countriesPayTaxes:H().when("taxes",{is:"yes",then:e=>e.min(1,q("error_select_answer","Please select an answer")),otherwise:e=>e.min(0)}),childrens:U().required(q("error_select_answer","Please select an answer")),howMuchChildrens:Z().required(q("error_fill_field","Please fill this field")),medicalInsurance:U().required(q("error_select_answer","Please select an answer")),isForeigner:U().required(q("error_select_answer","Please select an answer")),publicPerson:U().required(q("error_select_answer","Please select an answer")),borrowers:Z().min(1,q("error_quantity_borrowers","Please specify number of borrowers")).required(q("error_quantity_borrowers","Please specify number of borrowers")),familyStatus:U().required(q("error_select_answer","Please select an answer")),partnerPayMortgage:U().when("familyStatus",{is:"married",then:e=>e.required(q("error_select_answer","Please select an answer")),otherwise:e=>e.notRequired()})}),la=()=>{const a=b(),t=r(),o=v(e=>e.refinanceMortgage),n={nameSurname:v(e=>e.login.loginData).nameSurname||o.nameSurname||"",birthday:o.birthday||new Date((new Date).setFullYear((new Date).getFullYear()-18)).getTime(),education:o.education||"",additionalCitizenships:o.additionalCitizenships||null,citizenshipsDropdown:o.citizenshipsDropdown||[],taxes:o.taxes||null,countriesPayTaxes:o.countriesPayTaxes||[],childrens:o.childrens||null,howMuchChildrens:o.howMuchChildrens||1,medicalInsurance:o.medicalInsurance||null,isForeigner:o.isForeigner||null,publicPerson:o.publicPerson||null,borrowers:o.borrowers||null,familyStatus:o.familyStatus||"",partnerPayMortgage:o.partnerPayMortgage||null,addPartner:o.addPartner||""};return e.jsx(L,{initialValues:n,validationSchema:ia,validateOnMount:!0,onSubmit:e=>{a(w(e)),t("/services/refinance-mortgage/3")},children:e.jsxs(V,{children:[e.jsx(u,{children:e.jsx(na,{})}),e.jsx(Be,{})]})})},sa=()=>{const{t:a}=Se(),{getContent:n}=s("refinance_step3"),i=r(),{values:l}=T(),d=Me("refinance_step3"),{mainSourceOfIncome:g,additionalIncome:u,obligation:p}=l,_=b(),h=v(e=>e.borrowers.sourceOfIncomeModal),j=v(e=>e.borrowers.additionalIncomeModal),x=v(e=>e.borrowers.obligationModal),f=v(e=>e.otherBorrowers.otherBorrowers),y=v(e=>e.login.loginData),D=g||"";return e.jsxs(le,{children:[e.jsx(ue,{title:n("refinance_step3_title","calculate_mortgage_step3_title")}),e.jsx(je,{name:null==y?void 0:y.nameSurname,phone:null==y?void 0:y.phoneNumber}),e.jsxs(de,{children:[e.jsx(ye,{}),d[D]&&d[D].map((a,r)=>e.jsx(t.Fragment,{children:a},r))]}),e.jsx(de,{children:e.jsx(ne,{children:g&&e.jsxs(e.Fragment,{children:[h.map(a=>e.jsx(je,{onEdit:()=>{return e=a.id,void _(I(e));var e},onDelete:()=>{return e=a.id,void _(N({id:e}));var e},enableEdit:!0,name:`${n("source_of_income_label","Source of Income")} ${a.id+1}`},a.id)),e.jsx(he,{onClick:()=>{_(w(l)),_(S())},color:"#FBE54D",value:n("add_place_to_work_button","Add Place to Work"),variant:"none"})]})})}),e.jsx(m,{}),e.jsxs(de,{children:[e.jsx(we,{}),u&&"option_1"!==u&&"no_additional_income"!==u&&e.jsx(De,{}),e.jsx(ne,{})]}),u&&"option_1"!==u&&"no_additional_income"!==u&&e.jsx(de,{children:e.jsxs(ne,{children:[j.map(a=>e.jsx(je,{onEdit:()=>{return e=a.id,void _(E(e));var e},onDelete:()=>{return e=a.id,void _(k({id:e}));var e},enableEdit:!0,name:`${n("additional_source_of_income_label","Additional Source of Income")} ${a.id+1}`},a.id)),e.jsx(he,{onClick:()=>{_(w(l)),_(B())},color:"#FBE54D",value:n("add_additional_source_of_income_button","Add Additional Source of Income"),variant:"none"})]})}),e.jsx(m,{}),e.jsxs(de,{children:[e.jsx(Pe,{}),qe[p]&&qe[p].map((a,r)=>e.jsx(t.Fragment,{children:a},r)),e.jsx(ne,{})]}),p&&"no_obligations"!==p&&e.jsx(de,{children:e.jsxs(ne,{children:[x.map(a=>e.jsx(je,{onEdit:()=>{return e=a.id,void _(O(e));var e},onDelete:()=>{return e=a.id,void _(F({id:e}));var e},enableEdit:!0,name:`${n("obligation_label","Obligation")} ${a.id+1}`},a.id)),e.jsx(he,{onClick:()=>{_(w(l)),_(C())},color:"#FBE54D",value:n("add_obligation_button","Add Obligation"),variant:"none"})]})}),e.jsx(m,{}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[f&&e.jsx(c,{title:a("borrower")}),e.jsxs(de,{style:{columnGap:"2rem"},children:[f.map(a=>e.jsx(ne,{children:e.jsx(je,{onEdit:()=>(e=>{_(R(e));const a=f.some(a=>a.id===e)?e:ve(f);i({pathname:"/services/other-borrowers/1/",search:o({pageId:String(a)}).toString()})})(a.id),onDelete:()=>{return e=a.id,void _($(e));var e},enableEdit:!0,name:a.nameSurname},a.id)},a.id)),!f&&e.jsx(c,{title:a("borrower")}),e.jsx(ne,{children:e.jsx(he,{value:a("add_borrower"),onClick:()=>{_(R(ve(f))),i({pathname:"/services/other-borrowers/1/",search:o({pageId:ve(f).toString()}).toString()})},style:{height:"3.5rem",borderRadius:"0.25rem",padding:"0",width:"13.125rem"}})}),e.jsx(ne,{})]})]})]})},da=()=>{return z().shape({mainSourceOfIncome:U().required(q("error_select_answer","Please select an answer")).test("not-empty",q("error_select_answer","Please select an answer"),e=>null!=e&&""!==e),monthlyIncome:Z().when("mainSourceOfIncome",{is:e=>["employee","selfemployed","pension","student","other"].includes(e),then:e=>e.required(q("error_fill_field","Please fill this field")),otherwise:e=>e.notRequired()}),startDate:U().when("mainSourceOfIncome",{is:e=>["employee","selfemployed"].includes(e),then:e=>e.required(q("error_date","Please enter a valid date")),otherwise:e=>e.notRequired()}),fieldOfActivity:U().when("mainSourceOfIncome",{is:e=>["employee","selfemployed"].includes(e),then:e=>e.required(q("error_select_field_of_activity","Please select field of activity")),otherwise:e=>e.notRequired()}),profession:U().when("mainSourceOfIncome",{is:e=>["employee","selfemployed"].includes(e),then:e=>e.required(q("error_fill_field","Please fill this field")),otherwise:e=>e.notRequired()}),companyName:U().when("mainSourceOfIncome",{is:e=>["employee","selfemployed"].includes(e),then:e=>e.required(q("error_fill_field","Please fill this field")),otherwise:e=>e.notRequired()}),additionalIncome:U().required(q("error_select_one_of_the_options","Please select one of the options")),additionalIncomeAmount:Z().when("additionalIncome",{is:e=>null!=e&&""!==e&&"option_1"!==e&&"no_additional_income"!==e,then:e=>e.required(q("error_fill_field","Please fill this field")),otherwise:e=>e.notRequired()}),obligation:U().required((e="error_select_one_of_the_options",a="Please select one of the options",q(e,a))),bank:U().when("obligation",{is:e=>null!=e&&""!==e&&"option_1"!==e&&"no_obligations"!==e,then:e=>e.required(q("error_select_bank","Please select a bank")),otherwise:e=>e.notRequired()}),monthlyPaymentForAnotherBank:Z().when("obligation",{is:e=>null!=e&&""!==e&&"option_1"!==e&&"no_obligations"!==e,then:e=>e.required(q("error_fill_field","Please fill this field")),otherwise:e=>e.notRequired()}),endDate:U().when("obligation",{is:e=>null!=e&&""!==e&&"option_1"!==e&&"no_obligations"!==e,then:e=>e.required(q("error_date","Please enter a valid date")),otherwise:e=>e.notRequired()})});var e,a};da();const ca=()=>{const a=b(),t=r(),o=v(e=>e.refinanceMortgage),n={mainSourceOfIncome:o.mainSourceOfIncome||"",monthlyIncome:o.monthlyIncome||null,startDate:o.startDate||null,fieldOfActivity:o.fieldOfActivity||"",profession:o.profession||"",companyName:o.companyName||"",additionalIncome:o.additionalIncome||"option_1",additionalIncomeAmount:o.additionalIncomeAmount||null,obligation:o.obligation||"option_1",bank:o.bank||"",monthlyPaymentForAnotherBank:o.monthlyPaymentForAnotherBank||null,endDate:o.endDate||null,amountIncomeCurrentYear:(null==o?void 0:o.amountIncomeCurrentYear)||null,noIncome:o.noIncome||null};return e.jsxs(e.Fragment,{children:[e.jsx(L,{initialValues:n,validationSchema:da(),validateOnMount:!0,onSubmit:e=>{a(w(e)),t("/services/refinance-mortgage/4")},children:e.jsxs(V,{children:[e.jsx(u,{children:e.jsx(sa,{})}),e.jsx(Be,{})]})}),e.jsx(ae,{}),e.jsx(re,{}),e.jsx(te,{})]})},ma=a=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",...a,children:e.jsx("path",{fill:"#FBE54D",d:"M21 9.75a.75.75 0 1 1-1.5 0V5.561l-6.218 6.22a.75.75 0 1 1-1.062-1.062L18.44 4.5H14.25a.75.75 0 1 1 0-1.5h6a.75.75 0 0 1 .75.75v6ZM17.25 12a.75.75 0 0 0-.75.75v6.75h-12v-12h6.75a.75.75 0 1 0 0-1.5H4.5A1.5 1.5 0 0 0 3 7.5v12A1.5 1.5 0 0 0 4.5 21h12a1.5 1.5 0 0 0 1.5-1.5v-6.75a.75.75 0 0 0-.75-.75Z"})}),ga=a=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",...a,children:e.jsx("path",{fill:"#fff",d:"M21.788 10.734 8.28 2.47a1.5 1.5 0 0 0-2.075.516A1.487 1.487 0 0 0 6 3.738v16.525a1.494 1.494 0 0 0 1.5 1.487c.277 0 .548-.076.784-.22l13.504-8.263a1.481 1.481 0 0 0 0-2.531v-.002ZM7.5 20.244V3.75L20.984 12 7.5 20.245Z"})}),ua=a=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:33,height:32,fill:"none",...a,children:e.jsx("path",{fill:"#fff",d:"M28.5 19v7a2 2 0 0 1-2 2h-20a2 2 0 0 1-2-2v-7a1 1 0 1 1 2 0v7h20v-7a1 1 0 0 1 2 0Zm-16.293-8.293L15.5 7.414V19a1 1 0 0 0 2 0V7.414l3.293 3.293a1 1 0 1 0 1.415-1.415l-5-5a1 1 0 0 0-1.415 0l-5 5a1 1 0 0 0 1.415 1.415Z"})}),pa=f.bind({"upload-buttons":"_upload-buttons_3j3y8_1","upload-report-file":"_upload-report-file_3j3y8_6","upload-report-file__wrapper":"_upload-report-file__wrapper_3j3y8_22","upload-report-file__text":"_upload-report-file__text_3j3y8_28","submit-buttons":"_submit-buttons_3j3y8_34","submit-buttons__wrapper":"_submit-buttons__wrapper_3j3y8_44"}),_a=()=>{const{t:a,i18n:t}=Se(),o=r();return e.jsx("div",{className:"step1",children:e.jsxs("div",{className:"home step1-container noborder",children:[e.jsx(ue,{title:a("upload_report_title"),subtitle:a("upload_report_subtitle")}),e.jsxs("div",{className:pa("upload-buttons"),children:[e.jsx(fe,{text:a("video_instruction"),leftSection:e.jsx(ga,{})}),e.jsx(fe,{text:a("download_report_here"),rightSection:e.jsx(ma,{}),onClick:()=>window.open("https://www.creditdata.org.il/","_blank")})]}),e.jsx(m,{}),e.jsx(We,{onDrop:e=>{},children:({getRootProps:r,getInputProps:t})=>e.jsx("section",{className:pa("upload-report-file"),children:e.jsxs("div",{...r(),className:pa("upload-report-file__wrapper"),children:[e.jsx("input",{...t()}),e.jsx(ua,{}),e.jsxs("p",{className:pa("upload-report-file__text"),children:[a("dropzone_upload_report"),e.jsx("span",{style:{color:"#FBE54D"},children:a("dropzone_comp_upload_report")})]})]})})}),e.jsx("div",{className:pa("submit-buttons"),children:e.jsxs("div",{className:pa("submit-buttons__wrapper"),children:[e.jsx(_,{title:a("button_back"),handleClick:()=>o("/services/refinance-mortgage/1")}),e.jsx(h,{onClick:()=>o("/services/refinance-mortgage/1"),children:a("button_next_save")})]})})]})})},ha=()=>{const{stepNumber:t}=n(),{t:o,i18n:i}=Se(),l=r();if(!v(e=>e.login.isLogin)&&"1"!==t)return void l("/services/refinance-mortgage/1");const s=[o("mobile_step_1"),o("mobile_step_2"),o("mobile_step_3"),o("mobile_step_4")];let d;switch(t){case"1":d=e.jsx(ea,{});break;case"2":d=e.jsx(la,{});break;case"3":d=e.jsx(ca,{});break;case"4":d=e.jsx(oa,{});break;case"upload-report":d=e.jsx(_a,{});break;default:d=e.jsx(A,{type:"NOT_FOUND"})}const c="upload-report"===t?"1":t;return e.jsxs(e.Fragment,{children:["upload-report"!==t&&e.jsx(x,{progress:c,data:s}),"upload-report"===t&&e.jsx(x,{progress:"1",data:[o("upload_report_progress"),o("mobile_step_2"),o("mobile_step_3")]}),e.jsx(a.Suspense,{fallback:e.jsx(j,{}),children:d})]})};export{ha as RefinanceMortgage};
