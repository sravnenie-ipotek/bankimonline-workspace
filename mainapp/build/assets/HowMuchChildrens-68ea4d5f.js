import{j as e}from"./ui-vendor-19e4e52b.js";import{u as S}from"./form-vendor-67b0fc1d.js";import{r as n}from"./react-vendor-9ed0ad78.js";import{C as y}from"./Column-ab439506.js";import{g as A,h as L,E as I,T as v,a as M}from"./index-0069b652.js";import{c as V}from"./index-40267bc7.js";import{M as H}from"./DropdownMenu-4da55dc4.js";import{u as R}from"./i18n-vendor-e8db3f4c.js";import{F as Z}from"./FormattedInput-a21a07a2.js";const J=i=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:17,height:16,fill:"none",...i,children:e.jsx("path",{fill:"#fff",d:"M5.634 10.867a.632.632 0 0 0 .467.184.632.632 0 0 0 .466-.184l1.934-1.933 1.95 1.95c.122.122.275.18.458.175a.65.65 0 0 0 .458-.192.632.632 0 0 0 .184-.466.632.632 0 0 0-.184-.467L9.434 8.001l1.95-1.95a.594.594 0 0 0 .175-.459.65.65 0 0 0-.192-.458.632.632 0 0 0-.466-.183.632.632 0 0 0-.467.183L8.501 7.067l-1.95-1.95a.595.595 0 0 0-.458-.175.653.653 0 0 0-.459.192.632.632 0 0 0-.183.467c0 .189.06.344.183.466l1.933 1.934-1.95 1.95a.593.593 0 0 0-.174.458.65.65 0 0 0 .191.458Zm2.867 3.8a6.489 6.489 0 0 1-2.6-.525 6.728 6.728 0 0 1-2.117-1.425 6.728 6.728 0 0 1-1.425-2.116A6.489 6.489 0 0 1 1.834 8c0-.923.175-1.79.525-2.6a6.728 6.728 0 0 1 1.425-2.117c.6-.6 1.306-1.075 2.117-1.425a6.495 6.495 0 0 1 2.6-.525c.922 0 1.789.175 2.6.525.81.35 1.516.825 2.116 1.425.6.6 1.075 1.306 1.425 2.117.35.81.525 1.677.525 2.6 0 .922-.175 1.789-.525 2.6a6.728 6.728 0 0 1-1.425 2.116c-.6.6-1.305 1.075-2.116 1.425a6.49 6.49 0 0 1-2.6.525Zm0-1.333c1.477 0 2.736-.52 3.775-1.558 1.039-1.04 1.558-2.298 1.558-3.775 0-1.478-.52-2.737-1.558-3.776-1.04-1.038-2.298-1.558-3.775-1.558-1.478 0-2.736.52-3.775 1.558-1.04 1.04-1.559 2.298-1.559 3.776 0 1.477.52 2.736 1.559 3.775 1.039 1.039 2.297 1.558 3.775 1.558Z"})}),U="_multiselect_18kzf_1",q="_focus_18kzf_140",G="_error_18kzf_144",B="_checkbox_18kzf_148",K={multiselect:U,"multiselect-scroll":"_multiselect-scroll_18kzf_10","multiselect-wrapper":"_multiselect-wrapper_18kzf_14","multiselect-placeholder":"_multiselect-placeholder_18kzf_22","multiselect-input":"_multiselect-input_18kzf_33","multiselect-input__item":"_multiselect-input__item_18kzf_38","multiselect-select":"_multiselect-select_18kzf_50","multiselect-select__button":"_multiselect-select__button_18kzf_61","multiselect-select__button-item":"_multiselect-select__button-item_18kzf_64","multiselect-select__subtitle":"_multiselect-select__subtitle_18kzf_75","multiselect-select__item":"_multiselect-select__item_18kzf_84","multiselect-select__item-title":"_multiselect-select__item-title_18kzf_99","multiselect-select__search":"_multiselect-select__search_18kzf_104","multiselect-select__search-wrapper":"_multiselect-select__search-wrapper_18kzf_107","multiselect-select__search-input":"_multiselect-select__search-input_18kzf_117","multiselect-select__search-no-result":"_multiselect-select__search-no-result_18kzf_134",focus:q,error:G,checkbox:B},l=V.bind(K),D=({data:i,placeholder:f,onChange:c,value:s,searchable:p,searchPlaceholder:x,nothingFoundText:b,searchDescription:C,onBlur:w,error:z})=>{const{t:N,i18n:E}=R(),[r,m]=n.useState(!1),[u,a]=n.useState(""),[d,k]=n.useState([]),g=n.useRef(null);n.useEffect(()=>{r&&k(s||[])},[r,s]);const _=n.useCallback(t=>{g.current&&!g.current.contains(t.target)&&m(!1)},[]),j=n.useCallback(t=>{g.current&&g.current.contains(t.relatedTarget)||(r&&JSON.stringify(d.sort())!==JSON.stringify((s||[]).sort())&&(c==null||c(d)),m(!1),w==null||w())},[r,d,s,c,w]),T=t=>{k(o=>o.includes(t)?o.filter(h=>h!==t):[...o,t])},P=(t,o)=>{const h=(s==null?void 0:s.filter(O=>O!==t))||[];c==null||c(h),k(O=>O.filter($=>$!==t)),o.stopPropagation()};n.useEffect(()=>(document.addEventListener("mousedown",_),()=>document.removeEventListener("mousedown",_)),[_]);const F=Array.isArray(i)?i.filter(t=>(typeof t=="string"?t:String(t)).toLowerCase().includes(u.toLowerCase())):[];return e.jsxs(e.Fragment,{children:[e.jsxs("div",{ref:g,onBlur:j,className:l("multiselect",`${r&&"focus"}`,`${z&&!r&&"error"}`),children:[e.jsxs("div",{className:l("multiselect-wrapper"),onClick:()=>m(!r),tabIndex:0,children:[e.jsx("div",{className:l("multiselect-input","truncate"),children:s&&s.length>0?s.map(t=>e.jsxs("div",{className:l("multiselect-input__item"),children:[t,e.jsx(J,{onClick:o=>P(t,o)})]},t)):e.jsx("span",{className:l("multiselect-placeholder"),children:f})}),r?e.jsx(A,{className:"cursor-pointer",onClick:()=>m(!1)}):e.jsx(L,{className:"cursor-pointer",onClick:()=>m(!0)})]}),r&&e.jsxs("div",{className:l("multiselect-select"),onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:l("multiselect-scroll","scrollbar scrollbar-thumb-gray-600 scrollbar-thumb-rounded-md scrollbar-w-1"),children:[p&&e.jsx("div",{className:l("multiselect-select__search"),children:e.jsxs("div",{className:l("multiselect-select__search-wrapper"),children:[e.jsx(H,{}),e.jsx("input",{tabIndex:0,className:l("multiselect-select__search-input"),value:u,onChange:t=>a(t.target.value),placeholder:x,autoComplete:"off"})]})}),e.jsx("div",{className:l("multiselect-select__subtitle"),children:C}),F.length>0?F.map((t,o)=>e.jsx("div",{tabIndex:0,className:l("multiselect-select__item"),onClick:h=>{h.stopPropagation(),T(t)},children:e.jsxs("div",{className:l("multiselect-select__item-title"),children:[e.jsx("input",{type:"checkbox",id:`${t}-${o}`,className:l("checkbox"),checked:d.includes(t),onChange:()=>T(t),onClick:h=>h.stopPropagation()}),e.jsx("label",{htmlFor:`${t}-${o}`,onClick:h=>h.stopPropagation(),children:t})]})},o)):e.jsx("p",{className:l("multiselect-select__search-no-result"),children:b})]}),e.jsx("div",{className:l("multiselect-select__button"),children:e.jsx("button",{type:"button",className:l("multiselect-select__button-item"),onClick:t=>{t.stopPropagation(),c==null||c(d),m(!1)},children:N("apply")})})]})]}),z&&!r&&e.jsx(I,{error:z})]})},ie=()=>{const{values:i,setFieldValue:f,errors:c,touched:s,setFieldTouched:p,validateField:x}=S(),[b,C]=n.useState([]),[w,z]=n.useState(!0),[N,E]=n.useState(null);n.useEffect(()=>{(async()=>{try{z(!0),E(null);const a=await fetch("/api/dropdowns/mortgage_step2/he");if(!a.ok)throw new Error(`HTTP ${a.status}: ${a.statusText}`);const d=await a.json(),k=[];Object.keys(d.options).forEach(_=>{if(_.includes("citizenship")&&_!=="mortgage_step2_citizenship"){const j=d.options[_];Array.isArray(j)&&j.length>0&&k.push(...j)}});const g=k.filter((_,j,T)=>T.findIndex(P=>P.value===_.value)===j);C(g)}catch(a){console.error("❌ Error fetching citizenship options:",a),E(a instanceof Error?a.message:"Unknown error")}finally{z(!1)}})()},[]);const r=u=>{f("citizenshipsDropdown",u,!0),p("citizenshipsDropdown",!0,!0),setTimeout(()=>{u.includes("option_1")&&console.log("Citizenship validation:",u),x("citizenshipsDropdown")},100)};if(w)return e.jsxs(y,{gap:"16px",children:[e.jsx(v,{title:"אזרחות"}),e.jsx("div",{children:"Loading citizenship options..."})]});if(N)return e.jsxs(y,{gap:"16px",children:[e.jsx(v,{title:"אזרחות"}),e.jsxs("div",{children:["Error loading citizenship options: ",N]})]});const m=i.citizenshipsDropdown||[];return e.jsxs(y,{gap:"16px",children:[e.jsx(v,{title:"אזרחות"}),e.jsx(D,{data:b.map(u=>u.label),value:m,onChange:r,onBlur:()=>p("citizenshipsDropdown",!0),placeholder:"בחר אזרחות",searchable:!0,searchPlaceholder:"חפש מדינה...",searchDescription:"בחר אזרחויות נוספות ולחץ על 'החל'",nothingFoundText:"לא נמצאו תוצאות",error:s.citizenshipsDropdown&&c.citizenshipsDropdown})]})},re=()=>{const{getContent:i}=M("mortgage_step2"),{values:f,setFieldValue:c,errors:s,touched:p,setFieldTouched:x}=S(),b=["ישראל","ארצות הברית","רוסיה","גרמניה","צרפת","בריטניה","קנדה","אוסטרליה","איטליה","ספרד","הולנד","בלגיה","שוויץ","אוסטריה","שוודיה","נורווגיה","דנמרק","פינלנד","פולין","צ'כיה","הונגריה","רומניה","בולגריה","יוון","קפריסין","פורטוגל","אירלנד","לוקסמבורג","מלטה","סלובקיה","סלובניה","קרואטיה","ליטא","לטביה","אסטוניה","אוקראינה","בלרוס","מולדובה","ארגנטינה","ברזיל","צ'ילה","מקסיקו","יפן","דרום קוריאה","סין","הודו","תאילנד","סינגפור","מלזיה","פיליפינים","אינדונזיה","וייטנאם","דרום אפריקה","מרוקו","מצרים","טורקיה","אחר"];return e.jsxs(y,{children:[e.jsx(v,{title:i("calculate_mortgage_tax","calculate_mortgage_tax")}),e.jsx(D,{data:b,placeholder:i("calculate_mortgage_citizenship_ph","calculate_mortgage_citizenship_ph"),searchable:!0,searchPlaceholder:i("search","search"),nothingFoundText:i("nothing_found","nothing_found"),searchDescription:i("countries","countries"),value:f.countriesPayTaxes,onChange:C=>c("countriesPayTaxes",C),onBlur:()=>x("countriesPayTaxes",!0),error:p.countriesPayTaxes&&s.countriesPayTaxes})]})},oe=()=>{const{getContent:i}=M("mortgage_step2"),{values:f,setFieldValue:c,errors:s,touched:p}=S();return e.jsxs(y,{children:[e.jsx(Z,{name:"HowManyBorrowers",handleChange:x=>c("howMuchChildrens",x),title:i("calculate_mortgage_how_much_childrens","calculate_mortgage_how_much_childrens"),placeholder:"0",disableCurrency:!0,value:f.howMuchChildrens,error:s.howMuchChildrens}),p.howMuchChildrens&&s.howMuchChildrens&&e.jsx(I,{error:s.howMuchChildrens})]})};export{ie as C,oe as H,re as a};
