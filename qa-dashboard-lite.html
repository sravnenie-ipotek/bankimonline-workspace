<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>QA Dashboard (Zero Impact)</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #0d1117; 
            color: #c9d1d9; 
            padding: 20px;
        }
        .container { max-width: 1200px; margin: 0 auto; }
        h1 { margin-bottom: 20px; color: #58a6ff; }
        .stats { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); 
            gap: 15px; 
            margin-bottom: 30px;
        }
        .stat-card {
            background: #161b22;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #30363d;
        }
        .stat-value { 
            font-size: 2em; 
            font-weight: bold; 
            margin-bottom: 5px;
        }
        .stat-label { 
            color: #8b949e; 
            font-size: 0.9em;
        }
        .pass { color: #3fb950; }
        .fail { color: #f85149; }
        .warn { color: #d29922; }
        .log {
            background: #0d1117;
            border: 1px solid #30363d;
            border-radius: 8px;
            padding: 15px;
            height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        .log-entry { 
            padding: 5px 0; 
            border-bottom: 1px solid #21262d;
        }
        .info { color: #8b949e; }
        .success { color: #3fb950; }
        .error { color: #f85149; }
        .zero-impact {
            background: #0d4429;
            border: 1px solid #3fb950;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ QA Dashboard - Real-time (Zero Performance Impact)</h1>
        
        <div class="zero-impact">
            ‚úÖ <strong>Zero Impact Design:</strong> 
            This dashboard only reads pre-generated log files. 
            No active monitoring, no CPU usage, no memory overhead!
        </div>

        <div class="stats">
            <div class="stat-card">
                <div class="stat-value pass" id="tests-passed">0</div>
                <div class="stat-label">Tests Passed Today</div>
            </div>
            <div class="stat-card">
                <div class="stat-value fail" id="tests-failed">0</div>
                <div class="stat-label">Tests Failed</div>
            </div>
            <div class="stat-card">
                <div class="stat-value warn" id="files-changed">0</div>
                <div class="stat-label">Files Changed</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="last-run">Never</div>
                <div class="stat-label">Last Test Run</div>
            </div>
        </div>

        <h2 style="margin-bottom: 10px; color: #58a6ff;">üìä Test Results Log</h2>
        <div class="log" id="test-log">
            <div class="log-entry info">Waiting for test results...</div>
        </div>
    </div>

    <script>
        // ZERO IMPACT: Only reads log file every 5 seconds
        // No WebSockets, no constant connections, minimal resource use
        
        let stats = {
            passed: 0,
            failed: 0,
            filesChanged: 0,
            lastRun: 'Never'
        };

        async function updateDashboard() {
            try {
                // Fetch from local server (works both as file:// and http://)
                const response = await fetch('http://localhost:3456/stats?' + Date.now()).catch(() => {
                    // Fallback to relative path if served by server
                    return fetch('/stats?' + Date.now());
                });
                if (response && response.ok) {
                    const data = await response.json();
                    
                    // Update stats
                    document.getElementById('tests-passed').textContent = data.passed || 0;
                    document.getElementById('tests-failed').textContent = data.failed || 0;
                    document.getElementById('files-changed').textContent = data.filesChanged || 0;
                    document.getElementById('last-run').textContent = data.lastRun || 'Never';
                    
                    // Update log
                    if (data.recentLogs) {
                        const logDiv = document.getElementById('test-log');
                        logDiv.innerHTML = data.recentLogs.map(log => {
                            const cssClass = log.type === 'pass' ? 'success' : 
                                           log.type === 'fail' ? 'error' : 'info';
                            return `<div class="log-entry ${cssClass}">${log.message}</div>`;
                        }).join('');
                        logDiv.scrollTop = logDiv.scrollHeight;
                    }
                }
            } catch (e) {
                // Silently fail - no impact on performance
            }
        }

        // Update every 5 seconds (very lightweight)
        setInterval(updateDashboard, 5000);
        updateDashboard(); // Initial load
        
        // Show dashboard is live
        setInterval(() => {
            document.title = document.title.includes('‚óè') ? 
                'QA Dashboard (Zero Impact)' : 
                '‚óè QA Dashboard (Zero Impact)';
        }, 1000);
    </script>
</body>
</html>