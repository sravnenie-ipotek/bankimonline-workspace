<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Validation Debug</title>
    <script src="https://unpkg.com/yup@1.3.3/dist/yup.min.js"></script>
</head>
<body>
    <h1>Validation Debug Test</h1>
    <div id="output"></div>

    <script>
        // Test the validation logic with the actual schema
        const validationSchema = Yup.object().shape({
            mainSourceOfIncome: Yup.string().required('Please select an answer'),
            monthlyIncome: Yup.number().when('mainSourceOfIncome', {
                is: (value) => value !== null && value !== undefined && value !== '' && !['unpaid_leave', 'unemployed'].includes(value),
                then: (schema) => schema.required('Please fill this field'),
                otherwise: (schema) => schema.notRequired(),
            }),
            startDate: Yup.string().when('mainSourceOfIncome', {
                is: (value) => value !== null && value !== undefined && value !== '' && !['unpaid_leave', 'unemployed'].includes(value),
                then: (schema) => schema.required('Please enter a valid date'),
                otherwise: (schema) => schema.notRequired(),
            }),
        });

        // Test different scenarios with actual dropdown values
        const testCases = [
            { mainSourceOfIncome: '', monthlyIncome: null, startDate: '' },
            { mainSourceOfIncome: 'employee', monthlyIncome: null, startDate: '' },
            { mainSourceOfIncome: 'employee', monthlyIncome: 5000, startDate: '2023-01-01' },
            { mainSourceOfIncome: 'selfemployed', monthlyIncome: null, startDate: '' },
            { mainSourceOfIncome: 'selfemployed', monthlyIncome: 5000, startDate: '2023-01-01' },
            { mainSourceOfIncome: 'unemployed', monthlyIncome: null, startDate: '' },
            { mainSourceOfIncome: 'unpaid_leave', monthlyIncome: null, startDate: '' },
        ];

        const output = document.getElementById('output');
        
        testCases.forEach((testCase, index) => {
            const div = document.createElement('div');
            div.style.margin = '20px';
            div.style.padding = '10px';
            div.style.border = '1px solid #ccc';
            
            div.innerHTML = `
                <h3>Test Case ${index + 1}</h3>
                <p><strong>Input:</strong> ${JSON.stringify(testCase)}</p>
                <p><strong>Is Valid:</strong> <span id="valid-${index}">Checking...</span></p>
                <p><strong>Errors:</strong> <span id="errors-${index}">Checking...</span></p>
            `;
            
            output.appendChild(div);
            
            // Validate
            validationSchema.validate(testCase, { abortEarly: false })
                .then(() => {
                    document.getElementById(`valid-${index}`).textContent = 'YES';
                    document.getElementById(`errors-${index}`).textContent = 'None';
                })
                .catch((errors) => {
                    document.getElementById(`valid-${index}`).textContent = 'NO';
                    document.getElementById(`errors-${index}`).textContent = errors.errors.join(', ');
                });
        });
    </script>
</body>
</html> 