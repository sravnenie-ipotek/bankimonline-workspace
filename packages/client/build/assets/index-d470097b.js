import{j as e}from"./ui-vendor-5a9cd79c.js";import{r as F,f as re,b as Pe,j as Be,k as $e}from"./react-vendor-19e41fc0.js";import{c as Te,u as Ve,a as he,W as Le,T as G,D as O,E as Q,b as fe,A as ze,d as Ue,B as We,L as Ze}from"./index-44d8657f.js";import{P as qe}from"./ProgressBar-0e5e5205.js";import{c as ke,a as le,u as v,k as we,E as ae,m as He,d as Ee,n,o as Ye,p as Ge,q as Je,r as Ke,t as Qe,v as Xe,w as ea,x as aa,y as ra,z as ta,A as Ie,B as oa,N as na}from"./index-82c03faf.js";import{u as xe,F as je,b as be,a as se,c as x,f as N,g as Se}from"./form-vendor-429348f6.js";import{V as ia}from"./VideoPoster-8c6471f6.js";import{A as Ae,S as Ce,a as sa,M as la,U as ca,F as da,B as ga,b as ma,c as pa,O as _a}from"./SourceOfIncomeModal-05ce8fd6.js";import{u as ua}from"./useDropdownData-26d062c8.js";import{C as l}from"./Column-966fba25.js";import{D as X}from"./DropdownMenu-b6e6fbb5.js";import{F as ye}from"./FormContainer-132d032d.js";import{F as me}from"./FormattedInput-71317abc.js";import{R as b}from"./Row-a8c2e855.js";import{C as _e}from"./Calendar-e939955e.js";import{I as ha,c as pe}from"./IncreasePayment-aab3b15a.js";import{F as ge}from"./FormCaption-ef258fee.js";import{D as De}from"./DeleteIcon-b228fd68.js";import{P as ve}from"./PercentIcon-69cb9491.js";import{A as ee,U as ie}from"./AddButton-c0ca1d4a.js";import{E as fa,N as Fe}from"./ExitModule-19a1d4cc.js";import{C as oe}from"./Control-6a316830.js";import{g as ue,M as xa,c as Ne,A as ja,a as ba,O as ya,b as Oe}from"./componentsByIncomeSource-d64036c5.js";import{u as J}from"./i18n-vendor-5cfd36a0.js";import{D as Me}from"./DoubleButtons-f26261f6.js";import{R as wa}from"./RowTwo-c68ad8e7.js";import{B as Da,P as va,A as Sa}from"./PartnerPayMortgage-5b32c381.js";import{N as Ma,B as Pa,E as Ba,A as qa,T as Ia,C as Ca,M as Fa,I as Na,P as Oa}from"./Taxes-e4942736.js";import{C as ka,a as Ea,H as Aa}from"./HowMuchChildrens-8ce3e3fc.js";import{F as Ra}from"./FamilyStatus-c9b56afd.js";import{I as $a}from"./Info-d162f33d.js";import{D as Ta}from"./components-vendor-e60b5450.js";import"./utils-vendor-48989965.js";import"./state-vendor-2a767ce0.js";import"./MortgageParameters-895e19dd.js";import"./ShieldCheckIcon-a0d68f8f.js";const Va="_container_1pft3_60",La="_col_1pft3_66",za="_title_1pft3_143",Ua={"mortgage-data":"_mortgage-data_1pft3_1","mortgage-data-title":"_mortgage-data-title_1pft3_6","mortgage-data-title__text":"_mortgage-data-title__text_1pft3_20","mortgage-data-title__button":"_mortgage-data-title__button_1pft3_26","mortgage-data-form":"_mortgage-data-form_1pft3_42","mortgage-data-form__items":"_mortgage-data-form__items_1pft3_48","button-left__icon":"_button-left__icon_1pft3_54",container:Va,col:La,"col-1":"_col-1_1pft3_72","col-2":"_col-2_1pft3_82","col-3":"_col-3_1pft3_92","col-4":"_col-4_1pft3_102","col-5":"_col-5_1pft3_112","delete-icon":"_delete-icon_1pft3_126",title:za,delete:"_delete_1pft3_126"},f=ke.bind(Ua),Wa=()=>{var w;const[a,g]=F.useState([]),[r,i]=F.useState(null),{values:c,setFieldValue:s,errors:m,touched:_,setFieldTouched:p}=xe(),[ce,{open:te,close:de}]=Te(!1),{isDesktop:P,isTablet:q,isMobile:A}=Ve(),{t:y,i18n:K}=J(),{getContent:d}=he("refinance_step1");F.useEffect(()=>{g(c.mortgageData)},[c.mortgageData]);const j=()=>{const B={id:ue(a),program:"",balance:null,endDate:"",bid:null};s("mortgageData",[...a,B])},u=t=>{i(t),te()},D=()=>{if(r!==null){const t=a.filter(B=>B.id!==r);s("mortgageData",t)}de()},S=[{value:"option_1",label:d("program_refinance_mortgage_option_1","program_refinance_mortgage_option_1")},{value:"option_2",label:d("program_refinance_mortgage_option_2","program_refinance_mortgage_option_2")},{value:"option_3",label:d("program_refinance_mortgage_option_3","program_refinance_mortgage_option_3")},{value:"option_4",label:d("program_refinance_mortgage_option_4","program_refinance_mortgage_option_4")},{value:"option_5",label:d("program_refinance_mortgage_option_5","program_refinance_mortgage_option_5")}],h=a.reduce((t,B)=>t+B.balance,0);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:f("mortgage-data"),children:[e.jsxs("div",{className:f("mortgage-data-title"),children:[e.jsx("h4",{className:f("mortgage-data-title__text"),children:d("enter_mortgage_info","enter_mortgage_info")}),_.mortgageData&&m.mortgageData&&e.jsx(Ae,{filled:!0,icon:e.jsx(Le,{size:24,color:"#E76143"}),children:e.jsx("p",{children:y("error_balance",{fullBalance:(w=c==null?void 0:c.mortgageBalance)==null?void 0:w.toLocaleString("en-US"),sumBalance:h.toLocaleString("en-US"),notEnoughBalance:(c.mortgageBalance-h).toLocaleString("en-US")})})})]}),P&&e.jsxs("div",{className:f("mortgage-data-form"),children:[e.jsxs("div",{className:f("container","title"),children:[e.jsx("p",{className:f("col","col-1"),children:d("programm","programm")}),e.jsx("p",{className:f("col","col-2"),children:d("balance","balance")}),e.jsx("p",{className:f("col","col-3"),children:d("end_date","end_date")}),e.jsx("p",{className:f("col","col-4"),children:d("bid","bid")}),e.jsx("div",{className:f("col","col-5")})]}),e.jsxs("div",{className:f("mortgage-data-form__items"),children:[a.map(t=>{var B,o,I,k,E,R,$,T,V,L,z,U,W,Z,H,Y;return e.jsxs("div",{className:f("container"),children:[e.jsx("div",{className:f("col","col-1"),children:e.jsx(X,{data:S,placeholder:y("calculate_mortgage_first_ph"),value:t.program,onChange:C=>s(`mortgageData.${t.id-1}.program`,C),onBlur:()=>p(`mortgageData.${t.id-1}.program`),error:((o=(B=_.mortgageData)==null?void 0:B[t.id-1])==null?void 0:o.program)&&((k=(I=m.mortgageData)==null?void 0:I[t.id-1])==null?void 0:k.program)})}),e.jsx("div",{className:f("col","col-2"),children:e.jsx(oe,{placeholder:"10,000",value:t.balance,handleChange:C=>s(`mortgageData.${t.id-1}.balance`,C),onBlur:()=>p(`mortgageData.${t.id-1}.balance`),error:((R=(E=_.mortgageData)==null?void 0:E[t.id-1])==null?void 0:R.balance)&&((T=($=m.mortgageData)==null?void 0:$[t.id-1])==null?void 0:T.balance)})}),e.jsx("div",{className:f("col","col-3"),children:e.jsx(_e,{placeholder:y("date_ph"),value:t.endDate,allowFuture:!0,blockPastDates:!0,onChange:C=>s(`mortgageData.${t.id-1}.endDate`,C),onBlur:()=>p(`mortgageData.${t.id-1}.endDate`),error:((L=(V=_.mortgageData)==null?void 0:V[t.id-1])==null?void 0:L.endDate)&&((U=(z=m.mortgageData)==null?void 0:z[t.id-1])==null?void 0:U.endDate)})}),e.jsx("div",{className:f("col","col-4"),children:e.jsx(oe,{placeholder:"1",type:"numeric",value:t.bid,handleChange:C=>s(`mortgageData.${t.id-1}.bid`,C),onBlur:()=>p(`mortgageData.${t.id-1}.bid`),error:((Z=(W=_.mortgageData)==null?void 0:W[t.id-1])==null?void 0:Z.bid)&&((Y=(H=m.mortgageData)==null?void 0:H[t.id-1])==null?void 0:Y.bid),rightSection:e.jsx(ve,{color:"#FFF"})})}),e.jsx("div",{className:f("col","col-5"),children:t.id!==1&&e.jsx(De,{onClick:()=>u(t.id),className:f("delete")})})]},t.id)}),e.jsxs("div",{className:f("container"),children:[e.jsx("div",{className:f("col","col-1"),children:e.jsx(ee,{variant:"none",color:"#FBE54D",value:d("add_programm","add_programm"),onClick:j})}),e.jsx("div",{className:f("col","col-2")}),e.jsx("div",{className:f("col","col-3")}),e.jsx("div",{className:f("col","col-4")}),e.jsx("div",{className:f("col","col-5")})]})]})]}),q&&e.jsx("div",{className:f("mortgage-data-form"),children:e.jsx("div",{className:f("mortgage-data-form__items"),children:e.jsxs(b,{children:[a.map((t,B)=>{var o,I,k,E,R,$,T,V,L,z,U,W,Z,H,Y,C;return e.jsxs(F.Fragment,{children:[e.jsxs(l,{children:[e.jsx(G,{title:`${d("programm","programm")} #${t.id}`}),e.jsx(X,{data:S,placeholder:y("calculate_mortgage_first_ph"),value:t.program,onChange:M=>s(`mortgageData.${t.id-1}.program`,M),onBlur:()=>p(`mortgageData.${t.id-1}.program`),error:((I=(o=_.mortgageData)==null?void 0:o[t.id-1])==null?void 0:I.program)&&((E=(k=m.mortgageData)==null?void 0:k[t.id-1])==null?void 0:E.program)})]}),e.jsxs(l,{children:[e.jsx(G,{title:d("balance","balance")}),e.jsx(oe,{placeholder:"10,000",value:t.balance,handleChange:M=>s(`mortgageData.${t.id-1}.balance`,M),onBlur:()=>p(`mortgageData.${t.id-1}.balance`),error:(($=(R=_.mortgageData)==null?void 0:R[t.id-1])==null?void 0:$.balance)&&((V=(T=m.mortgageData)==null?void 0:T[t.id-1])==null?void 0:V.balance)})]}),e.jsx(l,{children:e.jsx(_e,{title:d("end_date","end_date"),placeholder:y("date_ph"),value:t.endDate,allowFuture:!0,blockPastDates:!0,onChange:M=>s(`mortgageData.${t.id-1}.endDate`,M),onBlur:()=>p(`mortgageData.${t.id-1}.endDate`),error:((z=(L=_.mortgageData)==null?void 0:L[t.id-1])==null?void 0:z.endDate)&&((W=(U=m.mortgageData)==null?void 0:U[t.id-1])==null?void 0:W.endDate)})}),e.jsxs(l,{children:[e.jsx(G,{title:d("bid","bid")}),e.jsx(oe,{placeholder:"1",value:t.bid,handleChange:M=>s(`mortgageData.${t.id-1}.bid`,M),onBlur:()=>p(`mortgageData.${t.id-1}.bid`),error:((H=(Z=_.mortgageData)==null?void 0:Z[t.id-1])==null?void 0:H.bid)&&((C=(Y=m.mortgageData)==null?void 0:Y[t.id-1])==null?void 0:C.bid),rightSection:e.jsx(ve,{color:"#FFF"})})]}),t.id!==1&&e.jsx(l,{children:e.jsxs("div",{className:f("delete-icon"),children:[e.jsx(De,{onClick:()=>u(t.id)}),y("delete")]})}),B!==a.length-1&&e.jsx(O,{})]},t.id)}),e.jsx(l,{children:e.jsx(ee,{variant:"none",color:"#FBE54D",value:d("add_programm","add_programm"),onClick:j})})]})})}),A&&e.jsx("div",{className:f("mortgage-data-form"),children:e.jsx("div",{className:f("mortgage-data-form__items"),children:e.jsxs(b,{children:[a.map((t,B)=>{var o,I,k,E,R,$,T,V,L,z,U,W,Z,H,Y,C;return e.jsxs(F.Fragment,{children:[e.jsxs(l,{children:[e.jsx(G,{title:`${d("programm","programm")} #${t.id}`}),e.jsx(X,{data:S,placeholder:y("calculate_mortgage_first_ph"),value:t.program,onChange:M=>s(`mortgageData.${t.id-1}.program`,M),onBlur:()=>p(`mortgageData.${t.id-1}.program`),error:((I=(o=_.mortgageData)==null?void 0:o[t.id-1])==null?void 0:I.program)&&((E=(k=m.mortgageData)==null?void 0:k[t.id-1])==null?void 0:E.program)})]}),e.jsxs(l,{children:[e.jsx(G,{title:d("balance","balance")}),e.jsx(oe,{placeholder:"10,000",value:t.balance,handleChange:M=>s(`mortgageData.${t.id-1}.balance`,M),onBlur:()=>p(`mortgageData.${t.id-1}.balance`),error:(($=(R=_.mortgageData)==null?void 0:R[t.id-1])==null?void 0:$.balance)&&((V=(T=m.mortgageData)==null?void 0:T[t.id-1])==null?void 0:V.balance)})]}),e.jsx(l,{children:e.jsx(_e,{title:d("end_date","end_date"),placeholder:y("date_ph"),value:t.endDate,allowFuture:!0,blockPastDates:!0,onChange:M=>s(`mortgageData.${t.id-1}.endDate`,M),onBlur:()=>p(`mortgageData.${t.id-1}.endDate`),error:((z=(L=_.mortgageData)==null?void 0:L[t.id-1])==null?void 0:z.endDate)&&((W=(U=m.mortgageData)==null?void 0:U[t.id-1])==null?void 0:W.endDate)})}),e.jsxs(l,{children:[e.jsx(G,{title:d("bid","bid")}),e.jsx(oe,{placeholder:"1",value:t.bid,handleChange:M=>s(`mortgageData.${t.id-1}.bid`,M),onBlur:()=>p(`mortgageData.${t.id-1}.bid`),error:((H=(Z=_.mortgageData)==null?void 0:Z[t.id-1])==null?void 0:H.bid)&&((C=(Y=m.mortgageData)==null?void 0:Y[t.id-1])==null?void 0:C.bid),rightSection:e.jsx(ve,{color:"#FFF"})})]}),t.id!==1&&e.jsx(l,{children:e.jsxs("div",{className:f("delete-icon"),children:[e.jsx(De,{onClick:()=>u(t.id)}),y("delete")]})}),B!==a.length-1&&e.jsx(O,{})]},t.id)}),e.jsx(l,{children:e.jsx(ee,{variant:"none",color:"#FBE54D",value:d("add_programm","add_programm"),onClick:j})})]})})})]}),e.jsx(fa,{text:y("remove_programm"),subtitle:y("remove_mortgage_program_subtitle"),isVisible:ce,onCancel:de,onSubmit:D})]})},Za=()=>{const{t:a,i18n:g}=J(),{getContent:r}=he("refinance_step1"),[i,c]=F.useState(51130),[s,m]=F.useState(2654),_=le(),p=v(h=>h.activeField),{data:ce,loading:te,error:de,getDropdownProps:P}=ua("refinance_step1"),q=P("why"),A=P("property_type"),y=P("registration"),K=P("bank"),{setFieldValue:d,values:j,errors:u,touched:D,setFieldTouched:S}=xe();return te&&console.log("ðŸ”„ Loading dropdown data for refinance_step1..."),ce&&!te&&console.log("âœ… Dropdown data loaded for refinance_step1:",{why:q.options.length,propertyType:A.options.length,registration:y.options.length,bank:K.options.length}),F.useLayoutEffect(()=>{(async()=>{try{const w=await pe.calculateMortgagePayment(j.mortgageBalance,0,4),t=await pe.calculateMortgagePayment(j.mortgageBalance,0,30);Number.isNaN(w)||c(w),w===0&&c(1),Number.isNaN(t)||m(t)}catch(w){console.error("âŒ Error calculating mortgage payment limits:",w),c(51130),m(2654)}})()},[j.mortgageBalance]),F.useEffect(()=>{(async()=>{try{if(p==="period"){const w=await pe.calculateMortgagePayment(j.mortgageBalance,0,j.period);Number.isNaN(w)||d("monthlyPayment",w)}else{const w=await pe.calculateLoanPeriod(j.mortgageBalance,0,j.monthlyPayment);Number.isNaN(w)||d("period",w)}}catch(w){console.error("âŒ Error calculating mortgage refinance values:",w)}})()},[p,d,j.monthlyPayment,j.mortgageBalance,j.period]),e.jsx(e.Fragment,{children:e.jsxs(ye,{children:[e.jsx(ge,{title:r("app.refinance.step1.title",a("app.refinance.step1.title"))}),e.jsxs(b,{children:[e.jsx(l,{children:e.jsx(X,{data:q.options,title:q.label||r("app.refinance.step1.why_label",a("app.refinance.step1.why_label")),placeholder:q.placeholder||a("mortgage_refinance_why_ph"),value:j.whyRefinancingMortgage,onChange:h=>d("whyRefinancingMortgage",h),onBlur:()=>S("whyRefinancingMortgage"),error:D.whyRefinancingMortgage&&u.whyRefinancingMortgage})}),e.jsxs(l,{children:[e.jsx(me,{name:"PriceOfEstate",title:r("app.refinance.step1.balance_label",a("app.refinance.step1.balance_label")),value:j.mortgageBalance,placeholder:"1,000,000",handleChange:h=>{_(we("period")),d("mortgageBalance",h)},onBlur:()=>S("mortgageBalance"),error:D.mortgageBalance&&u.mortgageBalance}),D.mortgageBalance&&u.mortgageBalance&&e.jsx(Q,{error:u.mortgageBalance})]}),e.jsxs(l,{children:[e.jsx(me,{handleChange:h=>d("priceOfEstate",h),name:"PriceOfEstate",title:r("app.refinance.step1.property_value_label",a("app.refinance.step1.property_value_label")),value:j.priceOfEstate,placeholder:"1,000,000",error:u.priceOfEstate}),u.priceOfEstate&&e.jsx(Q,{error:u.priceOfEstate})]})]}),e.jsxs(b,{children:[e.jsx(l,{children:e.jsx(X,{data:A.options,title:A.label||r("app.refinance.step1.property_type_label",a("app.refinance.step1.property_type_label")),placeholder:A.placeholder||a("mortgage_refinance_type_ph"),value:j.typeSelect,onChange:h=>d("typeSelect",h),onBlur:()=>S("typeSelect"),error:D.typeSelect&&u.typeSelect})}),e.jsx(l,{children:e.jsx(X,{data:K.options,title:K.label||r("app.refinance.step1.current_bank_label",a("app.refinance.step1.current_bank_label")),placeholder:K.placeholder||a("mortgage_refinance_bank_ph"),value:j.bank,onChange:h=>d("bank",h),onBlur:()=>S("bank"),error:D.bank&&u.bank})}),e.jsx(l,{children:e.jsx(X,{data:y.options,title:y.label||r("app.refinance.step1.registered_label",a("app.refinance.step1.registered_label")),placeholder:y.placeholder||a("mortgage_refinance_registered_ph"),value:j.propertyRegistered,onChange:h=>d("propertyRegistered",h),onBlur:()=>S("propertyRegistered"),error:D.propertyRegistered&&u.propertyRegistered})})]}),e.jsxs(b,{children:[e.jsxs(l,{children:[e.jsx(_e,{title:r("app.refinance.step1.start_date_label",a("app.refinance.step1.start_date_label")),placeholder:a("date_ph"),value:j.startDate,onChange:h=>d("startDate",h),onBlur:()=>S("startDate"),error:D.startDate&&u.startDate}),D.startDate&&u.startDate&&e.jsx(Q,{error:u.startDate})]}),j.whyRefinancingMortgage==="option_2"&&e.jsxs(l,{children:[e.jsx(me,{handleChange:h=>d("decreaseMortgage",h),name:"PriceOfEstate",title:a("mortgage_refinance_decrease"),value:j.decreaseMortgage,placeholder:"1,000,000",onBlur:()=>S("decreaseMortgage"),error:D.decreaseMortgage&&u.decreaseMortgage}),D.decreaseMortgage&&u.decreaseMortgage&&e.jsx(Q,{error:u.decreaseMortgage})]}),j.whyRefinancingMortgage==="option_5"&&e.jsxs(l,{children:[e.jsx(me,{handleChange:h=>d("increaseMortgage",h),name:"PriceOfEstate",title:a("mortgage_refinance_increase"),value:j.increaseMortgage,placeholder:"1,000,000",onBlur:()=>S("increaseMortgage"),error:D.increaseMortgage&&u.increaseMortgage}),D.increaseMortgage&&u.increaseMortgage&&e.jsx(Q,{error:u.increaseMortgage})]}),e.jsx(l,{})]}),e.jsx(O,{}),e.jsx(b,{children:e.jsx(Wa,{})}),e.jsx(O,{}),e.jsxs(b,{children:[e.jsxs(l,{children:[e.jsx(Ce,{disableCurrency:!0,unitsMax:a("calculate_mortgage_period_units_max"),unitsMin:a("calculate_mortgage_period_units_min"),value:j.period,name:"Period",min:4,max:30,error:u.period,title:a("calculate_mortgage_period"),handleChange:h=>{_(we("period")),d("period",h)}}),u.period&&e.jsx(Q,{error:u.period})]}),e.jsxs(l,{children:[e.jsx(Ce,{unitsMax:"â‚ª",unitsMin:"â‚ª",value:j.monthlyPayment,name:"monthlyPayment",min:s,max:i,error:u.monthlyPayment,title:a("calculate_mortgage_initial_payment"),handleChange:h=>{_(we("monthlyPayment")),d("monthlyPayment",h)},onBlur:()=>S("monthlyPayment")}),e.jsx(ha,{}),D.monthlyPayment&&u.monthlyPayment&&e.jsx(Q,{error:u.monthlyPayment})]}),e.jsx(l,{})]})]})})},Ha=F.memo(Za),Ya=()=>se().shape({whyRefinancingMortgage:x().required(n("error_refinance_why_required","Please specify why you want to refinance")),mortgageBalance:N().test("is-less",n("error_refinance_balance_greater_than_property","Mortgage balance cannot exceed property value"),function(a){const{priceOfEstate:g}=this.parent;return typeof a>"u"?!0:typeof g=="number"?a<=g:!0}).required(n("error_required_to_fill_out","This field is required")),priceOfEstate:N().test("is-greater",n("error_refinance_property_less_than_balance","Property value must be at least the mortgage balance"),function(a){const{mortgageBalance:g}=this.parent;return typeof a>"u"?!0:typeof g=="number"?a>=g:!0}).required(n("error_required_to_fill_out","This field is required")),typeSelect:x().required(n("error_refinance_type_required","Property type is required")),bank:x().required(n("error_refinance_bank_required","Current bank is required")),propertyRegistered:x().required(n("error_refinance_registered_required","Property registration status is required")),startDate:x().required(n("error_refinance_start_date_required","Mortgage start date is required")),period:N().min(4,n("error_min_period","Minimum period is 4 years")).max(30,n("error_max_period","Maximum period is 30 years")).required(n("error_required_to_fill_out","This field is required")),monthlyPayment:N().positive(n("error_mortgage_payment_positive","Monthly payment must be positive")).required(n("error_required_to_fill_out","This field is required")),decreaseMortgage:x().when("whyRefinancingMortgage",{is:"option_2",then:a=>a.required(n("error_required_to_fill_out","This field is required")),otherwise:a=>a.notRequired()}),increaseMortgage:x().when("whyRefinancingMortgage",{is:"option_5",then:a=>a.required(n("error_required_to_fill_out","This field is required")),otherwise:a=>a.notRequired()}),mortgageData:Se().of(se().shape({program:x().required(n("error_mortgage_program_required","Mortgage program is required")),balance:N().positive(n("error_mortgage_balance_positive","Balance must be positive")).required(n("error_mortgage_balance_required","Mortgage balance is required")),endDate:x().required(n("error_mortgage_end_date_required","End date is required")),bid:N().positive(n("error_mortgage_bid_positive","Bid must be positive")).required(n("error_mortgage_bid_required","Bid is required"))})).test("is-balance-sum-equal",n("error_refinance_mortgage_balance_mismatch","Total mortgage balance must match individual balances"),function(){return this.parent.mortgageData.reduce((g,r)=>g+(r.balance||0),0)===this.parent.mortgageBalance})}),Ga=()=>{const{t:a,i18n:g}=J(),r=le();re();const i=v(s=>s.refinanceMortgage);v(s=>s.login.isLogin);const c={whyRefinancingMortgage:i.whyRefinancingMortgage||"",mortgageBalance:i.mortgageBalance||2e5,priceOfEstate:i.priceOfEstate||1e6,typeSelect:i.typeSelect||"",bank:i.bank||"",startDate:i.startDate||"",propertyRegistered:i.propertyRegistered||"",period:i.period||4,monthlyPayment:i.monthlyPayment||4605,decreaseMortgage:i.decreaseMortgage||null,increaseMortgage:i.increaseMortgage||null,mortgageData:i.mortgageData||[{id:1,program:"",balance:null,endDate:"",bid:null}]};return e.jsxs(e.Fragment,{children:[e.jsx(je,{initialValues:c,validationSchema:Ya(),validateOnMount:!0,onSubmit:s=>{r(ae(s)),r(He()),r(Ee("phoneVerification"))},children:e.jsxs(be,{children:[e.jsxs(fe,{children:[e.jsx(ia,{title:a("sidebar_sub_refinance_mortgage"),text:a("refinance_mortgage_promo_text"),size:"small"}),e.jsx(Ha,{})]}),e.jsx(sa,{})]})}),e.jsx(la,{}),e.jsx(ze,{})]})},Ja=()=>{const{t:a,i18n:g}=J(),r=v(c=>c.login.loginData),i=v(c=>c.refinanceMortgage);return e.jsxs(ye,{children:[e.jsx(ge,{title:a("refinance_mortgage_final")}),e.jsx(ca,{cost:i==null?void 0:i.priceOfEstate,initialPayment:i==null?void 0:i.mortgageBalance,period:i==null?void 0:i.period,nameSurname:r==null?void 0:r.nameSurname,phoneNumber:r==null?void 0:r.phoneNumber}),e.jsx(Ae,{text:a("refinance_mortgage_warning")}),e.jsx(b,{children:e.jsx(da,{})}),e.jsx(ga,{})]})},Ka={selectedBank:"",selectedOffer:null},Qa=se().shape({selectedBank:x(),selectedOffer:se().nullable()}),Xa=()=>{const a=le(),g=re(),r=v(c=>c.login.loginData),i=v(c=>c.login.isLogin);return e.jsx(je,{initialValues:Ka,validationSchema:Qa,validateOnMount:!0,onSubmit:c=>{console.log("Saving refinance mortgage data and proceeding...",c),a(ae(c)),!i||!(r!=null&&r.phoneNumber)?(console.log("User not authenticated, opening auth modal"),a(Ye()),a(Ee("signUp"))):(console.log("User authenticated, proceeding to application"),g("/services/application-submitted"))},children:e.jsxs(be,{children:[e.jsx(fe,{children:e.jsx(Ja,{})}),e.jsx(Me,{})]})})},er=()=>{J();const{getContent:a}=he("refinance_step2"),{values:g}=xe(),r=v(m=>m.login.loginData),[i,c]=F.useState(null);F.useEffect(()=>{if(!(r!=null&&r.nameSurname)||!(r!=null&&r.phoneNumber)){const m=localStorage.getItem("USER_DATA");if(m)try{const _=JSON.parse(m);c({nameSurname:_.nameSurname||_.name_surname,phoneNumber:_.phoneNumber||_.mobile_number})}catch(_){console.error("Error parsing localStorage USER_DATA:",_)}}},[r]);const s=r!=null&&r.nameSurname?r:i;return console.log("ðŸ” SecondStepForm - userData from Redux:",r),console.log("ðŸ” SecondStepForm - fallbackUserData from localStorage:",i),console.log("ðŸ” SecondStepForm - displayUserData (final):",s),e.jsxs(ye,{children:[e.jsx(ge,{title:a("refinance_step2_title","calculate_mortgage_step2_title")}),e.jsxs(wa,{children:[e.jsx($a,{}),e.jsx(ie,{name:s==null?void 0:s.nameSurname,phone:s==null?void 0:s.phoneNumber})]}),e.jsxs(b,{children:[e.jsx(Ma,{}),e.jsx(Pa,{}),e.jsx(Ba,{screenLocation:"refinance_step2"})]}),e.jsxs(b,{children:[e.jsxs(l,{style:{gap:"2rem"},children:[e.jsx(qa,{}),g.additionalCitizenships==="yes"&&e.jsx(ka,{})]}),e.jsxs(l,{style:{gap:"2rem"},children:[e.jsx(Ia,{}),g.taxes==="yes"&&e.jsx(Ea,{})]}),e.jsxs(l,{style:{gap:"2rem"},children:[e.jsx(Ca,{}),g.childrens==="yes"&&e.jsx(Aa,{})]})]}),e.jsx(O,{}),e.jsxs(b,{children:[e.jsx(Fa,{}),e.jsx(Na,{}),e.jsx(Oa,{})]}),e.jsx(O,{}),e.jsxs(b,{children:[e.jsx(Da,{}),e.jsx(l,{}),e.jsx(l,{})]}),e.jsx(O,{}),e.jsxs(b,{children:[e.jsx(Ra,{}),e.jsx(l,{children:g.familyStatus==="option_2"&&e.jsx(va,{})}),e.jsx(l,{children:g.partnerPayMortgage==="yes"&&g.familyStatus==="option_2"&&e.jsx(Sa,{})})]})]})},ar=()=>se().shape({nameSurname:x().required(n("error_name_surname","Please enter your name and surname")),birthday:x().required(n("error_date","Please enter a valid date")),education:x().required(n("error_select_answer","Please select an answer")),additionalCitizenships:x().required(n("error_select_answer","Please select an answer")),citizenshipsDropdown:Se().when("additionalCitizenships",{is:"yes",then:a=>a.min(1,n("error_select_answer","Please select an answer")),otherwise:a=>a.min(0)}),taxes:x().required(n("error_select_answer","Please select an answer")),countriesPayTaxes:Se().when("taxes",{is:"yes",then:a=>a.min(1,n("error_select_answer","Please select an answer")),otherwise:a=>a.min(0)}),childrens:x().required(n("error_select_answer","Please select an answer")),howMuchChildrens:N().required(n("error_fill_field","Please fill this field")),medicalInsurance:x().required(n("error_select_answer","Please select an answer")),isForeigner:x().required(n("error_select_answer","Please select an answer")),publicPerson:x().required(n("error_select_answer","Please select an answer")),borrowers:N().min(1,n("error_quantity_borrowers","Please specify number of borrowers")).required(n("error_quantity_borrowers","Please specify number of borrowers")),familyStatus:x().required(n("error_select_answer","Please select an answer")),partnerPayMortgage:x().when("familyStatus",{is:"option_2",then:a=>a.required(n("error_select_answer","Please select an answer")),otherwise:a=>a.notRequired()})}),rr=ar(),tr=()=>{const a=le(),g=re(),r=v(s=>s.refinanceMortgage),c={nameSurname:v(s=>s.login.loginData).nameSurname||r.nameSurname||"",birthday:r.birthday||new Date(new Date().setFullYear(new Date().getFullYear()-18)).getTime(),education:r.education||"",additionalCitizenships:r.additionalCitizenships||null,citizenshipsDropdown:r.citizenshipsDropdown||[],taxes:r.taxes||null,countriesPayTaxes:r.countriesPayTaxes||[],childrens:r.childrens||null,howMuchChildrens:r.howMuchChildrens||1,medicalInsurance:r.medicalInsurance||null,isForeigner:r.isForeigner||null,publicPerson:r.publicPerson||null,borrowers:r.borrowers||null,familyStatus:r.familyStatus||"",partnerPayMortgage:r.partnerPayMortgage||null,addPartner:r.addPartner||""};return e.jsx(je,{initialValues:c,validationSchema:rr,validateOnMount:!0,onSubmit:s=>{a(ae(s)),g("/services/refinance-mortgage/3")},children:e.jsxs(be,{children:[e.jsx(fe,{children:e.jsx(er,{})}),e.jsx(Me,{})]})})},or=()=>{const{t:a,i18n:g}=J(),{getContent:r}=he("refinance_step3"),i=re(),{values:c}=xe(),{mainSourceOfIncome:s,additionalIncome:m,obligation:_}=c,p=le(),ce=v(o=>o.borrowers.sourceOfIncomeModal),te=v(o=>o.borrowers.additionalIncomeModal),de=v(o=>o.borrowers.obligationModal),P=v(o=>o.otherBorrowers.otherBorrowers),q=v(o=>o.login.loginData),A=()=>{p(ae(c)),p(Ge())},y=()=>{p(ae(c)),p(Je())},K=()=>{p(ae(c)),p(Ke())},d=o=>{p(Qe({id:o}))},j=o=>{p(Xe({id:o}))},u=o=>{p(ea({id:o}))},D=o=>{p(aa(o))},S=o=>{p(ra(o))},h=o=>{p(ta(o))},w=o=>{p(Ie(o));const k=!P.some(E=>E.id===o)?ue(P):o;i({pathname:"/services/other-borrowers/1/",search:Be({pageId:String(k)}).toString()})},t=()=>{p(Ie(ue(P))),i({pathname:"/services/other-borrowers/1/",search:Be({pageId:ue(P).toString()}).toString()})},B=o=>{p(oa(o))};return e.jsxs(ye,{children:[e.jsx(ge,{title:r("refinance_step3_title","calculate_mortgage_step3_title")}),e.jsx(ie,{name:q==null?void 0:q.nameSurname,phone:q==null?void 0:q.phoneNumber}),e.jsxs(b,{children:[e.jsx(xa,{}),Ne[s]&&Ne[s].map((o,I)=>e.jsx(Pe.Fragment,{children:o},I))]}),e.jsx(b,{children:e.jsx(l,{children:s&&e.jsxs(e.Fragment,{children:[ce.map(o=>e.jsx(ie,{onEdit:()=>D(o.id),onDelete:()=>d(o.id),enableEdit:!0,name:`${r("source_of_income_label","Source of Income")} ${o.id+1}`},o.id)),e.jsx(ee,{onClick:A,color:"#FBE54D",value:r("add_place_to_work_button","Add Place to Work"),variant:"none"})]})})}),e.jsx(O,{}),e.jsxs(b,{children:[e.jsx(ja,{}),m&&m!=="no_additional_income"&&e.jsx(ba,{}),e.jsx(l,{})]}),m&&m!=="no_additional_income"&&e.jsx(b,{children:e.jsxs(l,{children:[te.map(o=>e.jsx(ie,{onEdit:()=>S(o.id),onDelete:()=>j(o.id),enableEdit:!0,name:`${r("additional_source_of_income_label","Additional Source of Income")} ${o.id+1}`},o.id)),e.jsx(ee,{onClick:y,color:"#FBE54D",value:r("add_additional_source_of_income_button","Add Additional Source of Income"),variant:"none"})]})}),e.jsx(O,{}),e.jsxs(b,{children:[e.jsx(ya,{}),Oe[_]&&Oe[_].map((o,I)=>e.jsx(Pe.Fragment,{children:o},I)),e.jsx(l,{})]}),_&&_!=="no_obligations"&&e.jsx(b,{children:e.jsxs(l,{children:[de.map(o=>e.jsx(ie,{onEdit:()=>h(o.id),onDelete:()=>u(o.id),enableEdit:!0,name:`${r("obligation_label","Obligation")} ${o.id+1}`},o.id)),e.jsx(ee,{onClick:K,color:"#FBE54D",value:r("add_obligation_button","Add Obligation"),variant:"none"})]})}),e.jsx(O,{}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[P&&e.jsx(G,{title:a("borrower")}),e.jsxs(b,{style:{columnGap:"2rem"},children:[P.map(o=>e.jsx(l,{children:e.jsx(ie,{onEdit:()=>w(o.id),onDelete:()=>B(o.id),enableEdit:!0,name:o.nameSurname},o.id)},o.id)),!P&&e.jsx(G,{title:a("borrower")}),e.jsx(l,{children:e.jsx(ee,{value:a("add_borrower"),onClick:t,style:{height:"3.5rem",borderRadius:"0.25rem",padding:"0",width:"13.125rem"}})}),e.jsx(l,{})]})]})]})},Re=()=>se().shape({mainSourceOfIncome:x().required(n("error_select_answer","Please select an answer")).test("not-empty",n("error_select_answer","Please select an answer"),a=>a!=null&&a!==""),monthlyIncome:N().when("mainSourceOfIncome",{is:a=>!["app.mortgage.step3.main_source_income_option_5","app.mortgage.step3.main_source_income_option_6"].includes(a),then:a=>a.required(n("error_fill_field","Please fill this field")),otherwise:a=>a.notRequired()}),startDate:x().when("mainSourceOfIncome",{is:a=>!["app.mortgage.step3.main_source_income_option_5","app.mortgage.step3.main_source_income_option_6"].includes(a),then:a=>a.required(n("error_date","Please enter a valid date")),otherwise:a=>a.notRequired()}),fieldOfActivity:x().when("mainSourceOfIncome",{is:a=>a!=null&&a!==""&&!["app.mortgage.step3.main_source_income_option_5","app.mortgage.step3.main_source_income_option_6"].includes(a),then:a=>a.required(n("error_select_field_of_activity","Please select field of activity")),otherwise:a=>a.notRequired()}),profession:x().when("mainSourceOfIncome",{is:a=>!["app.mortgage.step3.main_source_income_option_5","app.mortgage.step3.main_source_income_option_6"].includes(a),then:a=>a.required(n("error_fill_field","Please fill this field")),otherwise:a=>a.notRequired()}),companyName:x().when("mainSourceOfIncome",{is:a=>!["app.mortgage.step3.main_source_income_option_5","app.mortgage.step3.main_source_income_option_6"].includes(a),then:a=>a.required(n("error_fill_field","Please fill this field")),otherwise:a=>a.notRequired()}),additionalIncome:x().required(n("error_select_one_of_the_options","Please select one of the options")),additionalIncomeAmount:N().when("additionalIncome",{is:a=>a!=null&&a!==""&&a!=="no_additional_income",then:a=>a.required(n("error_fill_field","Please fill this field")),otherwise:a=>a.notRequired()}),obligation:x().required(n("error_select_one_of_the_options","Please select one of the options")),bank:x().when("obligation",{is:a=>a!=null&&a!==""&&a!=="no_obligations",then:a=>a.required(n("error_select_bank","Please select a bank")),otherwise:a=>a.notRequired()}),monthlyPaymentForAnotherBank:N().when("obligation",{is:a=>a!=null&&a!==""&&a!=="no_obligations",then:a=>a.required(n("error_fill_field","Please fill this field")),otherwise:a=>a.notRequired()}),endDate:x().when("obligation",{is:a=>a!=null&&a!==""&&a!=="no_obligations",then:a=>a.required(n("error_date","Please enter a valid date")),otherwise:a=>a.notRequired()})});Re();const nr=()=>{const a=le(),g=re(),r=v(c=>c.refinanceMortgage),i={mainSourceOfIncome:r.mainSourceOfIncome||"",monthlyIncome:r.monthlyIncome||null,startDate:r.startDate||new Date().getTime(),fieldOfActivity:r.fieldOfActivity||"",profession:r.profession||"",companyName:r.companyName||"",additionalIncome:r.additionalIncome||"",additionalIncomeAmount:r.additionalIncomeAmount||null,obligation:r.obligation||"option_1",bank:r.bank||"",monthlyPaymentForAnotherBank:r.monthlyPaymentForAnotherBank||null,endDate:r.endDate||new Date().getTime(),amountIncomeCurrentYear:(r==null?void 0:r.amountIncomeCurrentYear)||null,noIncome:r.noIncome||new Date().getTime()};return e.jsxs(e.Fragment,{children:[e.jsx(je,{initialValues:i,validationSchema:Re(),validateOnMount:!0,onSubmit:c=>{a(ae(c)),g("/services/refinance-mortgage/4")},children:e.jsxs(be,{children:[e.jsx(fe,{children:e.jsx(or,{})}),e.jsx(Me,{})]})}),e.jsx(ma,{}),e.jsx(pa,{}),e.jsx(_a,{})]})},ir=a=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",...a,children:e.jsx("path",{fill:"#FBE54D",d:"M21 9.75a.75.75 0 1 1-1.5 0V5.561l-6.218 6.22a.75.75 0 1 1-1.062-1.062L18.44 4.5H14.25a.75.75 0 1 1 0-1.5h6a.75.75 0 0 1 .75.75v6ZM17.25 12a.75.75 0 0 0-.75.75v6.75h-12v-12h6.75a.75.75 0 1 0 0-1.5H4.5A1.5 1.5 0 0 0 3 7.5v12A1.5 1.5 0 0 0 4.5 21h12a1.5 1.5 0 0 0 1.5-1.5v-6.75a.75.75 0 0 0-.75-.75Z"})}),sr=a=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",...a,children:e.jsx("path",{fill:"#fff",d:"M21.788 10.734 8.28 2.47a1.5 1.5 0 0 0-2.075.516A1.487 1.487 0 0 0 6 3.738v16.525a1.494 1.494 0 0 0 1.5 1.487c.277 0 .548-.076.784-.22l13.504-8.263a1.481 1.481 0 0 0 0-2.531v-.002ZM7.5 20.244V3.75L20.984 12 7.5 20.245Z"})}),lr=a=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:33,height:32,fill:"none",...a,children:e.jsx("path",{fill:"#fff",d:"M28.5 19v7a2 2 0 0 1-2 2h-20a2 2 0 0 1-2-2v-7a1 1 0 1 1 2 0v7h20v-7a1 1 0 0 1 2 0Zm-16.293-8.293L15.5 7.414V19a1 1 0 0 0 2 0V7.414l3.293 3.293a1 1 0 1 0 1.415-1.415l-5-5a1 1 0 0 0-1.415 0l-5 5a1 1 0 0 0 1.415 1.415Z"})}),cr={"upload-buttons":"_upload-buttons_3j3y8_1","upload-report-file":"_upload-report-file_3j3y8_6","upload-report-file__wrapper":"_upload-report-file__wrapper_3j3y8_22","upload-report-file__text":"_upload-report-file__text_3j3y8_28","submit-buttons":"_submit-buttons_3j3y8_34","submit-buttons__wrapper":"_submit-buttons__wrapper_3j3y8_44"},ne=ke.bind(cr),dr=()=>{const{t:a,i18n:g}=J(),r=re();return e.jsx("div",{className:"step1",children:e.jsxs("div",{className:"home step1-container noborder",children:[e.jsx(ge,{title:a("upload_report_title"),subtitle:a("upload_report_subtitle")}),e.jsxs("div",{className:ne("upload-buttons"),children:[e.jsx(Fe,{text:a("video_instruction"),leftSection:e.jsx(sr,{})}),e.jsx(Fe,{text:a("download_report_here"),rightSection:e.jsx(ir,{}),onClick:()=>window.open("https://www.creditdata.org.il/","_blank")})]}),e.jsx(O,{}),e.jsx(Ta,{onDrop:i=>console.log(i),children:({getRootProps:i,getInputProps:c})=>e.jsx("section",{className:ne("upload-report-file"),children:e.jsxs("div",{...i(),className:ne("upload-report-file__wrapper"),children:[e.jsx("input",{...c()}),e.jsx(lr,{}),e.jsxs("p",{className:ne("upload-report-file__text"),children:[a("dropzone_upload_report"),e.jsx("span",{style:{color:"#FBE54D"},children:a("dropzone_comp_upload_report")})]})]})})}),e.jsx("div",{className:ne("submit-buttons"),children:e.jsxs("div",{className:ne("submit-buttons__wrapper"),children:[e.jsx(Ue,{title:a("button_back"),handleClick:()=>r("/services/refinance-mortgage/1")}),e.jsx(We,{onClick:()=>r("/services/refinance-mortgage/1"),children:a("button_next_save")})]})})]})})},gr=()=>{const{stepNumber:a}=$e(),{t:g,i18n:r}=J(),i=re();if(!v(p=>p.login.isLogin)&&a!=="1"){i("/services/refinance-mortgage/1");return}const s=[g("mobile_step_1"),g("mobile_step_2"),g("mobile_step_3"),g("mobile_step_4")];let m;switch(a){case"1":m=e.jsx(Ga,{});break;case"2":m=e.jsx(tr,{});break;case"3":m=e.jsx(nr,{});break;case"4":m=e.jsx(Xa,{});break;case"upload-report":m=e.jsx(dr,{});break;default:m=e.jsx(na,{type:"NOT_FOUND"});break}const _=a==="upload-report"?"1":a;return e.jsxs(e.Fragment,{children:[a!=="upload-report"&&e.jsx(qe,{progress:_,data:s}),a==="upload-report"&&e.jsx(qe,{progress:"1",data:[g("upload_report_progress"),g("mobile_step_2"),g("mobile_step_3")]}),e.jsx(F.Suspense,{fallback:e.jsx(Ze,{}),children:m})]})},Yr=gr;export{Yr as RefinanceMortgage};
