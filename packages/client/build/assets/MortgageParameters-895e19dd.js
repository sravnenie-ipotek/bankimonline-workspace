import{j as e}from"./ui-vendor-5a9cd79c.js";import{c as y}from"./index-82c03faf.js";import{a as S,M as R,k as M,c as C,I as F}from"./index-44d8657f.js";import{i as f,u}from"./i18n-vendor-5cfd36a0.js";import{P as O}from"./PercentIcon-69cb9491.js";import{r as E,u as I,f as B}from"./react-vendor-19e41fc0.js";import{C as k}from"./Column-966fba25.js";const L=t=>{const c=t%10,o=t%100;return c===1&&o!==11?f.t("year_singular"):[2,3,4].includes(c)&&![12,13,14].includes(o)?f.t("year_dual"):f.t("year_plural")},U=t=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none",...t,children:e.jsx("path",{fill:"#FBE54D",d:"M16.25 2.5h-1.875v-.625a.625.625 0 1 0-1.25 0V2.5h-6.25v-.625a.625.625 0 0 0-1.25 0V2.5H3.75A1.25 1.25 0 0 0 2.5 3.75v12.5a1.25 1.25 0 0 0 1.25 1.25h12.5a1.25 1.25 0 0 0 1.25-1.25V3.75a1.25 1.25 0 0 0-1.25-1.25ZM5.625 3.75v.625a.625.625 0 0 0 1.25 0V3.75h6.25v.625a.625.625 0 1 0 1.25 0V3.75h1.875v2.5H3.75v-2.5h1.875Zm10.625 12.5H3.75V7.5h12.5v8.75Z"})}),$="_modal_11yd4_1",G="_ellipse_11yd4_74",V={modal:$,"modal-header":"_modal-header_11yd4_11","modal-header__title":"_modal-header__title_11yd4_16","modal-content__text":"_modal-content__text_11yd4_27","modal-content__row":"_modal-content__row_11yd4_35","modal-content__title":"_modal-content__title_11yd4_48","modal-content__condition":"_modal-content__condition_11yd4_65",ellipse:G},a=y.bind(V),Z=({isVisible:t,onClose:c,title:o,description:l,conditionFinance:i,conditionPeriod:h,conditionBid:r})=>{const{t:d,i18n:p}=u(),{getContent:x}=S("bank_offers"),[_,g]=E.useState("description"),m=[{value:"description",label:x("description","description")},{value:"condition",label:x("condition","condition")}],v=N=>{g(N)};return e.jsx(R,{isVisible:t,onCancel:c,children:e.jsxs("div",{className:a("modal"),children:[e.jsxs("div",{className:a("modal-header"),children:[e.jsx("div",{className:a("modal-header__title"),children:o}),e.jsx(M,{handleChange:v,tabs:m,tab:_})]}),e.jsxs("div",{children:[_==="description"&&e.jsx("div",{className:a("modal-content"),children:e.jsx("p",{className:a("modal-content__text"),children:l})}),_==="condition"&&e.jsxs("div",{className:a("modal-content"),children:[e.jsxs("div",{className:a("modal-content__row"),children:[e.jsx("p",{className:a("modal-content__condition"),children:d("calculate_mortgage_parameters_initial")}),e.jsxs("div",{className:a("modal-content__title"),children:[e.jsx("span",{className:a("ellipse")}),e.jsx("p",{children:i})]})]}),e.jsxs("div",{className:a("modal-content__row"),children:[e.jsx("p",{className:a("modal-content__condition"),children:d("mortgage_term")}),e.jsxs("div",{className:a("modal-content__title"),children:[e.jsx("span",{className:a("ellipse")}),e.jsx("p",{children:h})]})]}),e.jsxs("div",{className:a("modal-content__row"),children:[e.jsx("p",{className:a("modal-content__condition"),children:d("bid")}),e.jsx("p",{className:a("modal-content__title"),children:r})]})]})]})]})})},H="_card_ixwh9_1",Y="_wrapper_ixwh9_83",K={card:H,"card-title":"_card-title_ixwh9_9","card-title__ellipse":"_card-title__ellipse_ixwh9_14","card-title__text":"_card-title__text_ixwh9_20","card-title__info":"_card-title__info_ixwh9_27","card-content":"_card-content_ixwh9_30","card-content__desc":"_card-content__desc_ixwh9_35","card-content__price":"_card-content__price_ixwh9_42","card-desc":"_card-desc_ixwh9_53","card-desc__content":"_card-desc__content_ixwh9_64","card-desc__content-desc":"_card-desc__content-desc_ixwh9_69","card-desc__content-title":"_card-desc__content-title_ixwh9_76",wrapper:Y},n=y.bind(K),ne=({title:t,mortgageAmount:c,monthlyPayment:o,percent:l,period:i,description:h,conditionFinance:r,conditionPeriod:d,conditionBid:p})=>{const{t:x,i18n:_}=u(),g=c.toLocaleString("en-US"),m=o.toLocaleString("en-US"),[v,{open:N,close:j}]=C();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:n("card"),children:[e.jsxs("div",{className:n("card-title"),children:[e.jsx("span",{className:n("card-title__ellipse")}),e.jsx("p",{className:n("card-title__text"),children:t}),e.jsx(F,{className:n("card-title__info"),onClick:N,size:20})]}),e.jsxs("div",{className:n("wrapper"),children:[e.jsxs("div",{className:n("card-content"),children:[e.jsx("p",{className:n("card-content__desc"),children:x("mortgage_total")}),e.jsxs("p",{className:n("card-content__price"),children:[g," ₪"]})]}),e.jsxs("div",{className:n("card-content"),children:[e.jsx("p",{className:n("card-content__desc"),children:x("mortgage_monthly")}),e.jsxs("p",{className:n("card-content__price"),children:[m," ₪"]})]})]}),e.jsxs("div",{className:n("wrapper"),children:[e.jsxs("div",{className:n("card-desc"),children:[e.jsx(O,{}),e.jsxs("div",{className:n("card-desc__content"),children:[e.jsx("p",{className:n("card-desc__content-desc"),children:x("mortgage_percnt")}),e.jsxs("p",{className:n("card-desc__content-title"),children:[Number(l).toFixed(2),"%"]})]})]}),e.jsxs("div",{className:n("card-desc"),children:[e.jsx(U,{}),e.jsxs("div",{className:n("card-desc__content"),children:[e.jsx("p",{className:n("card-desc__content-desc"),children:x("mortgage_term")}),e.jsxs("p",{className:n("card-desc__content-title"),children:[i," ",L(i)]})]})]})]})]}),e.jsx(Z,{isVisible:v,onClose:j,title:t,description:h,conditionFinance:r,conditionPeriod:d,conditionBid:p})]})},z=()=>{const t=I();return t.pathname.includes("/calculate-mortgage")?"mortgage":t.pathname.includes("/calculate-credit")?"credit":t.pathname.includes("/refinance-mortgage")?"refinance-mortgage":t.pathname.includes("/refinance-credit")?"refinance-credit":null},T=()=>"https://bankimonline.com/api",ie=async t=>{var r;const c=T(),o=f.language||"en",l=o==="he"?"he-IL":o==="ru"?"ru-RU":"en-US";console.log("🚀 [BANK-API] Making bank offers request:",t),console.log("🌍 [BANK-API] Using language:",o,"→",l);const i=await fetch(`${c}/customer/compare-banks`,{method:"POST",headers:{"Content-Type":"application/json","Accept-Language":l},body:JSON.stringify(t)});if(console.log("📡 [BANK-API] Response status:",i.status),!i.ok){const d=await i.text();throw console.error("❌ [BANK-API] Error:",i.status,d),new Error(`API Error: ${i.status} - ${d}`)}const h=await i.json();return console.log("📦 [BANK-API] Response data:",h),((r=h.data)==null?void 0:r.bank_offers)||[]},se=async()=>{var t;try{const c=T(),o=f.language||"en",l=o==="he"?"he-IL":o==="ru"?"ru-RU":"en-US",i=await fetch(`${c}/customer/mortgage-programs`,{method:"GET",headers:{"Content-Type":"application/json","Accept-Language":l}});if(i.ok){const h=await i.json();return console.log("📋 [MORTGAGE-PROGRAMS-API] Fetched programs:",h),((t=h.data)==null?void 0:t.programs)||[]}else throw console.warn("⚠️ [MORTGAGE-PROGRAMS-API] Failed to fetch programs"),new Error(`Failed to fetch programs: ${i.status}`)}catch(c){throw console.error("❌ [MORTGAGE-PROGRAMS-API] Error:",c),c}},le=(t,c,o,l,i,h)=>{const r=l==="credit",d=i||`sess_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;console.log("🔍 [TRANSFORM-DATA] Service Type:",l,"Is Credit:",r),console.log("🔍 [TRANSFORM-DATA] Parameters:",t),console.log("🔍 [TRANSFORM-DATA] User Personal Data:",c),console.log("🔍 [TRANSFORM-DATA] User Income Data:",o);let p;if(c!=null&&c.birthday){const v=new Date(c.birthday);if(!isNaN(v.getTime())){const N=new Date;p=N.getFullYear()-v.getFullYear();const j=N.getMonth()-v.getMonth();(j<0||j===0&&N.getDate()<v.getDate())&&p--,(p<18||p>100)&&(p=void 0)}}const x=(c==null?void 0:c.monthlyIncome)||(o==null?void 0:o.monthlyIncome)||(t==null?void 0:t.monthlyIncome)||0;console.log("💰 [TRANSFORM-DATA] Monthly Income Sources:"),console.log("   userPersonalData.monthlyIncome:",c==null?void 0:c.monthlyIncome),console.log("   userIncomeData.monthlyIncome:",o==null?void 0:o.monthlyIncome),console.log("   parameters.monthlyIncome:",t==null?void 0:t.monthlyIncome),console.log("   Final monthlyIncome:",x);let _=0,g=0;r?(_=t.loanAmount||0,g=0):l==="refinance-mortgage"?(_=t.mortgageBalance||0,g=t.priceOfEstate||0):(_=t.priceOfEstate&&t.initialFee?t.priceOfEstate-t.initialFee:t.priceOfEstate*.5,g=t.priceOfEstate||0),console.log("🏠 [TRANSFORM-DATA] Amount Calculation:"),console.log("   Service Type:",l),console.log("   Is Credit:",r),console.log("   parameters.mortgageBalance:",t==null?void 0:t.mortgageBalance),console.log("   parameters.priceOfEstate:",t==null?void 0:t.priceOfEstate),console.log("   parameters.loanAmount:",t==null?void 0:t.loanAmount),console.log("   parameters.initialFee:",t==null?void 0:t.initialFee),console.log("   Final amount:",_),console.log("   Final property_value:",g);const m={loan_type:r?"credit":"mortgage",amount:_,property_value:g,monthly_income:x,birth_date:c==null?void 0:c.birthday,employment_start_date:o==null?void 0:o.startDate,age:p||35,employment_years:(o==null?void 0:o.employmentYears)||0,property_ownership:t.propertyOwnership||"no_property",session_id:d,client_id:h,education:c==null?void 0:c.education,citizenship:c==null?void 0:c.citizenship,marital_status:c==null?void 0:c.familyStatus,children_count:(c==null?void 0:c.childrens)==="yes"?(c==null?void 0:c.childrenCount)||1:0,property_city:t==null?void 0:t.cityWhereYouBuy,property_type:r||t==null?void 0:t.typeSelect,is_first_apartment:r?!1:(t==null?void 0:t.willBeYourFirst)==="1",has_medical_insurance:(c==null?void 0:c.medicalInsurance)==="yes",is_foreigner:(c==null?void 0:c.isForeigner)==="yes",is_public_figure:(c==null?void 0:c.publicPerson)==="yes"};return console.log("🚀 [TRANSFORM-DATA] Final Request Payload:",m),console.log("🚀 [TRANSFORM-DATA] Critical Fields Check:"),console.log("   loan_type:",m.loan_type,"(should not be empty)"),console.log("   amount:",m.amount,"(should be > 0)"),console.log("   monthly_income:",m.monthly_income,"(should be > 0)"),console.log("   age:",m.age,"(should be > 0)"),console.log("   property_ownership:",m.property_ownership,"(should not be empty)"),m},q=t=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",...t,children:e.jsx("path",{fill:"#FBE54D",d:"M3.75 8.25h3.094a3 3 0 0 0 5.812 0h7.594a.75.75 0 1 0 0-1.5h-7.594a3 3 0 0 0-5.812 0H3.75a.75.75 0 0 0 0 1.5Zm6-2.25a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Zm10.5 9.75h-1.594a3 3 0 0 0-5.812 0H3.75a.75.75 0 1 0 0 1.5h9.094a3 3 0 0 0 5.812 0h1.594a.75.75 0 1 0 0-1.5ZM15.75 18a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3Z"})}),W="_parameters_1op4u_1",J="_wrapper_1op4u_49",Q={parameters:W,"parameters-title":"_parameters-title_1op4u_11","parameters-title__text":"_parameters-title__text_1op4u_16","parameters-title__icon":"_parameters-title__icon_1op4u_22","parameters-data":"_parameters-data_1op4u_29","parameters-data__title":"_parameters-data__title_1op4u_35","parameters-data__desc":"_parameters-data__desc_1op4u_41",wrapper:J},s=y.bind(Q),ae=({cost:t,initialPayment:c,period:o,credit:l,onEditClick:i})=>{const{t:h,i18n:r}=u(),{getContent:d}=S("mortgage_step4"),p=B(),_=z()==="credit",g=t!=null?Number(t):void 0,m=c!=null?Number(c):void 0,v=l!=null?Number(l):void 0,N=o!=null?Number(o):void 0,j=g!==void 0?g.toLocaleString("en-US"):void 0,A=m!==void 0?m.toLocaleString("en-US"):void 0,w=v!==void 0?v.toLocaleString("en-US"):void 0,b=N!==void 0?N*12:void 0;return e.jsx(k,{children:e.jsxs("div",{className:s("parameters"),children:[e.jsxs("div",{className:s("parameters-title"),children:[e.jsx("p",{className:s("parameters-title__text"),children:d("calculate_mortgage_parameters","calculate_mortgage_parameters")}),e.jsx(q,{onClick:i||(()=>p("/services/calculate-mortgage/1")),className:s("parameters-title__icon")})]}),e.jsxs("div",{className:s("wrapper"),children:[w&&e.jsxs("div",{className:s("parameters-data"),children:[e.jsxs("div",{className:s("parameters-data__title"),children:[w," ₪"]}),e.jsx("div",{className:s("parameters-data__desc"),children:h("sum_credit")})]}),j&&e.jsxs("div",{className:s("parameters-data"),children:[e.jsxs("div",{className:s("parameters-data__title"),children:[j," ₪"]}),e.jsx("div",{className:s("parameters-data__desc"),children:d(_?"calculate_credit_parameters_cost":"calculate_mortgage_parameters_cost",_?"calculate_credit_parameters_cost":"calculate_mortgage_parameters_cost")})]}),A&&e.jsxs("div",{className:s("parameters-data"),children:[e.jsxs("div",{className:s("parameters-data__title"),children:[A," ₪"]}),e.jsx("div",{className:s("parameters-data__desc"),children:d("calculate_mortgage_parameters_initial","calculate_mortgage_parameters_initial")})]})]}),b&&e.jsx("div",{className:s("wrapper"),children:e.jsxs("div",{className:s("parameters-data"),children:[e.jsxs("div",{className:s("parameters-data__title"),children:[b," ",d("calculate_mortgage_parameters_months","calculate_mortgage_parameters_months")]}),e.jsx("div",{className:s("parameters-data__desc"),children:d(_?"calculate_credit_parameters_period":"calculate_mortgage_parameters_period",_?"calculate_credit_parameters_period":"calculate_mortgage_parameters_period")})]})})]})})};export{Z as B,ae as M,ne as P,se as a,ie as f,le as t,z as u};
