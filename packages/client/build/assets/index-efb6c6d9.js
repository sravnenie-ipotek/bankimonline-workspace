import{j as e}from"./ui-vendor-5a9cd79c.js";import{r as N,f as re,b as qe,j as Ce,k as Ve}from"./react-vendor-19e41fc0.js";import{c as ze,u as Ue,a as fe,W as We,T as G,D as O,E as Q,b as xe,A as Ze,d as He,B as Ye,L as Ge}from"./index-79a992ab.js";import{P as Ie}from"./ProgressBar-cdf00f46.js";import{c as Re,a as le,u as v,k as De,E as ae,m as Je,d as $e,n as s,o as Ke,p as Qe,q as Xe,r as ea,t as aa,v as ra,w as ta,x as oa,y as na,z as sa,A as Ne,B as ia,N as la}from"./index-b94574b0.js";import{u as je,F as be,b as ye,a as ie,c as j,f as F,g as Pe,h as Fe}from"./form-vendor-3025b96d.js";import{V as ca}from"./VideoPoster-5b3015ab.js";import{A as Te,S as Oe,a as da,M as ga,U as ma,F as pa,B as ua,b as _a,c as ha,O as fa}from"./SourceOfIncomeModal-d513574b.js";import{u as xa}from"./useDropdownData-1abe74c0.js";import{C as c}from"./Column-dbe9e532.js";import{D as X}from"./DropdownMenu-7fc78a92.js";import{F as we}from"./FormContainer-1e1ce440.js";import{F as pe}from"./FormattedInput-eaa8803d.js";import{R as b}from"./Row-5f51608f.js";import{C as _e}from"./Calendar-2fe91664.js";import{I as ja,c as ue}from"./IncreasePayment-3ce5141f.js";import{F as me}from"./FormCaption-0679f06d.js";import{D as ve}from"./DeleteIcon-b228fd68.js";import{P as Se}from"./PercentIcon-69cb9491.js";import{A as ee,U as se}from"./AddButton-c667a975.js";import{E as ba,N as ke}from"./ExitModule-2ddb570e.js";import{C as oe}from"./Control-ef834aa1.js";import{g as he,M as ya,c as Ee,A as wa,a as Da,O as va,b as Ae}from"./componentsByIncomeSource-932eb4c7.js";import{u as J}from"./i18n-vendor-5cfd36a0.js";import{D as Be}from"./DoubleButtons-6b72a4fb.js";import{R as Sa}from"./RowTwo-ac499c1a.js";import{B as Ma,P as Pa,A as Ba}from"./PartnerPayMortgage-fc7807d2.js";import{N as qa,B as Ca,E as Ia,A as Na,T as Fa,C as Oa,M as ka,I as Ea,P as Aa}from"./Taxes-fa5418b8.js";import{C as Ra,a as $a,H as Ta}from"./HowMuchChildrens-60335f65.js";import{F as La}from"./FamilyStatus-23eff92e.js";import{I as Va}from"./Info-b4d3814a.js";import{D as za}from"./components-vendor-e60b5450.js";import"./utils-vendor-48989965.js";import"./state-vendor-2a767ce0.js";import"./MortgageParameters-38162adf.js";import"./ShieldCheckIcon-a0d68f8f.js";const Ua="_container_1pft3_60",Wa="_col_1pft3_66",Za="_title_1pft3_143",Ha={"mortgage-data":"_mortgage-data_1pft3_1","mortgage-data-title":"_mortgage-data-title_1pft3_6","mortgage-data-title__text":"_mortgage-data-title__text_1pft3_20","mortgage-data-title__button":"_mortgage-data-title__button_1pft3_26","mortgage-data-form":"_mortgage-data-form_1pft3_42","mortgage-data-form__items":"_mortgage-data-form__items_1pft3_48","button-left__icon":"_button-left__icon_1pft3_54",container:Ua,col:Wa,"col-1":"_col-1_1pft3_72","col-2":"_col-2_1pft3_82","col-3":"_col-3_1pft3_92","col-4":"_col-4_1pft3_102","col-5":"_col-5_1pft3_112","delete-icon":"_delete-icon_1pft3_126",title:Za,delete:"_delete_1pft3_126"},f=Re.bind(Ha),Ya=()=>{var w;const[a,n]=N.useState([]),[r,i]=N.useState(null),{values:d,setFieldValue:l,errors:m,touched:u,setFieldTouched:p}=je(),[ce,{open:te,close:de}]=ze(!1),{isDesktop:P,isTablet:q,isMobile:A}=Ue(),{t:y,i18n:K}=J(),{getContent:g}=fe("refinance_step1");N.useEffect(()=>{n(d.mortgageData)},[d.mortgageData]);const x=()=>{const B={id:he(a),program:"",balance:null,endDate:"",bid:null};l("mortgageData",[...a,B])},_=t=>{i(t),te()},D=()=>{if(r!==null){const t=a.filter(B=>B.id!==r);l("mortgageData",t)}de()},S=[{value:"option_1",label:g("program_refinance_mortgage_option_1","program_refinance_mortgage_option_1")},{value:"option_2",label:g("program_refinance_mortgage_option_2","program_refinance_mortgage_option_2")},{value:"option_3",label:g("program_refinance_mortgage_option_3","program_refinance_mortgage_option_3")},{value:"option_4",label:g("program_refinance_mortgage_option_4","program_refinance_mortgage_option_4")},{value:"option_5",label:g("program_refinance_mortgage_option_5","program_refinance_mortgage_option_5")}],h=a.reduce((t,B)=>t+B.balance,0);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:f("mortgage-data"),children:[e.jsxs("div",{className:f("mortgage-data-title"),children:[e.jsx("h4",{className:f("mortgage-data-title__text"),children:g("enter_mortgage_info","enter_mortgage_info")}),u.mortgageData&&m.mortgageData&&e.jsx(Te,{filled:!0,icon:e.jsx(We,{size:24,color:"#E76143"}),children:e.jsx("p",{children:y("error_balance",{fullBalance:(w=d==null?void 0:d.mortgageBalance)==null?void 0:w.toLocaleString("en-US"),sumBalance:h.toLocaleString("en-US"),notEnoughBalance:(d.mortgageBalance-h).toLocaleString("en-US")})})})]}),P&&e.jsxs("div",{className:f("mortgage-data-form"),children:[e.jsxs("div",{className:f("container","title"),children:[e.jsx("p",{className:f("col","col-1"),children:g("programm","programm")}),e.jsx("p",{className:f("col","col-2"),children:g("balance","balance")}),e.jsx("p",{className:f("col","col-3"),children:g("end_date","end_date")}),e.jsx("p",{className:f("col","col-4"),children:g("bid","bid")}),e.jsx("div",{className:f("col","col-5")})]}),e.jsxs("div",{className:f("mortgage-data-form__items"),children:[a.map(t=>{var B,o,C,k,E,R,$,T,L,V,z,U,W,Z,H,Y;return e.jsxs("div",{className:f("container"),children:[e.jsx("div",{className:f("col","col-1"),children:e.jsx(X,{data:S,placeholder:y("calculate_mortgage_first_ph"),value:t.program,onChange:I=>l(`mortgageData.${t.id-1}.program`,I),onBlur:()=>p(`mortgageData.${t.id-1}.program`),error:((o=(B=u.mortgageData)==null?void 0:B[t.id-1])==null?void 0:o.program)&&((k=(C=m.mortgageData)==null?void 0:C[t.id-1])==null?void 0:k.program)})}),e.jsx("div",{className:f("col","col-2"),children:e.jsx(oe,{placeholder:"10,000",value:t.balance,handleChange:I=>l(`mortgageData.${t.id-1}.balance`,I),onBlur:()=>p(`mortgageData.${t.id-1}.balance`),error:((R=(E=u.mortgageData)==null?void 0:E[t.id-1])==null?void 0:R.balance)&&((T=($=m.mortgageData)==null?void 0:$[t.id-1])==null?void 0:T.balance)})}),e.jsx("div",{className:f("col","col-3"),children:e.jsx(_e,{placeholder:y("date_ph"),value:t.endDate,allowFuture:!0,blockPastDates:!0,onChange:I=>l(`mortgageData.${t.id-1}.endDate`,I),onBlur:()=>p(`mortgageData.${t.id-1}.endDate`),error:((V=(L=u.mortgageData)==null?void 0:L[t.id-1])==null?void 0:V.endDate)&&((U=(z=m.mortgageData)==null?void 0:z[t.id-1])==null?void 0:U.endDate)})}),e.jsx("div",{className:f("col","col-4"),children:e.jsx(oe,{placeholder:"1",type:"numeric",value:t.bid,handleChange:I=>l(`mortgageData.${t.id-1}.bid`,I),onBlur:()=>p(`mortgageData.${t.id-1}.bid`),error:((Z=(W=u.mortgageData)==null?void 0:W[t.id-1])==null?void 0:Z.bid)&&((Y=(H=m.mortgageData)==null?void 0:H[t.id-1])==null?void 0:Y.bid),rightSection:e.jsx(Se,{color:"#FFF"})})}),e.jsx("div",{className:f("col","col-5"),children:t.id!==1&&e.jsx(ve,{onClick:()=>_(t.id),className:f("delete")})})]},t.id)}),e.jsxs("div",{className:f("container"),children:[e.jsx("div",{className:f("col","col-1"),children:e.jsx(ee,{variant:"none",color:"#FBE54D",value:g("add_programm","add_programm"),onClick:x})}),e.jsx("div",{className:f("col","col-2")}),e.jsx("div",{className:f("col","col-3")}),e.jsx("div",{className:f("col","col-4")}),e.jsx("div",{className:f("col","col-5")})]})]})]}),q&&e.jsx("div",{className:f("mortgage-data-form"),children:e.jsx("div",{className:f("mortgage-data-form__items"),children:e.jsxs(b,{children:[a.map((t,B)=>{var o,C,k,E,R,$,T,L,V,z,U,W,Z,H,Y,I;return e.jsxs(N.Fragment,{children:[e.jsxs(c,{children:[e.jsx(G,{title:`${g("programm","programm")} #${t.id}`}),e.jsx(X,{data:S,placeholder:y("calculate_mortgage_first_ph"),value:t.program,onChange:M=>l(`mortgageData.${t.id-1}.program`,M),onBlur:()=>p(`mortgageData.${t.id-1}.program`),error:((C=(o=u.mortgageData)==null?void 0:o[t.id-1])==null?void 0:C.program)&&((E=(k=m.mortgageData)==null?void 0:k[t.id-1])==null?void 0:E.program)})]}),e.jsxs(c,{children:[e.jsx(G,{title:g("balance","balance")}),e.jsx(oe,{placeholder:"10,000",value:t.balance,handleChange:M=>l(`mortgageData.${t.id-1}.balance`,M),onBlur:()=>p(`mortgageData.${t.id-1}.balance`),error:(($=(R=u.mortgageData)==null?void 0:R[t.id-1])==null?void 0:$.balance)&&((L=(T=m.mortgageData)==null?void 0:T[t.id-1])==null?void 0:L.balance)})]}),e.jsx(c,{children:e.jsx(_e,{title:g("end_date","end_date"),placeholder:y("date_ph"),value:t.endDate,allowFuture:!0,blockPastDates:!0,onChange:M=>l(`mortgageData.${t.id-1}.endDate`,M),onBlur:()=>p(`mortgageData.${t.id-1}.endDate`),error:((z=(V=u.mortgageData)==null?void 0:V[t.id-1])==null?void 0:z.endDate)&&((W=(U=m.mortgageData)==null?void 0:U[t.id-1])==null?void 0:W.endDate)})}),e.jsxs(c,{children:[e.jsx(G,{title:g("bid","bid")}),e.jsx(oe,{placeholder:"1",value:t.bid,handleChange:M=>l(`mortgageData.${t.id-1}.bid`,M),onBlur:()=>p(`mortgageData.${t.id-1}.bid`),error:((H=(Z=u.mortgageData)==null?void 0:Z[t.id-1])==null?void 0:H.bid)&&((I=(Y=m.mortgageData)==null?void 0:Y[t.id-1])==null?void 0:I.bid),rightSection:e.jsx(Se,{color:"#FFF"})})]}),t.id!==1&&e.jsx(c,{children:e.jsxs("div",{className:f("delete-icon"),children:[e.jsx(ve,{onClick:()=>_(t.id)}),y("delete")]})}),B!==a.length-1&&e.jsx(O,{})]},t.id)}),e.jsx(c,{children:e.jsx(ee,{variant:"none",color:"#FBE54D",value:g("add_programm","add_programm"),onClick:x})})]})})}),A&&e.jsx("div",{className:f("mortgage-data-form"),children:e.jsx("div",{className:f("mortgage-data-form__items"),children:e.jsxs(b,{children:[a.map((t,B)=>{var o,C,k,E,R,$,T,L,V,z,U,W,Z,H,Y,I;return e.jsxs(N.Fragment,{children:[e.jsxs(c,{children:[e.jsx(G,{title:`${g("programm","programm")} #${t.id}`}),e.jsx(X,{data:S,placeholder:y("calculate_mortgage_first_ph"),value:t.program,onChange:M=>l(`mortgageData.${t.id-1}.program`,M),onBlur:()=>p(`mortgageData.${t.id-1}.program`),error:((C=(o=u.mortgageData)==null?void 0:o[t.id-1])==null?void 0:C.program)&&((E=(k=m.mortgageData)==null?void 0:k[t.id-1])==null?void 0:E.program)})]}),e.jsxs(c,{children:[e.jsx(G,{title:g("balance","balance")}),e.jsx(oe,{placeholder:"10,000",value:t.balance,handleChange:M=>l(`mortgageData.${t.id-1}.balance`,M),onBlur:()=>p(`mortgageData.${t.id-1}.balance`),error:(($=(R=u.mortgageData)==null?void 0:R[t.id-1])==null?void 0:$.balance)&&((L=(T=m.mortgageData)==null?void 0:T[t.id-1])==null?void 0:L.balance)})]}),e.jsx(c,{children:e.jsx(_e,{title:g("end_date","end_date"),placeholder:y("date_ph"),value:t.endDate,allowFuture:!0,blockPastDates:!0,onChange:M=>l(`mortgageData.${t.id-1}.endDate`,M),onBlur:()=>p(`mortgageData.${t.id-1}.endDate`),error:((z=(V=u.mortgageData)==null?void 0:V[t.id-1])==null?void 0:z.endDate)&&((W=(U=m.mortgageData)==null?void 0:U[t.id-1])==null?void 0:W.endDate)})}),e.jsxs(c,{children:[e.jsx(G,{title:g("bid","bid")}),e.jsx(oe,{placeholder:"1",value:t.bid,handleChange:M=>l(`mortgageData.${t.id-1}.bid`,M),onBlur:()=>p(`mortgageData.${t.id-1}.bid`),error:((H=(Z=u.mortgageData)==null?void 0:Z[t.id-1])==null?void 0:H.bid)&&((I=(Y=m.mortgageData)==null?void 0:Y[t.id-1])==null?void 0:I.bid),rightSection:e.jsx(Se,{color:"#FFF"})})]}),t.id!==1&&e.jsx(c,{children:e.jsxs("div",{className:f("delete-icon"),children:[e.jsx(ve,{onClick:()=>_(t.id)}),y("delete")]})}),B!==a.length-1&&e.jsx(O,{})]},t.id)}),e.jsx(c,{children:e.jsx(ee,{variant:"none",color:"#FBE54D",value:g("add_programm","add_programm"),onClick:x})})]})})})]}),e.jsx(ba,{text:y("remove_programm"),subtitle:y("remove_mortgage_program_subtitle"),isVisible:ce,onCancel:de,onSubmit:D})]})},Ga=()=>{const{t:a,i18n:n}=J(),{getContent:r}=fe("refinance_step1"),[i,d]=N.useState(51130),[l,m]=N.useState(2654),u=le(),p=v(h=>h.activeField),{data:ce,loading:te,error:de,getDropdownProps:P}=xa("refinance_step1"),q=P("why"),A=P("property_type"),y=P("registration"),K=P("bank"),{setFieldValue:g,values:x,errors:_,touched:D,setFieldTouched:S}=je();return te&&console.log("ðŸ”„ Loading dropdown data for refinance_step1..."),ce&&!te&&console.log("âœ… Dropdown data loaded for refinance_step1:",{why:q.options.length,propertyType:A.options.length,registration:y.options.length,bank:K.options.length}),N.useLayoutEffect(()=>{(async()=>{try{const w=await ue.calculateMortgagePayment(x.mortgageBalance,0,4),t=await ue.calculateMortgagePayment(x.mortgageBalance,0,30);Number.isNaN(w)||d(w),w===0&&d(1),Number.isNaN(t)||m(t)}catch(w){console.error("âŒ Error calculating mortgage payment limits:",w),d(51130),m(2654)}})()},[x.mortgageBalance]),N.useEffect(()=>{(async()=>{try{if(p==="period"){const w=await ue.calculateMortgagePayment(x.mortgageBalance,0,x.period);Number.isNaN(w)||g("monthlyPayment",w)}else{const w=await ue.calculateLoanPeriod(x.mortgageBalance,0,x.monthlyPayment);Number.isNaN(w)||g("period",w)}}catch(w){console.error("âŒ Error calculating mortgage refinance values:",w)}})()},[p,g,x.monthlyPayment,x.mortgageBalance,x.period]),e.jsx(e.Fragment,{children:e.jsxs(we,{children:[e.jsx(me,{title:r("app.refinance.step1.title",a("app.refinance.step1.title"))}),e.jsxs(b,{children:[e.jsx(c,{children:e.jsx(X,{data:q.options,title:q.label||r("app.refinance.step1.why_label",a("app.refinance.step1.why_label")),placeholder:q.placeholder||a("mortgage_refinance_why_ph"),value:x.whyRefinancingMortgage,onChange:h=>g("whyRefinancingMortgage",h),onBlur:()=>S("whyRefinancingMortgage"),error:D.whyRefinancingMortgage&&_.whyRefinancingMortgage})}),e.jsxs(c,{children:[e.jsx(pe,{name:"PriceOfEstate",title:r("app.refinance.step1.balance_label",a("app.refinance.step1.balance_label")),value:x.mortgageBalance,placeholder:"1,000,000",handleChange:h=>{u(De("period")),g("mortgageBalance",h)},onBlur:()=>S("mortgageBalance"),error:D.mortgageBalance&&_.mortgageBalance}),D.mortgageBalance&&_.mortgageBalance&&e.jsx(Q,{error:_.mortgageBalance})]}),e.jsxs(c,{children:[e.jsx(pe,{handleChange:h=>g("priceOfEstate",h),name:"PriceOfEstate",title:r("app.refinance.step1.property_value_label",a("app.refinance.step1.property_value_label")),value:x.priceOfEstate,placeholder:"1,000,000",error:_.priceOfEstate}),_.priceOfEstate&&e.jsx(Q,{error:_.priceOfEstate})]})]}),e.jsxs(b,{children:[e.jsx(c,{children:e.jsx(X,{data:A.options,title:A.label||r("app.refinance.step1.property_type_label",a("app.refinance.step1.property_type_label")),placeholder:A.placeholder||a("mortgage_refinance_type_ph"),value:x.typeSelect,onChange:h=>g("typeSelect",h),onBlur:()=>S("typeSelect"),error:D.typeSelect&&_.typeSelect})}),e.jsx(c,{children:e.jsx(X,{data:K.options,title:K.label||r("app.refinance.step1.current_bank_label",a("app.refinance.step1.current_bank_label")),placeholder:K.placeholder||a("mortgage_refinance_bank_ph"),value:x.bank,onChange:h=>g("bank",h),onBlur:()=>S("bank"),error:D.bank&&_.bank})}),e.jsx(c,{children:e.jsx(X,{data:y.options,title:y.label||r("app.refinance.step1.registered_label",a("app.refinance.step1.registered_label")),placeholder:y.placeholder||a("mortgage_refinance_registered_ph"),value:x.propertyRegistered,onChange:h=>g("propertyRegistered",h),onBlur:()=>S("propertyRegistered"),error:D.propertyRegistered&&_.propertyRegistered})})]}),e.jsxs(b,{children:[e.jsxs(c,{children:[e.jsx(_e,{title:r("app.refinance.step1.start_date_label",a("app.refinance.step1.start_date_label")),placeholder:a("date_ph"),value:x.startDate,onChange:h=>g("startDate",h),onBlur:()=>S("startDate"),error:D.startDate&&_.startDate}),D.startDate&&_.startDate&&e.jsx(Q,{error:_.startDate})]}),x.whyRefinancingMortgage==="option_2"&&e.jsxs(c,{children:[e.jsx(pe,{handleChange:h=>g("decreaseMortgage",h),name:"PriceOfEstate",title:a("mortgage_refinance_decrease"),value:x.decreaseMortgage,placeholder:"1,000,000",onBlur:()=>S("decreaseMortgage"),error:D.decreaseMortgage&&_.decreaseMortgage}),D.decreaseMortgage&&_.decreaseMortgage&&e.jsx(Q,{error:_.decreaseMortgage})]}),x.whyRefinancingMortgage==="option_5"&&e.jsxs(c,{children:[e.jsx(pe,{handleChange:h=>g("increaseMortgage",h),name:"PriceOfEstate",title:a("mortgage_refinance_increase"),value:x.increaseMortgage,placeholder:"1,000,000",onBlur:()=>S("increaseMortgage"),error:D.increaseMortgage&&_.increaseMortgage}),D.increaseMortgage&&_.increaseMortgage&&e.jsx(Q,{error:_.increaseMortgage})]}),e.jsx(c,{})]}),e.jsx(O,{}),e.jsx(b,{children:e.jsx(Ya,{})}),e.jsx(O,{}),e.jsxs(b,{children:[e.jsxs(c,{children:[e.jsx(Oe,{disableCurrency:!0,unitsMax:a("calculate_mortgage_period_units_max"),unitsMin:a("calculate_mortgage_period_units_min"),value:x.period,name:"Period",min:4,max:30,error:_.period,title:a("calculate_mortgage_period"),handleChange:h=>{u(De("period")),g("period",h)}}),_.period&&e.jsx(Q,{error:_.period})]}),e.jsxs(c,{children:[e.jsx(Oe,{unitsMax:"â‚ª",unitsMin:"â‚ª",value:x.monthlyPayment,name:"monthlyPayment",min:l,max:i,error:_.monthlyPayment,title:a("calculate_mortgage_initial_payment"),handleChange:h=>{u(De("monthlyPayment")),g("monthlyPayment",h)},onBlur:()=>S("monthlyPayment")}),e.jsx(ja,{}),D.monthlyPayment&&_.monthlyPayment&&e.jsx(Q,{error:_.monthlyPayment})]}),e.jsx(c,{})]})]})})},Ja=N.memo(Ga),Ka=()=>ie().shape({whyRefinancingMortgage:j().required(s("error_refinance_why_required","Please specify why you want to refinance")),mortgageBalance:F().test("is-less",s("error_refinance_balance_greater_than_property","Mortgage balance cannot exceed property value"),function(a){const{priceOfEstate:n}=this.parent;return typeof a>"u"?!0:typeof n=="number"?a<=n:!0}).required(s("error_required_to_fill_out","This field is required")),priceOfEstate:F().test("is-greater",s("error_refinance_property_less_than_balance","Property value must be at least the mortgage balance"),function(a){const{mortgageBalance:n}=this.parent;return typeof a>"u"?!0:typeof n=="number"?a>=n:!0}).required(s("error_required_to_fill_out","This field is required")),typeSelect:j().required(s("error_refinance_type_required","Property type is required")),bank:j().required(s("error_refinance_bank_required","Current bank is required")),propertyRegistered:j().required(s("error_refinance_registered_required","Property registration status is required")),startDate:j().required(s("error_refinance_start_date_required","Mortgage start date is required")),period:F().min(4,s("error_min_period","Minimum period is 4 years")).max(30,s("error_max_period","Maximum period is 30 years")).required(s("error_required_to_fill_out","This field is required")),monthlyPayment:F().positive(s("error_mortgage_payment_positive","Monthly payment must be positive")).required(s("error_required_to_fill_out","This field is required")),decreaseMortgage:j().when("whyRefinancingMortgage",{is:"option_2",then:a=>a.required(s("error_required_to_fill_out","This field is required")),otherwise:a=>a.notRequired()}),increaseMortgage:j().when("whyRefinancingMortgage",{is:"option_5",then:a=>a.required(s("error_required_to_fill_out","This field is required")),otherwise:a=>a.notRequired()}),mortgageData:Pe().of(ie().shape({program:j().required(s("error_mortgage_program_required","Mortgage program is required")),balance:F().positive(s("error_mortgage_balance_positive","Balance must be positive")).required(s("error_mortgage_balance_required","Mortgage balance is required")),endDate:j().required(s("error_mortgage_end_date_required","End date is required")),bid:F().positive(s("error_mortgage_bid_positive","Bid must be positive")).required(s("error_mortgage_bid_required","Bid is required"))})).test("is-balance-sum-equal",s("error_refinance_mortgage_balance_mismatch","Total mortgage balance must match individual balances"),function(){return this.parent.mortgageData.reduce((n,r)=>n+(r.balance||0),0)===this.parent.mortgageBalance})}),Qa=()=>{const{t:a,i18n:n}=J(),r=le();re();const i=v(l=>l.refinanceMortgage);v(l=>l.login.isLogin);const d={whyRefinancingMortgage:i.whyRefinancingMortgage||"",mortgageBalance:i.mortgageBalance||2e5,priceOfEstate:i.priceOfEstate||1e6,typeSelect:i.typeSelect||"",bank:i.bank||"",startDate:i.startDate||"",propertyRegistered:i.propertyRegistered||"",period:i.period||4,monthlyPayment:i.monthlyPayment||4605,decreaseMortgage:i.decreaseMortgage||null,increaseMortgage:i.increaseMortgage||null,mortgageData:i.mortgageData||[{id:1,program:"",balance:null,endDate:"",bid:null}]};return e.jsxs(e.Fragment,{children:[e.jsx(be,{initialValues:d,validationSchema:Ka(),validateOnMount:!0,onSubmit:l=>{r(ae(l)),r(Je()),r($e("phoneVerification"))},children:e.jsxs(ye,{children:[e.jsxs(xe,{children:[e.jsx(ca,{title:a("sidebar_sub_refinance_mortgage"),text:a("refinance_mortgage_promo_text"),size:"small"}),e.jsx(Ja,{})]}),e.jsx(da,{})]})}),e.jsx(ga,{}),e.jsx(Ze,{})]})},Xa=()=>{const{t:a,i18n:n}=J(),r=v(d=>d.login.loginData),i=v(d=>d.refinanceMortgage);return e.jsxs(we,{children:[e.jsx(me,{title:a("refinance_mortgage_final")}),e.jsx(ma,{cost:i==null?void 0:i.priceOfEstate,initialPayment:i==null?void 0:i.mortgageBalance,period:i==null?void 0:i.period,nameSurname:r==null?void 0:r.nameSurname,phoneNumber:r==null?void 0:r.phoneNumber}),e.jsx(Te,{text:a("refinance_mortgage_warning")}),e.jsx(b,{children:e.jsx(pa,{})}),e.jsx(ua,{})]})},er={selectedBank:"",selectedOffer:null},ar=ie().shape({selectedBank:j(),selectedOffer:ie().nullable()}),rr=()=>{const a=le(),n=re(),r=v(d=>d.login.loginData),i=v(d=>d.login.isLogin);return e.jsx(be,{initialValues:er,validationSchema:ar,validateOnMount:!0,onSubmit:d=>{console.log("Saving refinance mortgage data and proceeding...",d),a(ae(d)),!i||!(r!=null&&r.phoneNumber)?(console.log("User not authenticated, opening auth modal"),a(Ke()),a($e("signUp"))):(console.log("User authenticated, proceeding to application"),n("/services/application-submitted"))},children:e.jsxs(ye,{children:[e.jsx(xe,{children:e.jsx(Xa,{})}),e.jsx(Be,{})]})})},tr=()=>{J();const{getContent:a}=fe("refinance_step2"),{values:n}=je(),r=v(m=>m.login.loginData),[i,d]=N.useState(null);N.useEffect(()=>{if(!(r!=null&&r.nameSurname)||!(r!=null&&r.phoneNumber)){const m=localStorage.getItem("USER_DATA");if(m)try{const u=JSON.parse(m);d({nameSurname:u.nameSurname||u.name_surname,phoneNumber:u.phoneNumber||u.mobile_number})}catch(u){console.error("Error parsing localStorage USER_DATA:",u)}}},[r]);const l=r!=null&&r.nameSurname?r:i;return console.log("ðŸ” SecondStepForm - userData from Redux:",r),console.log("ðŸ” SecondStepForm - fallbackUserData from localStorage:",i),console.log("ðŸ” SecondStepForm - displayUserData (final):",l),e.jsxs(we,{children:[e.jsx(me,{title:a("refinance_step2_title","calculate_mortgage_step2_title")}),e.jsxs(Sa,{children:[e.jsx(Va,{}),e.jsx(se,{name:l==null?void 0:l.nameSurname,phone:l==null?void 0:l.phoneNumber})]}),e.jsxs(b,{children:[e.jsx(qa,{}),e.jsx(Ca,{}),e.jsx(Ia,{screenLocation:"refinance_step2"})]}),e.jsxs(b,{children:[e.jsxs(c,{style:{gap:"2rem"},children:[e.jsx(Na,{}),n.additionalCitizenships==="yes"&&e.jsx(Ra,{})]}),e.jsxs(c,{style:{gap:"2rem"},children:[e.jsx(Fa,{}),n.taxes==="yes"&&e.jsx($a,{})]}),e.jsxs(c,{style:{gap:"2rem"},children:[e.jsx(Oa,{}),n.childrens==="yes"&&e.jsx(Ta,{})]})]}),e.jsx(O,{}),e.jsxs(b,{children:[e.jsx(ka,{}),e.jsx(Ea,{}),e.jsx(Aa,{})]}),e.jsx(O,{}),e.jsxs(b,{children:[e.jsx(Ma,{}),e.jsx(c,{}),e.jsx(c,{})]}),e.jsx(O,{}),e.jsxs(b,{children:[e.jsx(La,{}),e.jsx(c,{children:n.familyStatus==="option_2"&&e.jsx(Pa,{})}),e.jsx(c,{children:n.partnerPayMortgage==="yes"&&n.familyStatus==="option_2"&&e.jsx(Ba,{})})]})]})},or=()=>ie().shape({nameSurname:j().required(s("error_name_surname","Please enter your name and surname")),birthday:j().required(s("error_date","Please enter a valid date")),education:j().required(s("error_select_answer","Please select an answer")),additionalCitizenships:j().required(s("error_select_answer","Please select an answer")),citizenshipsDropdown:Pe().when("additionalCitizenships",{is:"yes",then:a=>a.min(1,s("error_select_answer","Please select an answer")),otherwise:a=>a.min(0)}),taxes:j().required(s("error_select_answer","Please select an answer")),countriesPayTaxes:Pe().when("taxes",{is:"yes",then:a=>a.min(1,s("error_select_answer","Please select an answer")),otherwise:a=>a.min(0)}),childrens:j().required(s("error_select_answer","Please select an answer")),howMuchChildrens:F().required(s("error_fill_field","Please fill this field")),medicalInsurance:j().required(s("error_select_answer","Please select an answer")),isForeigner:j().required(s("error_select_answer","Please select an answer")),publicPerson:j().required(s("error_select_answer","Please select an answer")),borrowers:F().min(1,s("error_quantity_borrowers","Please specify number of borrowers")).required(s("error_quantity_borrowers","Please specify number of borrowers")),familyStatus:j().required(s("error_select_answer","Please select an answer")),partnerPayMortgage:j().when("familyStatus",{is:"option_2",then:a=>a.required(s("error_select_answer","Please select an answer")),otherwise:a=>a.notRequired()})}),nr=or(),sr=()=>{const a=le(),n=re(),r=v(l=>l.refinanceMortgage),d={nameSurname:v(l=>l.login.loginData).nameSurname||r.nameSurname||"",birthday:r.birthday||new Date(new Date().setFullYear(new Date().getFullYear()-18)).getTime(),education:r.education||"",additionalCitizenships:r.additionalCitizenships||null,citizenshipsDropdown:r.citizenshipsDropdown||[],taxes:r.taxes||null,countriesPayTaxes:r.countriesPayTaxes||[],childrens:r.childrens||null,howMuchChildrens:r.howMuchChildrens||1,medicalInsurance:r.medicalInsurance||null,isForeigner:r.isForeigner||null,publicPerson:r.publicPerson||null,borrowers:r.borrowers||null,familyStatus:r.familyStatus||"",partnerPayMortgage:r.partnerPayMortgage||null,addPartner:r.addPartner||""};return e.jsx(be,{initialValues:d,validationSchema:nr,validateOnMount:!0,onSubmit:l=>{a(ae(l)),n("/services/refinance-mortgage/3")},children:e.jsxs(ye,{children:[e.jsx(xe,{children:e.jsx(tr,{})}),e.jsx(Be,{})]})})},ir=()=>{const{t:a,i18n:n}=J(),{getContent:r}=fe("refinance_step3"),i=re(),{values:d}=je(),{mainSourceOfIncome:l,additionalIncome:m,obligation:u}=d,p=le(),ce=v(o=>o.borrowers.sourceOfIncomeModal),te=v(o=>o.borrowers.additionalIncomeModal),de=v(o=>o.borrowers.obligationModal),P=v(o=>o.otherBorrowers.otherBorrowers),q=v(o=>o.login.loginData),A=()=>{p(ae(d)),p(Qe())},y=()=>{p(ae(d)),p(Xe())},K=()=>{p(ae(d)),p(ea())},g=o=>{p(aa({id:o}))},x=o=>{p(ra({id:o}))},_=o=>{p(ta({id:o}))},D=o=>{p(oa(o))},S=o=>{p(na(o))},h=o=>{p(sa(o))},w=o=>{p(Ne(o));const k=!P.some(E=>E.id===o)?he(P):o;i({pathname:"/services/other-borrowers/1/",search:Ce({pageId:String(k)}).toString()})},t=()=>{p(Ne(he(P))),i({pathname:"/services/other-borrowers/1/",search:Ce({pageId:he(P).toString()}).toString()})},B=o=>{p(ia(o))};return e.jsxs(we,{children:[e.jsx(me,{title:r("refinance_step3_title","calculate_mortgage_step3_title")}),e.jsx(se,{name:q==null?void 0:q.nameSurname,phone:q==null?void 0:q.phoneNumber}),e.jsxs(b,{children:[e.jsx(ya,{}),Ee[l]&&Ee[l].map((o,C)=>e.jsx(qe.Fragment,{children:o},C))]}),e.jsx(b,{children:e.jsx(c,{children:l&&e.jsxs(e.Fragment,{children:[ce.map(o=>e.jsx(se,{onEdit:()=>D(o.id),onDelete:()=>g(o.id),enableEdit:!0,name:`${r("source_of_income_label","Source of Income")} ${o.id+1}`},o.id)),e.jsx(ee,{onClick:A,color:"#FBE54D",value:r("add_place_to_work_button","Add Place to Work"),variant:"none"})]})})}),e.jsx(O,{}),e.jsxs(b,{children:[e.jsx(wa,{}),m&&m!=="no_additional_income"&&e.jsx(Da,{}),e.jsx(c,{})]}),m&&m!=="no_additional_income"&&e.jsx(b,{children:e.jsxs(c,{children:[te.map(o=>e.jsx(se,{onEdit:()=>S(o.id),onDelete:()=>x(o.id),enableEdit:!0,name:`${r("additional_source_of_income_label","Additional Source of Income")} ${o.id+1}`},o.id)),e.jsx(ee,{onClick:y,color:"#FBE54D",value:r("add_additional_source_of_income_button","Add Additional Source of Income"),variant:"none"})]})}),e.jsx(O,{}),e.jsxs(b,{children:[e.jsx(va,{}),Ae[u]&&Ae[u].map((o,C)=>e.jsx(qe.Fragment,{children:o},C)),e.jsx(c,{})]}),u&&u!=="no_obligations"&&e.jsx(b,{children:e.jsxs(c,{children:[de.map(o=>e.jsx(se,{onEdit:()=>h(o.id),onDelete:()=>_(o.id),enableEdit:!0,name:`${r("obligation_label","Obligation")} ${o.id+1}`},o.id)),e.jsx(ee,{onClick:K,color:"#FBE54D",value:r("add_obligation_button","Add Obligation"),variant:"none"})]})}),e.jsx(O,{}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[P&&e.jsx(G,{title:a("borrower")}),e.jsxs(b,{style:{columnGap:"2rem"},children:[P.map(o=>e.jsx(c,{children:e.jsx(se,{onEdit:()=>w(o.id),onDelete:()=>B(o.id),enableEdit:!0,name:o.nameSurname},o.id)},o.id)),!P&&e.jsx(G,{title:a("borrower")}),e.jsx(c,{children:e.jsx(ee,{value:a("add_borrower"),onClick:t,style:{height:"3.5rem",borderRadius:"0.25rem",padding:"0",width:"13.125rem"}})}),e.jsx(c,{})]})]})]})},ge=a=>{if(!a)return!1;const n=a.toLowerCase();return n==="option_5"||n==="option_6"||n==="5"||n==="6"||n.includes("unemployed")||n.includes("no_income")||n.includes("unpaid")},lr=a=>{if(!a)return!1;const n=a.toLowerCase();return n==="option_1"||n==="1"||n.includes("no_additional")||n.includes("none")},Me=a=>{if(!a)return!1;const n=a.toLowerCase();return n==="option_1"||n==="1"||n.includes("no_obligation")||n.includes("no_obligations")||n.includes("none")},Le=()=>ie().shape({mainSourceOfIncome:j().required(s("error_select_answer","Please select an answer")).test("not-empty",s("error_select_answer","Please select an answer"),a=>a!=null&&a!==""),monthlyIncome:F().when("mainSourceOfIncome",{is:a=>!ge(a),then:a=>a.required(s("error_fill_field","Please fill this field")),otherwise:a=>a.notRequired()}),startDate:Fe().when("mainSourceOfIncome",{is:a=>!ge(a),then:a=>a.required(s("error_date","Please enter a valid date")),otherwise:a=>a.notRequired()}),fieldOfActivity:j().when("mainSourceOfIncome",{is:a=>a!=null&&a!==""&&!ge(a),then:a=>a.required(s("error_select_field_of_activity","Please select field of activity")),otherwise:a=>a.notRequired()}),profession:j().when("mainSourceOfIncome",{is:a=>!ge(a),then:a=>a.required(s("error_fill_field","Please fill this field")),otherwise:a=>a.notRequired()}),companyName:j().when("mainSourceOfIncome",{is:a=>!ge(a),then:a=>a.required(s("error_fill_field","Please fill this field")),otherwise:a=>a.notRequired()}),additionalIncome:j().required(s("error_select_one_of_the_options","Please select one of the options")),additionalIncomeAmount:F().when("additionalIncome",{is:a=>a!=null&&a!==""&&!lr(a),then:a=>a.required(s("error_fill_field","Please fill this field")),otherwise:a=>a.notRequired()}),obligation:j().required(s("error_select_one_of_the_options","Please select one of the options")),bank:j().when("obligation",{is:a=>a!=null&&a!==""&&!Me(a),then:a=>a.required(s("error_select_bank","Please select a bank")),otherwise:a=>a.notRequired()}),monthlyPaymentForAnotherBank:F().when("obligation",{is:a=>a!=null&&a!==""&&!Me(a),then:a=>a.required(s("error_fill_field","Please fill this field")),otherwise:a=>a.notRequired()}),endDate:Fe().when("obligation",{is:a=>a!=null&&a!==""&&!Me(a),then:a=>a.required(s("error_date","Please enter a valid date")),otherwise:a=>a.notRequired()})});Le();const cr=()=>{const a=le(),n=re(),r=v(d=>d.refinanceMortgage),i={mainSourceOfIncome:r.mainSourceOfIncome||"",monthlyIncome:r.monthlyIncome||null,startDate:r.startDate||new Date().getTime(),fieldOfActivity:r.fieldOfActivity||"",profession:r.profession||"",companyName:r.companyName||"",additionalIncome:r.additionalIncome||"",additionalIncomeAmount:r.additionalIncomeAmount||null,obligation:r.obligation||"option_1",bank:r.bank||"",monthlyPaymentForAnotherBank:r.monthlyPaymentForAnotherBank||null,endDate:r.endDate||new Date().getTime(),amountIncomeCurrentYear:(r==null?void 0:r.amountIncomeCurrentYear)||null,noIncome:r.noIncome||new Date().getTime()};return e.jsxs(e.Fragment,{children:[e.jsx(be,{initialValues:i,validationSchema:Le(),validateOnMount:!0,onSubmit:d=>{a(ae(d)),n("/services/refinance-mortgage/4")},children:e.jsxs(ye,{children:[e.jsx(xe,{children:e.jsx(ir,{})}),e.jsx(Be,{})]})}),e.jsx(_a,{}),e.jsx(ha,{}),e.jsx(fa,{})]})},dr=a=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",...a,children:e.jsx("path",{fill:"#FBE54D",d:"M21 9.75a.75.75 0 1 1-1.5 0V5.561l-6.218 6.22a.75.75 0 1 1-1.062-1.062L18.44 4.5H14.25a.75.75 0 1 1 0-1.5h6a.75.75 0 0 1 .75.75v6ZM17.25 12a.75.75 0 0 0-.75.75v6.75h-12v-12h6.75a.75.75 0 1 0 0-1.5H4.5A1.5 1.5 0 0 0 3 7.5v12A1.5 1.5 0 0 0 4.5 21h12a1.5 1.5 0 0 0 1.5-1.5v-6.75a.75.75 0 0 0-.75-.75Z"})}),gr=a=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",...a,children:e.jsx("path",{fill:"#fff",d:"M21.788 10.734 8.28 2.47a1.5 1.5 0 0 0-2.075.516A1.487 1.487 0 0 0 6 3.738v16.525a1.494 1.494 0 0 0 1.5 1.487c.277 0 .548-.076.784-.22l13.504-8.263a1.481 1.481 0 0 0 0-2.531v-.002ZM7.5 20.244V3.75L20.984 12 7.5 20.245Z"})}),mr=a=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:33,height:32,fill:"none",...a,children:e.jsx("path",{fill:"#fff",d:"M28.5 19v7a2 2 0 0 1-2 2h-20a2 2 0 0 1-2-2v-7a1 1 0 1 1 2 0v7h20v-7a1 1 0 0 1 2 0Zm-16.293-8.293L15.5 7.414V19a1 1 0 0 0 2 0V7.414l3.293 3.293a1 1 0 1 0 1.415-1.415l-5-5a1 1 0 0 0-1.415 0l-5 5a1 1 0 0 0 1.415 1.415Z"})}),pr={"upload-buttons":"_upload-buttons_3j3y8_1","upload-report-file":"_upload-report-file_3j3y8_6","upload-report-file__wrapper":"_upload-report-file__wrapper_3j3y8_22","upload-report-file__text":"_upload-report-file__text_3j3y8_28","submit-buttons":"_submit-buttons_3j3y8_34","submit-buttons__wrapper":"_submit-buttons__wrapper_3j3y8_44"},ne=Re.bind(pr),ur=()=>{const{t:a,i18n:n}=J(),r=re();return e.jsx("div",{className:"step1",children:e.jsxs("div",{className:"home step1-container noborder",children:[e.jsx(me,{title:a("upload_report_title"),subtitle:a("upload_report_subtitle")}),e.jsxs("div",{className:ne("upload-buttons"),children:[e.jsx(ke,{text:a("video_instruction"),leftSection:e.jsx(gr,{})}),e.jsx(ke,{text:a("download_report_here"),rightSection:e.jsx(dr,{}),onClick:()=>window.open("https://www.creditdata.org.il/","_blank")})]}),e.jsx(O,{}),e.jsx(za,{onDrop:i=>console.log(i),children:({getRootProps:i,getInputProps:d})=>e.jsx("section",{className:ne("upload-report-file"),children:e.jsxs("div",{...i(),className:ne("upload-report-file__wrapper"),children:[e.jsx("input",{...d()}),e.jsx(mr,{}),e.jsxs("p",{className:ne("upload-report-file__text"),children:[a("dropzone_upload_report"),e.jsx("span",{style:{color:"#FBE54D"},children:a("dropzone_comp_upload_report")})]})]})})}),e.jsx("div",{className:ne("submit-buttons"),children:e.jsxs("div",{className:ne("submit-buttons__wrapper"),children:[e.jsx(He,{title:a("button_back"),handleClick:()=>r("/services/refinance-mortgage/1")}),e.jsx(Ye,{onClick:()=>r("/services/refinance-mortgage/1"),children:a("button_next_save")})]})})]})})},_r=()=>{const{stepNumber:a}=Ve(),{t:n,i18n:r}=J(),i=re();if(!v(p=>p.login.isLogin)&&a!=="1"){i("/services/refinance-mortgage/1");return}const l=[n("mobile_step_1"),n("mobile_step_2"),n("mobile_step_3"),n("mobile_step_4")];let m;switch(a){case"1":m=e.jsx(Qa,{});break;case"2":m=e.jsx(sr,{});break;case"3":m=e.jsx(cr,{});break;case"4":m=e.jsx(rr,{});break;case"upload-report":m=e.jsx(ur,{});break;default:m=e.jsx(la,{type:"NOT_FOUND"});break}const u=a==="upload-report"?"1":a;return e.jsxs(e.Fragment,{children:[a!=="upload-report"&&e.jsx(Ie,{progress:u,data:l}),a==="upload-report"&&e.jsx(Ie,{progress:"1",data:[n("upload_report_progress"),n("mobile_step_2"),n("mobile_step_3")]}),e.jsx(N.Suspense,{fallback:e.jsx(Ge,{}),children:m})]})},Qr=_r;export{Qr as RefinanceMortgage};
