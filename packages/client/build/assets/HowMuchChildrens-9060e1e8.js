import{j as e}from"./ui-vendor-5a9cd79c.js";import{u as O}from"./form-vendor-429348f6.js";import{r as n}from"./react-vendor-19e41fc0.js";import{C as E}from"./Column-b52dd59a.js";import{g as A,h as $,E as S,T as D,a as I}from"./index-edeff406.js";import{c as L}from"./index-bc53121f.js";import{M as V}from"./DropdownMenu-c93145d6.js";import{u as B}from"./i18n-vendor-5cfd36a0.js";import{F as H}from"./FormattedInput-d86805f8.js";const U=l=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:17,height:16,fill:"none",...l,children:e.jsx("path",{fill:"#fff",d:"M5.634 10.867a.632.632 0 0 0 .467.184.632.632 0 0 0 .466-.184l1.934-1.933 1.95 1.95c.122.122.275.18.458.175a.65.65 0 0 0 .458-.192.632.632 0 0 0 .184-.466.632.632 0 0 0-.184-.467L9.434 8.001l1.95-1.95a.594.594 0 0 0 .175-.459.65.65 0 0 0-.192-.458.632.632 0 0 0-.466-.183.632.632 0 0 0-.467.183L8.501 7.067l-1.95-1.95a.595.595 0 0 0-.458-.175.653.653 0 0 0-.459.192.632.632 0 0 0-.183.467c0 .189.06.344.183.466l1.933 1.934-1.95 1.95a.593.593 0 0 0-.174.458.65.65 0 0 0 .191.458Zm2.867 3.8a6.489 6.489 0 0 1-2.6-.525 6.728 6.728 0 0 1-2.117-1.425 6.728 6.728 0 0 1-1.425-2.116A6.489 6.489 0 0 1 1.834 8c0-.923.175-1.79.525-2.6a6.728 6.728 0 0 1 1.425-2.117c.6-.6 1.306-1.075 2.117-1.425a6.495 6.495 0 0 1 2.6-.525c.922 0 1.789.175 2.6.525.81.35 1.516.825 2.116 1.425.6.6 1.075 1.306 1.425 2.117.35.81.525 1.677.525 2.6 0 .922-.175 1.789-.525 2.6a6.728 6.728 0 0 1-1.425 2.116c-.6.6-1.305 1.075-2.116 1.425a6.49 6.49 0 0 1-2.6.525Zm0-1.333c1.477 0 2.736-.52 3.775-1.558 1.039-1.04 1.558-2.298 1.558-3.775 0-1.478-.52-2.737-1.558-3.776-1.04-1.038-2.298-1.558-3.775-1.558-1.478 0-2.736.52-3.775 1.558-1.04 1.04-1.559 2.298-1.559 3.776 0 1.477.52 2.736 1.559 3.775 1.039 1.039 2.297 1.558 3.775 1.558Z"})}),Z="_multiselect_18kzf_1",J="_focus_18kzf_140",q="_error_18kzf_144",G="_checkbox_18kzf_148",K={multiselect:Z,"multiselect-scroll":"_multiselect-scroll_18kzf_10","multiselect-wrapper":"_multiselect-wrapper_18kzf_14","multiselect-placeholder":"_multiselect-placeholder_18kzf_22","multiselect-input":"_multiselect-input_18kzf_33","multiselect-input__item":"_multiselect-input__item_18kzf_38","multiselect-select":"_multiselect-select_18kzf_50","multiselect-select__button":"_multiselect-select__button_18kzf_61","multiselect-select__button-item":"_multiselect-select__button-item_18kzf_64","multiselect-select__subtitle":"_multiselect-select__subtitle_18kzf_75","multiselect-select__item":"_multiselect-select__item_18kzf_84","multiselect-select__item-title":"_multiselect-select__item-title_18kzf_99","multiselect-select__search":"_multiselect-select__search_18kzf_104","multiselect-select__search-wrapper":"_multiselect-select__search-wrapper_18kzf_107","multiselect-select__search-input":"_multiselect-select__search-input_18kzf_117","multiselect-select__search-no-result":"_multiselect-select__search-no-result_18kzf_134",focus:J,error:q,checkbox:G},c=L.bind(K),M=({data:l,placeholder:g,onChange:o,value:s,searchable:d,searchPlaceholder:x,nothingFoundText:z,searchDescription:b,onBlur:k,error:j})=>{const{t:y,i18n:T}=B(),[i,u]=n.useState(!1),[_,a]=n.useState(""),[m,C]=n.useState([]),f=n.useRef(null);n.useEffect(()=>{i&&C(s||[])},[i,s]);const p=n.useCallback(t=>{f.current&&!f.current.contains(t.target)&&u(!1)},[]),w=n.useCallback(t=>{f.current&&f.current.contains(t.relatedTarget)||(i&&JSON.stringify(m.sort())!==JSON.stringify((s||[]).sort())&&(o==null||o(m)),u(!1),k==null||k())},[i,m,s,o,k]),F=t=>{C(r=>r.includes(t)?r.filter(h=>h!==t):[...r,t])},N=(t,r)=>{const h=(s==null?void 0:s.filter(v=>v!==t))||[];o==null||o(h),C(v=>v.filter(R=>R!==t)),r.stopPropagation()};n.useEffect(()=>(document.addEventListener("mousedown",p),()=>document.removeEventListener("mousedown",p)),[p]);const P=Array.isArray(l)?l.filter(t=>(typeof t=="string"?t:String(t)).toLowerCase().includes(_.toLowerCase())):[];return e.jsxs(e.Fragment,{children:[e.jsxs("div",{ref:f,onBlur:w,className:c("multiselect",`${i&&"focus"}`,`${j&&!i&&"error"}`),children:[e.jsxs("div",{className:c("multiselect-wrapper"),onClick:()=>u(!i),tabIndex:0,children:[e.jsx("div",{className:c("multiselect-input","truncate"),children:s&&s.length>0?s.map(t=>e.jsxs("div",{className:c("multiselect-input__item"),children:[t,e.jsx(U,{onClick:r=>N(t,r)})]},t)):e.jsx("span",{className:c("multiselect-placeholder"),children:g})}),i?e.jsx(A,{className:"cursor-pointer",onClick:()=>u(!1)}):e.jsx($,{className:"cursor-pointer",onClick:()=>u(!0)})]}),i&&e.jsxs("div",{className:c("multiselect-select"),onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:c("multiselect-scroll","scrollbar scrollbar-thumb-gray-600 scrollbar-thumb-rounded-md scrollbar-w-1"),children:[d&&e.jsx("div",{className:c("multiselect-select__search"),children:e.jsxs("div",{className:c("multiselect-select__search-wrapper"),children:[e.jsx(V,{}),e.jsx("input",{tabIndex:0,className:c("multiselect-select__search-input"),value:_,onChange:t=>a(t.target.value),placeholder:x,autoComplete:"off"})]})}),e.jsx("div",{className:c("multiselect-select__subtitle"),children:b}),P.length>0?P.map((t,r)=>e.jsx("div",{tabIndex:0,className:c("multiselect-select__item"),onClick:h=>{h.stopPropagation(),F(t)},children:e.jsxs("div",{className:c("multiselect-select__item-title"),children:[e.jsx("input",{type:"checkbox",id:`${t}-${r}`,className:c("checkbox"),checked:m.includes(t),onChange:()=>F(t),onClick:h=>h.stopPropagation()}),e.jsx("label",{htmlFor:`${t}-${r}`,onClick:h=>h.stopPropagation(),children:t})]})},r)):e.jsx("p",{className:c("multiselect-select__search-no-result"),children:z})]}),e.jsx("div",{className:c("multiselect-select__button"),children:e.jsx("button",{type:"button",className:c("multiselect-select__button-item"),onClick:t=>{t.stopPropagation(),o==null||o(m),u(!1)},children:y("apply")})})]})]}),j&&!i&&e.jsx(S,{error:j})]})},ce=()=>{const{values:l,setFieldValue:g,errors:o,touched:s,setFieldTouched:d,validateField:x}=O(),[z,b]=n.useState([]),[k,j]=n.useState(!0),[y,T]=n.useState(null);n.useEffect(()=>{(async()=>{try{j(!0),T(null);const a=await fetch("/api/dropdowns/mortgage_step2/he");if(!a.ok)throw new Error(`HTTP ${a.status}: ${a.statusText}`);const m=await a.json(),C=[];Object.keys(m.options).forEach(p=>{if(p.includes("citizenship")&&p!=="mortgage_step2_citizenship"){const w=m.options[p];Array.isArray(w)&&w.length>0&&C.push(...w)}});const f=C.filter((p,w,F)=>F.findIndex(N=>N.value===p.value)===w);b(f),console.log("✅ Citizenship options loaded:",f.length,"options")}catch(a){console.error("❌ Error fetching citizenship options:",a),T(a instanceof Error?a.message:"Unknown error")}finally{j(!1)}})()},[]);const i=_=>{console.log("=== Citizenship Change Debug ==="),console.log("Selected labels:",_),console.log("Current Formik values BEFORE update:",l),console.log("Current citizenshipsDropdown BEFORE:",l.citizenshipsDropdown),console.log("Formik errors BEFORE:",o),console.log("Formik touched BEFORE:",s),g("citizenshipsDropdown",_,!0),d("citizenshipsDropdown",!0,!0),setTimeout(()=>{console.log("=== After Update (delayed) ==="),console.log("Formik values AFTER:",l),console.log("citizenshipsDropdown AFTER:",l.citizenshipsDropdown),console.log("Formik errors AFTER:",o),x("citizenshipsDropdown")},100)};if(k)return e.jsxs(E,{gap:"16px",children:[e.jsx(D,{title:"אזרחות"}),e.jsx("div",{children:"Loading citizenship options..."})]});if(y)return e.jsxs(E,{gap:"16px",children:[e.jsx(D,{title:"אזרחות"}),e.jsxs("div",{children:["Error loading citizenship options: ",y]})]});const u=l.citizenshipsDropdown||[];return console.log("=== CitizenshipsDropdown Render ==="),console.log("Current form values.citizenshipsDropdown:",l.citizenshipsDropdown),console.log("Display values:",u),console.log("Citizenship options:",z.length),console.log("Touched:",s.citizenshipsDropdown),console.log("Error:",o.citizenshipsDropdown),console.log("Current language:",typeof window<"u"&&window.i18next?window.i18next.language:"unknown"),console.log("Document language:",typeof document<"u"?document.documentElement.lang:"unknown"),e.jsxs(E,{gap:"16px",children:[e.jsx(D,{title:"אזרחות"}),e.jsx(M,{data:z.map(_=>_.label),value:u,onChange:i,onBlur:()=>d("citizenshipsDropdown",!0),placeholder:"בחר אזרחות",searchable:!0,searchPlaceholder:"חפש מדינה...",searchDescription:"בחר אזרחויות נוספות ולחץ על 'החל'",nothingFoundText:"לא נמצאו תוצאות",error:s.citizenshipsDropdown&&o.citizenshipsDropdown})]})},ie=()=>{const{getContent:l}=I("mortgage_step2"),{values:g,setFieldValue:o,errors:s,touched:d,setFieldTouched:x}=O(),z=["ישראל","ארצות הברית","רוסיה","גרמניה","צרפת","בריטניה","קנדה","אוסטרליה","איטליה","ספרד","הולנד","בלגיה","שוויץ","אוסטריה","שוודיה","נורווגיה","דנמרק","פינלנד","פולין","צ'כיה","הונגריה","רומניה","בולגריה","יוון","קפריסין","פורטוגל","אירלנד","לוקסמבורג","מלטה","סלובקיה","סלובניה","קרואטיה","ליטא","לטביה","אסטוניה","אוקראינה","בלרוס","מולדובה","ארגנטינה","ברזיל","צ'ילה","מקסיקו","יפן","דרום קוריאה","סין","הודו","תאילנד","סינגפור","מלזיה","פיליפינים","אינדונזיה","וייטנאם","דרום אפריקה","מרוקו","מצרים","טורקיה","אחר"];return e.jsxs(E,{children:[e.jsx(D,{title:l("calculate_mortgage_tax","calculate_mortgage_tax")}),e.jsx(M,{data:z,placeholder:l("calculate_mortgage_citizenship_ph","calculate_mortgage_citizenship_ph"),searchable:!0,searchPlaceholder:l("search","search"),nothingFoundText:l("nothing_found","nothing_found"),searchDescription:l("countries","countries"),value:g.countriesPayTaxes,onChange:b=>o("countriesPayTaxes",b),onBlur:()=>x("countriesPayTaxes",!0),error:d.countriesPayTaxes&&s.countriesPayTaxes})]})},re=()=>{const{getContent:l}=I("mortgage_step2"),{values:g,setFieldValue:o,errors:s,touched:d}=O();return e.jsxs(E,{children:[e.jsx(H,{name:"HowManyBorrowers",handleChange:x=>o("howMuchChildrens",x),title:l("calculate_mortgage_how_much_childrens","calculate_mortgage_how_much_childrens"),placeholder:"0",disableCurrency:!0,value:g.howMuchChildrens,error:s.howMuchChildrens}),d.howMuchChildrens&&s.howMuchChildrens&&e.jsx(S,{error:s.howMuchChildrens})]})};export{ce as C,re as H,ie as a};
