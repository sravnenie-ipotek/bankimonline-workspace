<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTrack Reports Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 30px 40px;
            position: relative;
        }

        .header-content {
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        .header-text {
            text-align: center;
            flex: 1;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .language-selector {
            position: absolute;
            top: 0;
            right: 0;
        }

        .language-dropdown {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: white;
            padding: 8px 12px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .language-dropdown:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.4);
            transform: translateY(-2px);
        }

        .language-dropdown option {
            background: #2c3e50;
            color: white;
            padding: 5px;
        }

        .stats-bar {
            background: #f8f9fa;
            padding: 20px 40px;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 20px;
        }

        .stat-item {
            text-align: center;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            min-width: 120px;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #6c757d;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .controls {
            padding: 30px 40px;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
        }

        .controls-row {
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        .filter-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .filter-group label {
            font-weight: 600;
            color: #495057;
            min-width: 80px;
        }

        select, input {
            padding: 8px 12px;
            border: 2px solid #dee2e6;
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.2s;
        }

        select:focus, input:focus {
            outline: none;
            border-color: #007bff;
        }

        .search-box {
            flex: 1;
            max-width: 300px;
        }

        .status-filter {
            min-width: 200px;
        }

        .clear-filters {
            padding: 8px 16px;
            background: #6c757d;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: background-color 0.2s;
        }

        .clear-filters:hover {
            background: #545b62;
        }

        .view-toggle {
            display: flex;
            background: white;
            border-radius: 6px;
            overflow: hidden;
            border: 2px solid #dee2e6;
        }

        .view-toggle button {
            padding: 8px 16px;
            border: none;
            background: transparent;
            cursor: pointer;
            transition: all 0.2s;
        }

        .view-toggle button.active {
            background: #007bff;
            color: white;
        }

        .reports-container {
            padding: 40px;
            min-height: 600px;
        }

        .reports-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
            gap: 25px;
        }

        .reports-table {
            display: none;
            overflow-x: auto;
        }

        .report-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
            border-left: 5px solid;
        }

        .report-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
        }

        .report-card.ignored {
            opacity: 0.6;
            border-left-color: #6c757d !important;
        }

        .report-card.ignored .report-header {
            background: #f1f3f4;
        }

        .report-header {
            padding: 20px;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
        }

        .report-id {
            font-size: 1.1rem;
            font-weight: bold;
            color: #495057;
            margin-bottom: 8px;
        }

        .report-title {
            font-size: 0.95rem;
            color: #6c757d;
            line-height: 1.4;
        }

        .report-body {
            padding: 20px;
        }

        .status-badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 15px;
        }

        .status-done {
            background: #d4edda;
            color: #155724;
            border-left-color: #28a745;
        }

        .status-not-done {
            background: #f8d7da;
            color: #721c24;
            border-left-color: #dc3545;
        }

        .status-pending {
            background: #fff3cd;
            color: #856404;
            border-left-color: #ffc107;
        }

        .status-complete {
            background: #cce5ff;
            color: #004085;
            border-left-color: #007bff;
        }

        .status-default {
            background: #e9ecef;
            color: #495057;
            border-left-color: #6c757d;
        }

        .report-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        .detail-item {
            display: flex;
            flex-direction: column;
        }

        .detail-label {
            font-size: 0.8rem;
            color: #6c757d;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 4px;
        }

        .detail-value {
            font-weight: 600;
            color: #495057;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 15px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #28a745, #20c997);
            transition: width 0.3s ease;
        }

        .quality-score {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
        }

        .score-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.9rem;
            color: white;
        }

        .report-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .btn {
            padding: 6px 12px;
            border: none;
            border-radius: 4px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary {
            background: #007bff;
            color: white;
        }

        .btn-primary:hover {
            background: #0056b3;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #545b62;
        }

        .no-results {
            text-align: center;
            padding: 60px 20px;
            color: #6c757d;
        }

        .no-results h3 {
            font-size: 1.5rem;
            margin-bottom: 10px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        }

        th {
            background: #f8f9fa;
            padding: 15px;
            text-align: left;
            font-weight: 600;
            color: #495057;
            border-bottom: 2px solid #dee2e6;
        }

        td {
            padding: 15px;
            border-bottom: 1px solid #dee2e6;
            vertical-align: top;
        }

        tr:hover {
            background: #f8f9fa;
        }

        .loading {
            text-align: center;
            padding: 60px 20px;
            color: #6c757d;
        }

        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #007bff;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Security Analysis Styles */
        .tabs-container {
            background: #f8f9fa;
            border-bottom: 2px solid #dee2e6;
            padding: 0;
        }

        .tabs {
            display: flex;
            margin: 0;
            padding: 0 40px;
            list-style: none;
        }

        .tab {
            padding: 15px 25px;
            cursor: pointer;
            background: transparent;
            border: none;
            font-size: 1rem;
            font-weight: 500;
            color: #6c757d;
            border-bottom: 3px solid transparent;
            transition: all 0.2s;
            margin-right: 10px;
        }

        .tab:hover {
            color: #495057;
        }

        .tab.active {
            color: #007bff;
            border-bottom-color: #007bff;
            background: white;
        }

        .security-container {
            display: none;
            padding: 40px;
            min-height: 600px;
        }

        .security-score-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            padding: 30px;
            margin-bottom: 30px;
            text-align: center;
        }

        .security-score {
            font-size: 4rem;
            font-weight: bold;
            margin: 20px 0;
        }

        .score-excellent { color: #28a745; }
        .score-good { color: #17a2b8; }
        .score-fair { color: #ffc107; }
        .score-poor { color: #fd7e14; }
        .score-critical { color: #dc3545; }

        .security-categories {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .security-category {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            padding: 25px;
            border-left: 5px solid;
        }

        .category-critical { border-left-color: #dc3545; }
        .category-high { border-left-color: #fd7e14; }
        .category-medium { border-left-color: #ffc107; }
        .category-low { border-left-color: #17a2b8; }

        .category-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .category-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #495057;
        }

        .category-count {
            background: #e9ecef;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: 600;
        }

        .security-issue {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            border: 1px solid #dee2e6;
        }

        .issue-title {
            font-weight: 600;
            color: #495057;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .issue-description {
            color: #6c757d;
            font-size: 0.9rem;
            margin-bottom: 10px;
            line-height: 1.5;
        }

        .issue-location {
            font-family: 'Courier New', monospace;
            background: #e9ecef;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 0.85rem;
            margin-bottom: 10px;
            overflow-x: auto;
        }

        .issue-remediation {
            background: #cce5ff;
            border: 1px solid #b8daff;
            border-radius: 4px;
            padding: 10px;
            font-size: 0.85rem;
            color: #004085;
        }

        .security-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .summary-item {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            padding: 20px;
            text-align: center;
        }

        .summary-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .summary-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .summary-label {
            color: #6c757d;
            font-size: 0.9rem;
        }

        .security-chart {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            padding: 25px;
            margin-bottom: 30px;
        }

        .chart-container {
            height: 300px;
            position: relative;
        }

        /* Architecture Styles */
        .architecture-container {
            display: none;
            padding: 40px;
            min-height: 600px;
        }

        .architecture-header {
            text-align: center;
            margin-bottom: 30px;
            position: relative;
        }

        .architecture-header h2 {
            font-size: 2.5rem;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .architecture-header p {
            font-size: 1.1rem;
            color: #6c757d;
            margin-bottom: 20px;
        }

        .architecture-controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 15px;
        }

        .zoom-btn, .print-btn {
            background: white;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            padding: 8px 12px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 45px;
            height: 38px;
        }

        .zoom-btn:hover, .print-btn:hover {
            border-color: #007bff;
            background: #f8f9ff;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 123, 255, 0.15);
        }

        .zoom-btn:active, .print-btn:active {
            transform: translateY(0);
        }

        .architecture-nav {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 40px;
            flex-wrap: wrap;
        }

        .arch-nav-btn {
            padding: 12px 24px;
            background: white;
            border: 2px solid #dee2e6;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 500;
            color: #495057;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .arch-nav-btn:hover {
            border-color: #007bff;
            color: #007bff;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 123, 255, 0.15);
        }

        .arch-nav-btn.active {
            background: #007bff;
            border-color: #007bff;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 123, 255, 0.3);
        }

        .architecture-view {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }

        .architecture-view.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* SVG Architecture Diagram Styles */
        .arch-title {
            font-size: 14px;
            font-weight: bold;
            fill: #2c3e50;
        }

        .arch-subtitle {
            font-size: 12px;
            fill: #495057;
        }

        .arch-tech {
            font-size: 10px;
            fill: #6c757d;
        }

        .layer-label-main {
            font-size: 16px;
            font-weight: bold;
            fill: #2c3e50;
            writing-mode: tb;
            text-orientation: mixed;
        }

        .step-number {
            font-size: 12px;
            font-weight: bold;
            fill: white;
        }

        .step-label {
            font-size: 11px;
            font-weight: 600;
            fill: #2c3e50;
        }

        .arch-layer:hover rect {
            stroke-width: 4;
            filter: url(#shadow) url(#glowEffect);
            transform: scale(1.02);
        }

        .arch-layer {
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .flow-path {
            stroke-dasharray: 0;
            animation: flowAnimation 3s infinite;
        }

        .external-connection {
            stroke-dasharray: 4,2;
        }

        .return-flow {
            stroke-dasharray: 3,3;
        }

        .progress-dot {
            filter: url(#glowEffect);
        }

        @keyframes flowAnimation {
            0% { stroke-dasharray: 0, 20; }
            50% { stroke-dasharray: 10, 10; }
            100% { stroke-dasharray: 20, 0; }
        }

        /* Zoom and Pan Functionality */
        .architecture-diagram-container {
            overflow: hidden;
            position: relative;
        }

        #architecture-diagram {
            transition: transform 0.3s ease;
            cursor: grab;
        }

        #architecture-diagram:active {
            cursor: grabbing;
        }

        /* Enhanced Tooltips */
        .arch-tooltip {
            position: absolute;
            background: rgba(44, 62, 80, 0.95);
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 500;
            opacity: 0;
            transform: translateY(10px) translateX(-50%);
            transition: all 0.3s ease;
            pointer-events: none;
            z-index: 1000;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            max-width: 200px;
            text-align: center;
        }

        .arch-tooltip.visible {
            opacity: 1;
            transform: translateY(0) translateX(-50%);
        }

        .arch-tooltip::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 5px solid transparent;
            border-right: 5px solid transparent;
            border-top: 5px solid rgba(44, 62, 80, 0.95);
        }

        /* Keyboard Navigation Help */
        .keyboard-help {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(44, 62, 80, 0.9);
            color: white;
            padding: 15px;
            border-radius: 8px;
            font-size: 11px;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }

        .keyboard-help.visible {
            opacity: 1;
        }

        .keyboard-help h4 {
            margin: 0 0 8px 0;
            font-size: 12px;
        }

        .keyboard-help ul {
            margin: 0;
            padding-left: 15px;
            list-style: none;
        }

        .keyboard-help li {
            margin: 3px 0;
        }

        .keyboard-help kbd {
            background: rgba(255, 255, 255, 0.2);
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 10px;
        }

        .architecture-diagram-container {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            margin-bottom: 30px;
            overflow-x: auto;
        }

        .architecture-legend {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        }

        .architecture-legend h3 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.3rem;
        }

        .legend-items {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px;
            border-radius: 8px;
            background: #f8f9fa;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
            flex-shrink: 0;
        }

        .legend-box {
            width: 40px;
            height: 30px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.8rem;
            color: white;
            flex-shrink: 0;
        }

        .flow-legend {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        /* Component Details Styles */
        .component-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 30px;
        }

        .component-category {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        }

        .component-category h3 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.4rem;
            border-bottom: 2px solid #e9ecef;
            padding-bottom: 10px;
        }

        .component-card {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 4px solid #007bff;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .component-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 123, 255, 0.15);
        }

        .component-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .component-header h4 {
            color: #2c3e50;
            font-size: 1.2rem;
            margin: 0;
        }

        .component-status {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .component-status.running {
            background: #d4edda;
            color: #155724;
        }

        .component-status.warning {
            background: #fff3cd;
            color: #856404;
        }

        .component-status.pending {
            background: #cce5ff;
            color: #004085;
        }

        .component-details {
            color: #495057;
            line-height: 1.6;
        }

        .component-details p {
            margin-bottom: 10px;
        }

        .component-details ul {
            margin: 10px 0 10px 20px;
        }

        .component-details li {
            margin-bottom: 5px;
        }

        /* Technology Stack Styles */
        .tech-stack-container {
            display: grid;
            gap: 30px;
        }

        .tech-layer {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        }

        .tech-layer h3 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.4rem;
            border-bottom: 2px solid #e9ecef;
            padding-bottom: 10px;
        }

        .tech-items {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .tech-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .tech-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
        }

        .tech-icon {
            font-size: 2.5rem;
            flex-shrink: 0;
        }

        .tech-info h4 {
            color: #2c3e50;
            margin-bottom: 5px;
            font-size: 1.1rem;
        }

        .tech-info p {
            color: #6c757d;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        /* Data Flow Styles */
        .data-flow-container {
            display: grid;
            gap: 30px;
        }

        .flow-section {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        }

        .flow-section h4 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.3rem;
        }

        .flow-diagram {
            display: flex;
            align-items: center;
            gap: 20px;
            overflow-x: auto;
            padding: 20px 0;
        }

        .flow-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            min-width: 120px;
        }

        .step-box {
            padding: 15px 20px;
            border-radius: 8px;
            font-weight: 600;
            color: white;
            text-align: center;
            min-width: 100px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        }

        .step-box.user {
            background: linear-gradient(135deg, #1976d2, #1565c0);
        }

        .step-box.api {
            background: linear-gradient(135deg, #ff9800, #f57c00);
        }

        .step-box.database {
            background: linear-gradient(135deg, #d32f2f, #c62828);
        }

        .step-box.external {
            background: linear-gradient(135deg, #689f38, #558b2f);
        }

        .step-text {
            font-size: 0.85rem;
            color: #6c757d;
            text-align: center;
        }

        .flow-arrow {
            font-size: 1.5rem;
            color: #6c757d;
            font-weight: bold;
        }

        .data-flow-legend {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }

        .data-flow-legend h4 {
            color: #2c3e50;
            margin-bottom: 15px;
        }

        /* Security Architecture Styles */
        .security-arch-container {
            display: grid;
            gap: 30px;
        }

        .security-layers {
            display: grid;
            gap: 25px;
        }

        .security-layer {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        }

        .security-layer h4 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .security-items {
            display: grid;
            gap: 15px;
        }

        .security-item {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid;
        }

        .security-item.implemented {
            background: #d4edda;
            border-left-color: #28a745;
        }

        .security-item.warning {
            background: #fff3cd;
            border-left-color: #ffc107;
        }

        .security-item.critical {
            background: #f8d7da;
            border-left-color: #dc3545;
        }

        .security-item.missing {
            background: #f8d7da;
            border-left-color: #dc3545;
        }

        .status-icon {
            font-size: 1.2rem;
            flex-shrink: 0;
            margin-top: 2px;
        }

        .security-item div {
            flex: 1;
        }

        .security-item strong {
            display: block;
            margin-bottom: 5px;
            color: #2c3e50;
        }

        .security-item p {
            color: #495057;
            font-size: 0.9rem;
            line-height: 1.4;
            margin: 0;
        }

        .security-recommendations {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        }

        .security-recommendations h4 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.3rem;
        }

        .recommendations-list {
            display: grid;
            gap: 15px;
        }

        .recommendation {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid;
        }

        .recommendation.critical {
            background: #f8d7da;
            border-left-color: #dc3545;
        }

        .recommendation.high {
            background: #fff3cd;
            border-left-color: #ffc107;
        }

        .priority {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
            background: #dc3545;
            color: white;
            flex-shrink: 0;
            margin-top: 2px;
        }

        .recommendation.high .priority {
            background: #ffc107;
            color: #212529;
        }

        .recommendation div {
            flex: 1;
        }

        .recommendation strong {
            display: block;
            margin-bottom: 5px;
            color: #2c3e50;
        }

        .recommendation p {
            color: #495057;
            font-size: 0.9rem;
            line-height: 1.4;
            margin: 0;
        }

        /* Deployment Architecture Styles */
        .deployment-container {
            display: grid;
            gap: 30px;
        }

        .environment-section {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        }

        .environment-section h4 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .env-details {
            display: grid;
            gap: 12px;
        }

        .env-item {
            padding: 12px 15px;
            background: #f8f9fa;
            border-radius: 6px;
            border-left: 4px solid #007bff;
        }

        .deployment-diagram {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        }

        .deployment-diagram h4 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.3rem;
        }

        .pipeline-steps {
            display: flex;
            align-items: center;
            gap: 20px;
            overflow-x: auto;
            padding: 20px 0;
        }

        .pipeline-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            min-width: 120px;
        }

        .step-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #007bff, #0056b3);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
            box-shadow: 0 4px 12px rgba(0, 123, 255, 0.3);
        }

        .step-title {
            font-weight: 600;
            color: #2c3e50;
            text-align: center;
        }

        .step-desc {
            font-size: 0.85rem;
            color: #6c757d;
            text-align: center;
        }

        .pipeline-arrow {
            font-size: 1.5rem;
            color: #6c757d;
            font-weight: bold;
        }

        .deployment-config {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        }

        .deployment-config h4 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.3rem;
        }

        .config-section h5 {
            color: #495057;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .config-list {
            display: grid;
            gap: 10px;
        }

        .config-item {
            padding: 12px 15px;
            background: #f8f9fa;
            border-radius: 6px;
            border-left: 4px solid #28a745;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
        }

        .config-item code {
            font-weight: bold;
            color: #d63384;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
            }

            .header {
                padding: 20px;
            }

            .header h1 {
                font-size: 2rem;
            }

            .controls {
                padding: 20px;
            }

            .controls-row {
                flex-direction: column;
                align-items: stretch;
            }

            .reports-container {
                padding: 20px;
            }

            .reports-grid {
                grid-template-columns: 1fr;
            }

            .stats-bar {
                padding: 15px 20px;
            }

            .report-details {
                grid-template-columns: 1fr;
            }

            .tabs {
                padding: 0 20px;
                overflow-x: auto;
            }

            .security-categories {
                grid-template-columns: 1fr;
            }

            .architecture-container {
                padding: 20px;
            }

            .architecture-header {
                text-align: center;
            }

            .architecture-header h2 {
                font-size: 1.8rem;
            }

            .architecture-controls {
                flex-wrap: wrap;
                gap: 8px;
            }

            .zoom-btn, .print-btn {
                min-width: 40px;
                font-size: 0.9rem;
            }

            .architecture-nav {
                flex-direction: column;
                align-items: center;
            }

            .arch-nav-btn {
                width: 100%;
                max-width: 250px;
                font-size: 0.85rem;
                padding: 10px 20px;
            }

            .component-grid {
                grid-template-columns: 1fr;
            }

            .tech-items {
                grid-template-columns: 1fr;
            }

            #architecture-diagram {
                height: 500px;
            }

            .layer-label-main {
                font-size: 12px;
                writing-mode: horizontal-tb;
                text-orientation: mixed;
            }

            .step-label {
                display: none; /* Hide step labels on mobile to reduce clutter */
            }

            .keyboard-help {
                display: none; /* Hide keyboard help on mobile */
            }

            .arch-tooltip {
                font-size: 11px;
                padding: 6px 8px;
                max-width: 150px;
            }

            .flow-legend {
                grid-template-columns: 1fr;
            }

            .legend-items {
                grid-template-columns: 1fr;
            }

            /* Touch-friendly improvements */
            .arch-layer {
                touch-action: manipulation;
            }

            .zoom-btn, .print-btn {
                touch-action: manipulation;
                padding: 12px;
            }

            .flow-diagram {
                flex-direction: column;
                align-items: stretch;
            }

            .flow-step {
                width: 100%;
            }

            .flow-arrow {
                transform: rotate(90deg);
                align-self: center;
            }

            .pipeline-steps {
                flex-direction: column;
                align-items: stretch;
            }

            .pipeline-step {
                width: 100%;
            }

            .pipeline-arrow {
                transform: rotate(90deg);
                align-self: center;
            }

            .legend-items {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <div class="header-text">
                    <h1 data-i18n="dashboard.title">YouTrack Reports Dashboard</h1>
                    <p data-i18n="dashboard.subtitle">Comprehensive overview of project issues and implementation status</p>
                    <p style="font-size: 0.9rem; margin-top: 5px; opacity: 0.9;" data-i18n="dashboard.loading">📁 Loading from youtrackReports/ folder with range-based files</p>
                    <div id="files-loaded" style="margin-top: 10px; font-size: 0.9rem; opacity: 0.8;"></div>
                </div>
                <div class="language-selector">
                    <select id="language-select" class="language-dropdown" onchange="changeLanguage(this.value)">
                        <option value="en">🇺🇸 English</option>
                        <option value="ru">🇷🇺 Русский</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="tabs-container">
            <ul class="tabs">
                <li class="tab active" onclick="switchTab('reports')" data-i18n="tabs.reports">Reports</li>
                <li class="tab" onclick="switchTab('security')" data-i18n="tabs.security">Security Analysis</li>
                <li class="tab" onclick="switchTab('architecture')" data-i18n="tabs.architecture">Architecture</li>
            </ul>
        </div>

        <div class="stats-bar" id="reports-stats">
            <div class="stat-item">
                <div class="stat-number" id="total-issues">-</div>
                <div class="stat-label">Total Issues</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="done-issues" style="color: #28a745;">-</div>
                <div class="stat-label">Completed</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="pending-issues" style="color: #ffc107;">-</div>
                <div class="stat-label">Pending</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="not-done-issues" style="color: #dc3545;">-</div>
                <div class="stat-label">Not Done</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="ignored-issues" style="color: #6c757d;">-</div>
                <div class="stat-label">Ignored</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="completion-rate" style="color: #007bff;">-</div>
                <div class="stat-label">Completion Rate</div>
            </div>
        </div>

        <div class="controls" id="reports-controls">
            <div class="controls-row">
                <div class="filter-group">
                    <label for="status-filter">Status:</label>
                    <select id="status-filter" class="status-filter">
                        <option value="">All Statuses</option>
                        <optgroup label="Completed">
                            <option value="done">✅ Done</option>
                            <option value="✅ done">✅ Done</option>
                            <option value="✅ PERFECTLY DONE">✅ Perfectly Done</option>
                            <option value="✅ FULLY IMPLEMENTED">✅ Fully Implemented</option>
                            <option value="substantially_complete">📋 Substantially Complete</option>
                        </optgroup>
                        <optgroup label="Not Done">
                            <option value="❌ not done">❌ Not Done</option>
                            <option value="⚠️ NOT FOUND">⚠️ Not Found</option>
                        </optgroup>
                        <optgroup label="Partially Done">
                            <option value="🔶 PARTIALLY IMPLEMENTED">🔶 Partially Implemented</option>
                            <option value="⚠️ MOSTLY IMPLEMENTED">⚠️ Mostly Implemented</option>
                            <option value="⚠️ MOSTLY DONE">⚠️ Mostly Done</option>
                        </optgroup>
                        <optgroup label="Critical">
                            <option value="🔴 CRITICAL GAPS">🔴 Critical Gaps</option>
                        </optgroup>
                        <optgroup label="Other">
                            <option value="⚠️ BACKEND TASK">⚠️ Backend Task</option>
                            <option value="⚠️ REQUIRES INVESTIGATION">⚠️ Requires Investigation</option>
                        </optgroup>
                    </select>
                </div>

                <div class="filter-group">
                    <label for="search-box">Search:</label>
                    <input type="text" id="search-box" class="search-box" placeholder="Search issues, titles, or descriptions...">
                </div>

                <div class="filter-group">
                    <label for="source-filter">Source:</label>
                    <select id="source-filter">
                        <option value="">All Sources</option>
                        <!-- Options will be populated dynamically -->
                    </select>
                </div>

                <div class="filter-group">
                    <label for="ignore-filter">Show:</label>
                    <select id="ignore-filter">
                        <option value="">All Issues</option>
                        <option value="false">Active Issues Only</option>
                        <option value="true">Ignored Issues Only</option>
                    </select>
                </div>

                <button class="clear-filters" onclick="clearFilters()">Clear Filters</button>

                <div class="view-toggle">
                    <button id="grid-view" class="active" onclick="setView('grid')">Grid View</button>
                    <button id="table-view" onclick="setView('table')">Table View</button>
                </div>
            </div>
        </div>

        <div class="reports-container" id="reports-content">
            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>Loading YouTrack reports...</p>
            </div>

            <div class="reports-grid" id="reports-grid" style="display: none;"></div>
            
            <div class="reports-table" id="reports-table">
                <table>
                    <thead>
                        <tr>
                            <th>Issue ID</th>
                            <th>Title</th>
                            <th>Status</th>
                            <th>Actions</th>
                            <th>Quality Score</th>
                            <th>Last Updated</th>
                            <th>Source</th>
                            <th>Ignored</th>
                        </tr>
                    </thead>
                    <tbody id="table-body"></tbody>
                </table>
            </div>

            <div class="no-results" id="no-results" style="display: none;">
                <h3>No reports found</h3>
                <p>Try adjusting your filters or search criteria</p>
            </div>
        </div>

        <!-- Security Analysis Container -->
        <div class="security-container" id="security-content">
            <div class="loading" id="security-loading">
                <div class="spinner"></div>
                <p>Performing comprehensive security analysis...</p>
            </div>

            <div id="security-results" style="display: none;">
                <!-- Security Score Card -->
                <div class="security-score-card">
                    <h2>Security Score</h2>
                    <div class="security-score" id="security-score">-</div>
                    <p id="security-grade">Analyzing...</p>
                    <div class="progress-bar" style="max-width: 300px; margin: 20px auto;">
                        <div class="progress-fill" id="security-progress" style="width: 0%"></div>
                    </div>
                </div>

                <!-- Security Summary -->
                <div class="security-summary" id="security-summary">
                    <div class="summary-item">
                        <div class="summary-icon">🔴</div>
                        <div class="summary-value" id="critical-count">0</div>
                        <div class="summary-label">Critical Issues</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-icon">🟠</div>
                        <div class="summary-value" id="high-count">0</div>
                        <div class="summary-label">High Risk</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-icon">🟡</div>
                        <div class="summary-value" id="medium-count">0</div>
                        <div class="summary-label">Medium Risk</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-icon">🔵</div>
                        <div class="summary-value" id="low-count">0</div>
                        <div class="summary-label">Low Risk</div>
                    </div>
                </div>

                <!-- Security Chart -->
                <div class="security-chart">
                    <h3>Security Issues Distribution</h3>
                    <div class="chart-container">
                        <canvas id="security-chart"></canvas>
                    </div>
                </div>

                <!-- Security Categories -->
                <div class="security-categories" id="security-categories">
                    <!-- Categories will be populated dynamically -->
                </div>
            </div>
        </div>

        <!-- Architecture Container -->
        <div class="architecture-container" id="architecture-content" style="display: none;">
            <div class="architecture-header">
                <h2 data-i18n="architecture.title">bankDev2_standalone Application Architecture</h2>
                <p data-i18n="architecture.subtitle">Interactive system architecture diagram with detailed component information</p>
                <div class="architecture-controls">
                    <button class="zoom-btn" onclick="zoomDiagram('in')" title="Zoom In">🔍+</button>
                    <button class="zoom-btn" onclick="zoomDiagram('out')" title="Zoom Out">🔍-</button>
                    <button class="zoom-btn" onclick="resetZoom()" title="Reset Zoom">🎯</button>
                    <button class="print-btn" onclick="printArchitecture()" title="Print Architecture">🖨️</button>
                </div>
            </div>

            <!-- Architecture Navigation -->
            <div class="architecture-nav">
                <button class="arch-nav-btn active" onclick="showArchitectureView('overview')" data-i18n="architecture.nav.overview">System Overview</button>
                <button class="arch-nav-btn" onclick="showArchitectureView('components')" data-i18n="architecture.nav.components">Component Details</button>
                <button class="arch-nav-btn" onclick="showArchitectureView('tech-stack')" data-i18n="architecture.nav.techStack">Technology Stack</button>
                <button class="arch-nav-btn" onclick="showArchitectureView('data-flow')" data-i18n="architecture.nav.dataFlow">Data Flow</button>
                <button class="arch-nav-btn" onclick="showArchitectureView('security')" data-i18n="architecture.nav.security">Security Architecture</button>
                <button class="arch-nav-btn" onclick="showArchitectureView('deployment')" data-i18n="architecture.nav.deployment">Deployment</button>
            </div>

            <!-- Architecture Views -->
            <div id="arch-overview" class="architecture-view active">
                <div class="architecture-diagram-container" id="diagram-container">
                    <svg id="architecture-diagram" width="100%" height="700" viewBox="0 0 1400 700">
                        <!-- Background and Definitions -->
                        <defs>
                            <linearGradient id="bgGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" style="stop-color:#f8f9fa;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#e9ecef;stop-opacity:1" />
                            </linearGradient>
                            <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
                                <feDropShadow dx="3" dy="3" stdDeviation="4" flood-color="#00000030"/>
                            </filter>
                            <filter id="glowEffect">
                                <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
                                <feMerge> 
                                    <feMergeNode in="coloredBlur"/>
                                    <feMergeNode in="SourceGraphic"/>
                                </feMerge>
                            </filter>
                            <marker id="arrowhead" markerWidth="12" markerHeight="10" refX="11" refY="5" orient="auto" markerUnits="strokeWidth">
                                <polygon points="0 0, 12 5, 0 10" fill="#2c3e50"/>
                            </marker>
                            <marker id="arrowhead-flow" markerWidth="10" markerHeight="8" refX="9" refY="4" orient="auto">
                                <polygon points="0 0, 10 4, 0 8" fill="#e74c3c"/>
                            </marker>
                        </defs>
                        
                        <rect width="100%" height="100%" fill="url(#bgGradient)"/>
                        
                        <!-- Step-by-Step Flow Indicators -->
                        <g class="data-flow-steps">
                            <circle cx="250" cy="40" r="15" fill="#e74c3c" stroke="white" stroke-width="2"/>
                            <text x="250" y="45" text-anchor="middle" class="step-number">1</text>
                            <text x="270" y="45" class="step-label" data-i18n="architecture.steps.user_request">User Request</text>
                            
                            <circle cx="400" cy="140" r="15" fill="#e74c3c" stroke="white" stroke-width="2"/>
                            <text x="400" y="145" text-anchor="middle" class="step-number">2</text>
                            <text x="420" y="145" class="step-label" data-i18n="architecture.steps.api_routing">API Routing</text>
                            
                            <circle cx="400" cy="240" r="15" fill="#e74c3c" stroke="white" stroke-width="2"/>
                            <text x="400" y="245" text-anchor="middle" class="step-number">3</text>
                            <text x="420" y="245" class="step-label" data-i18n="architecture.steps.business_logic">Business Logic</text>
                            
                            <circle cx="400" cy="340" r="15" fill="#e74c3c" stroke="white" stroke-width="2"/>
                            <text x="400" y="345" text-anchor="middle" class="step-number">4</text>
                            <text x="420" y="345" class="step-label" data-i18n="architecture.steps.data_access">Data Access</text>
                            
                            <circle cx="250" cy="440" r="15" fill="#e74c3c" stroke="white" stroke-width="2"/>
                            <text x="250" y="445" text-anchor="middle" class="step-number">5</text>
                            <text x="270" y="445" class="step-label" data-i18n="architecture.steps.response">Response</text>
                        </g>

                        <!-- Layer Background Sections -->
                        <rect x="80" y="70" width="1000" height="80" rx="5" fill="#f8f9fa" stroke="#e9ecef" stroke-dasharray="3,3" opacity="0.3"/>
                        <rect x="80" y="180" width="1000" height="80" rx="5" fill="#fff3e0" stroke="#ffcc02" stroke-dasharray="3,3" opacity="0.3"/>
                        <rect x="80" y="290" width="1000" height="120" rx="5" fill="#f3e5f5" stroke="#9c27b0" stroke-dasharray="3,3" opacity="0.3"/>
                        <rect x="80" y="440" width="1000" height="80" rx="5" fill="#ffebee" stroke="#d32f2f" stroke-dasharray="3,3" opacity="0.3"/>
                        <rect x="80" y="550" width="1000" height="120" rx="5" fill="#e0f2f1" stroke="#00796b" stroke-dasharray="3,3" opacity="0.3"/>

                        <!-- Layer Labels with improved styling -->
                        <text x="30" y="25" class="layer-label-main" data-i18n="architecture.layers.presentation">Presentation Layer</text>
                        <text x="30" y="125" class="layer-label-main" data-i18n="architecture.layers.api">API Gateway Layer</text>
                        <text x="30" y="225" class="layer-label-main" data-i18n="architecture.layers.business">Business Logic Layer</text>
                        <text x="30" y="385" class="layer-label-main" data-i18n="architecture.layers.data">Data Access Layer</text>
                        <text x="30" y="500" class="layer-label-main" data-i18n="architecture.layers.infrastructure">Infrastructure Layer</text>
                        
                        <!-- PRESENTATION LAYER -->
                        <g class="arch-layer" data-layer="presentation" data-tooltip="React-based frontend with TypeScript">
                            <rect x="200" y="80" width="220" height="70" rx="12" fill="#e3f2fd" stroke="#1976d2" stroke-width="3" filter="url(#shadow)"/>
                            <text x="310" y="105" text-anchor="middle" class="arch-title">Web Application</text>
                            <text x="310" y="125" text-anchor="middle" class="arch-subtitle">React + TypeScript</text>
                            <text x="310" y="140" text-anchor="middle" class="arch-tech">Vite Build System</text>
                        </g>

                        <g class="arch-layer" data-layer="presentation" data-tooltip="Mobile-responsive PWA interface">
                            <rect x="450" y="80" width="220" height="70" rx="12" fill="#e8f5e8" stroke="#4caf50" stroke-width="3" filter="url(#shadow)"/>
                            <text x="560" y="105" text-anchor="middle" class="arch-title">Mobile Interface</text>
                            <text x="560" y="125" text-anchor="middle" class="arch-subtitle">Responsive Design</text>
                            <text x="560" y="140" text-anchor="middle" class="arch-tech">PWA Ready</text>
                        </g>

                        <!-- API GATEWAY LAYER -->
                        <g class="arch-layer" data-layer="api" data-tooltip="Express.js API server with authentication">
                            <rect x="300" y="190" width="300" height="70" rx="12" fill="#fff3e0" stroke="#ff9800" stroke-width="3" filter="url(#shadow)"/>
                            <text x="450" y="215" text-anchor="middle" class="arch-title">API Gateway</text>
                            <text x="450" y="235" text-anchor="middle" class="arch-subtitle">Express.js + CORS</text>
                            <text x="450" y="250" text-anchor="middle" class="arch-tech">Authentication & Routing</text>
                        </g>

                        <!-- BUSINESS LOGIC LAYER -->
                        <g class="arch-layer" data-layer="business" data-tooltip="Authentication and user management">
                            <rect x="120" y="300" width="180" height="90" rx="12" fill="#f3e5f5" stroke="#9c27b0" stroke-width="3" filter="url(#shadow)"/>
                            <text x="210" y="325" text-anchor="middle" class="arch-title">Auth Service</text>
                            <text x="210" y="345" text-anchor="middle" class="arch-subtitle">JWT + OTP</text>
                            <text x="210" y="365" text-anchor="middle" class="arch-tech">SMS & Email</text>
                            <text x="210" y="380" text-anchor="middle" class="arch-tech">Verification</text>
                        </g>

                        <g class="arch-layer" data-layer="business" data-tooltip="Core banking operations and business logic">
                            <rect x="320" y="300" width="180" height="90" rx="12" fill="#e1f5fe" stroke="#0288d1" stroke-width="3" filter="url(#shadow)"/>
                            <text x="410" y="325" text-anchor="middle" class="arch-title">Core API</text>
                            <text x="410" y="345" text-anchor="middle" class="arch-subtitle">Business Logic</text>
                            <text x="410" y="365" text-anchor="middle" class="arch-tech">CRUD Operations</text>
                            <text x="410" y="380" text-anchor="middle" class="arch-tech">Data Validation</text>
                        </g>

                        <g class="arch-layer" data-layer="business" data-tooltip="File and document management system">
                            <rect x="520" y="300" width="180" height="90" rx="12" fill="#e8f5e8" stroke="#388e3c" stroke-width="3" filter="url(#shadow)"/>
                            <text x="610" y="325" text-anchor="middle" class="arch-title">File Service</text>
                            <text x="610" y="345" text-anchor="middle" class="arch-subtitle">Document Mgmt</text>
                            <text x="610" y="365" text-anchor="middle" class="arch-tech">Static Assets</text>
                            <text x="610" y="380" text-anchor="middle" class="arch-tech">Upload/Download</text>
                        </g>

                        <!-- DATA ACCESS LAYER -->
                        <g class="arch-layer" data-layer="data" data-tooltip="PostgreSQL database hosted on Railway cloud">
                            <rect x="300" y="450" width="300" height="70" rx="12" fill="#ffebee" stroke="#d32f2f" stroke-width="3" filter="url(#shadow)"/>
                            <text x="450" y="475" text-anchor="middle" class="arch-title">PostgreSQL Database</text>
                            <text x="450" y="495" text-anchor="middle" class="arch-subtitle">Railway Cloud Hosting</text>
                            <text x="450" y="510" text-anchor="middle" class="arch-tech">Relational Data Store</text>
                        </g>

                        <!-- EXTERNAL SERVICES -->
                        <g class="arch-layer" data-layer="external" data-tooltip="SMS gateway for OTP delivery">
                            <rect x="750" y="190" width="180" height="70" rx="12" fill="#f1f8e9" stroke="#689f38" stroke-width="3" filter="url(#shadow)"/>
                            <text x="840" y="215" text-anchor="middle" class="arch-title">SMS Gateway</text>
                            <text x="840" y="235" text-anchor="middle" class="arch-subtitle">OTP Delivery</text>
                            <text x="840" y="250" text-anchor="middle" class="arch-tech">Third-party API</text>
                        </g>

                        <g class="arch-layer" data-layer="external" data-tooltip="Email service for notifications">
                            <rect x="750" y="300" width="180" height="70" rx="12" fill="#fce4ec" stroke="#c2185b" stroke-width="3" filter="url(#shadow)"/>
                            <text x="840" y="325" text-anchor="middle" class="arch-title">Email Service</text>
                            <text x="840" y="345" text-anchor="middle" class="arch-subtitle">SMTP Provider</text>
                            <text x="840" y="360" text-anchor="middle" class="arch-tech">Notifications</text>
                        </g>

                        <!-- INFRASTRUCTURE LAYER -->
                        <g class="arch-layer" data-layer="infrastructure" data-tooltip="Railway cloud platform for production hosting">
                            <rect x="200" y="560" width="500" height="100" rx="12" fill="#e0f2f1" stroke="#00796b" stroke-width="3" filter="url(#shadow)" stroke-dasharray="8,4"/>
                            <text x="450" y="585" text-anchor="middle" class="arch-title">Railway Cloud Platform</text>
                            <text x="450" y="605" text-anchor="middle" class="arch-subtitle">Production Hosting & CI/CD</text>
                            <text x="300" y="625" text-anchor="middle" class="arch-tech">• Auto Deploy</text>
                            <text x="450" y="625" text-anchor="middle" class="arch-tech">• SSL/TLS</text>
                            <text x="600" y="625" text-anchor="middle" class="arch-tech">• Monitoring</text>
                            <text x="300" y="645" text-anchor="middle" class="arch-tech">• Environment Vars</text>
                            <text x="450" y="645" text-anchor="middle" class="arch-tech">• Load Balancing</text>
                            <text x="600" y="645" text-anchor="middle" class="arch-tech">• Backup & Recovery</text>
                        </g>

                        <!-- Data Flow Connections with Step Numbers -->
                        <g class="arch-connections">
                            <!-- Step 1: User Request to API Gateway -->
                            <path d="M 310 150 Q 350 170 400 190" stroke="#e74c3c" stroke-width="3" fill="none" marker-end="url(#arrowhead-flow)" class="flow-path"/>
                            <path d="M 560 150 Q 520 170 480 190" stroke="#e74c3c" stroke-width="3" fill="none" marker-end="url(#arrowhead-flow)" class="flow-path"/>
                            
                            <!-- Step 2: API Gateway to Business Logic -->
                            <path d="M 400 260 Q 350 280 210 300" stroke="#e74c3c" stroke-width="3" fill="none" marker-end="url(#arrowhead-flow)" class="flow-path"/>
                            <path d="M 450 260 Q 450 280 410 300" stroke="#e74c3c" stroke-width="3" fill="none" marker-end="url(#arrowhead-flow)" class="flow-path"/>
                            <path d="M 500 260 Q 550 280 610 300" stroke="#e74c3c" stroke-width="3" fill="none" marker-end="url(#arrowhead-flow)" class="flow-path"/>
                            
                            <!-- Step 3: Business Logic to Data Layer -->
                            <path d="M 210 390 Q 280 420 350 450" stroke="#e74c3c" stroke-width="3" fill="none" marker-end="url(#arrowhead-flow)" class="flow-path"/>
                            <path d="M 410 390 Q 430 420 450 450" stroke="#e74c3c" stroke-width="3" fill="none" marker-end="url(#arrowhead-flow)" class="flow-path"/>
                            <path d="M 610 390 Q 550 420 500 450" stroke="#e74c3c" stroke-width="3" fill="none" marker-end="url(#arrowhead-flow)" class="flow-path"/>
                            
                            <!-- External Service Connections -->
                            <path d="M 600 225 Q 675 225 750 225" stroke="#27ae60" stroke-width="2" fill="none" marker-end="url(#arrowhead)" class="external-connection"/>
                            <path d="M 500 335 Q 625 335 750 335" stroke="#27ae60" stroke-width="2" fill="none" marker-end="url(#arrowhead)" class="external-connection"/>
                            
                            <!-- Infrastructure Connections (dashed) -->
                            <path d="M 450 520 Q 450 540 450 560" stroke="#00796b" stroke-width="2" fill="none" stroke-dasharray="5,5" class="infra-connection"/>
                            
                            <!-- Return Flow (Response) - lighter color -->
                            <path d="M 450 450 Q 410 430 400 390" stroke="#3498db" stroke-width="2" fill="none" stroke-dasharray="3,3" opacity="0.6" class="return-flow"/>
                            <path d="M 400 300 Q 430 280 450 260" stroke="#3498db" stroke-width="2" fill="none" stroke-dasharray="3,3" opacity="0.6" class="return-flow"/>
                            <path d="M 450 190 Q 400 170 350 150" stroke="#3498db" stroke-width="2" fill="none" stroke-dasharray="3,3" opacity="0.6" class="return-flow"/>
                        </g>
                        
                        <!-- Progress Indicators for Data Flow -->
                        <g class="progress-indicators">
                            <circle cx="350" cy="170" r="8" fill="#f39c12" opacity="0" class="progress-dot">
                                <animate attributeName="opacity" values="0;1;0" dur="2s" repeatCount="indefinite" begin="0s"/>
                            </circle>
                            <circle cx="450" cy="275" r="8" fill="#f39c12" opacity="0" class="progress-dot">
                                <animate attributeName="opacity" values="0;1;0" dur="2s" repeatCount="indefinite" begin="0.5s"/>
                            </circle>
                            <circle cx="410" cy="350" r="8" fill="#f39c12" opacity="0" class="progress-dot">
                                <animate attributeName="opacity" values="0;1;0" dur="2s" repeatCount="indefinite" begin="1s"/>
                            </circle>
                            <circle cx="450" cy="465" r="8" fill="#f39c12" opacity="0" class="progress-dot">
                                <animate attributeName="opacity" values="0;1;0" dur="2s" repeatCount="indefinite" begin="1.5s"/>
                            </circle>
                        </g>
                    </svg>
                </div>

                <div class="architecture-legend">
                    <h3 data-i18n="architecture.legend.title">System Components</h3>
                    <div class="legend-items">
                        <div class="legend-item">
                            <div class="legend-color" style="background-color: #e3f2fd; border: 2px solid #1976d2;"></div>
                            <span data-i18n="architecture.legend.frontend">Frontend Layer - User Interface</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background-color: #fff3e0; border: 2px solid #ff9800;"></div>
                            <span data-i18n="architecture.legend.api">API Layer - Request Routing</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background-color: #f3e5f5; border: 2px solid #9c27b0;"></div>
                            <span data-i18n="architecture.legend.services">Services Layer - Business Logic</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background-color: #ffebee; border: 2px solid #d32f2f;"></div>
                            <span data-i18n="architecture.legend.data">Data Layer - Persistent Storage</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background-color: #f1f8e9; border: 2px solid #689f38;"></div>
                            <span data-i18n="architecture.legend.external">External Services - Third-party APIs</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background-color: #e0f2f1; border: 2px solid #00796b; border-style: dashed;"></div>
                            <span data-i18n="architecture.legend.cloud">Cloud Infrastructure - Hosting Platform</span>
                        </div>
                    </div>
                    
                    <!-- Data Flow Legend -->
                    <h4 style="margin-top: 25px; color: #2c3e50; margin-bottom: 15px;">Data Flow Indicators</h4>
                    <div class="flow-legend">
                        <div class="legend-item">
                            <div style="width: 30px; height: 3px; background: #e74c3c; border-radius: 2px;"></div>
                            <span>Request Flow (Steps 1-4)</span>
                        </div>
                        <div class="legend-item">
                            <div style="width: 30px; height: 2px; background: #3498db; border-radius: 2px; border: 1px dashed #3498db;"></div>
                            <span>Response Flow (Step 5)</span>
                        </div>
                        <div class="legend-item">
                            <div style="width: 30px; height: 2px; background: #27ae60; border-radius: 2px; border: 1px dashed #27ae60;"></div>
                            <span>External API Calls</span>
                        </div>
                        <div class="legend-item">
                            <div style="width: 15px; height: 15px; background: #f39c12; border-radius: 50%; opacity: 0.8;"></div>
                            <span>Animated Progress Indicators</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Component Details View -->
            <div id="arch-components" class="architecture-view">
                <div class="component-grid">
                    <!-- Frontend Components -->
                    <div class="component-category">
                        <h3 data-i18n="architecture.components.frontend">Frontend Components</h3>
                        
                        <div class="component-card">
                            <div class="component-header">
                                <h4>React Application</h4>
                                <span class="component-status running">Running</span>
                            </div>
                            <div class="component-details">
                                <p><strong>Purpose:</strong> Main user interface for the banking application</p>
                                <p><strong>Technology:</strong> React 18 + TypeScript + Vite</p>
                                <p><strong>Key Features:</strong></p>
                                <ul>
                                    <li>User authentication and registration</li>
                                    <li>Dashboard with account information</li>
                                    <li>Transaction management</li>
                                    <li>Profile management</li>
                                    <li>Responsive design for mobile/desktop</li>
                                </ul>
                                <p><strong>File Location:</strong> /src/ directory</p>
                            </div>
                        </div>

                        <div class="component-card">
                            <div class="component-header">
                                <h4>State Management</h4>
                                <span class="component-status running">Active</span>
                            </div>
                            <div class="component-details">
                                <p><strong>Purpose:</strong> Manages application state and user context</p>
                                <p><strong>Technology:</strong> React Context API + useReducer</p>
                                <p><strong>Manages:</strong> User authentication, app theme, form data</p>
                            </div>
                        </div>
                    </div>

                    <!-- Backend Components -->
                    <div class="component-category">
                        <h3 data-i18n="architecture.components.backend">Backend Services</h3>
                        
                        <div class="component-card">
                            <div class="component-header">
                                <h4>Express.js API Server</h4>
                                <span class="component-status running">Running</span>
                            </div>
                            <div class="component-details">
                                <p><strong>Purpose:</strong> Main application server handling all API requests</p>
                                <p><strong>Technology:</strong> Express.js + Node.js</p>
                                <p><strong>Port:</strong> 3000 (development) / Railway (production)</p>
                                <p><strong>Key Features:</strong></p>
                                <ul>
                                    <li>RESTful API endpoints</li>
                                    <li>CORS configuration</li>
                                    <li>JWT token validation</li>
                                    <li>Request logging</li>
                                    <li>Error handling middleware</li>
                                </ul>
                                <p><strong>File:</strong> server-db.js</p>
                            </div>
                        </div>

                        <div class="component-card">
                            <div class="component-header">
                                <h4>Authentication Service</h4>
                                <span class="component-status warning">Security Review Needed</span>
                            </div>
                            <div class="component-details">
                                <p><strong>Purpose:</strong> Handles user authentication and authorization</p>
                                <p><strong>Methods:</strong></p>
                                <ul>
                                    <li>Email/Password login</li>
                                    <li>SMS OTP verification</li>
                                    <li>JWT token generation</li>
                                </ul>
                                <p><strong>Security Note:</strong> Currently has simplified validation for development</p>
                            </div>
                        </div>

                        <div class="component-card">
                            <div class="component-header">
                                <h4>Database Service</h4>
                                <span class="component-status running">Connected</span>
                            </div>
                            <div class="component-details">
                                <p><strong>Purpose:</strong> Database connection and query management</p>
                                <p><strong>Technology:</strong> PostgreSQL with pg library</p>
                                <p><strong>Connection:</strong> Railway cloud database</p>
                                <p><strong>Tables:</strong> users, accounts, transactions, otps</p>
                            </div>
                        </div>
                    </div>

                    <!-- External Services -->
                    <div class="component-category">
                        <h3 data-i18n="architecture.components.external">External Integrations</h3>
                        
                        <div class="component-card">
                            <div class="component-header">
                                <h4>SMS Gateway</h4>
                                <span class="component-status pending">Integration Pending</span>
                            </div>
                            <div class="component-details">
                                <p><strong>Purpose:</strong> Send SMS OTP codes for authentication</p>
                                <p><strong>Status:</strong> Mock implementation - always accepts 4-digit codes</p>
                                <p><strong>Required:</strong> Integration with actual SMS provider</p>
                            </div>
                        </div>

                        <div class="component-card">
                            <div class="component-header">
                                <h4>Email Service</h4>
                                <span class="component-status pending">To Be Implemented</span>
                            </div>
                            <div class="component-details">
                                <p><strong>Purpose:</strong> Send email notifications and verifications</p>
                                <p><strong>Status:</strong> Not yet implemented</p>
                                <p><strong>Planned:</strong> SMTP integration for user notifications</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Technology Stack View -->
            <div id="arch-tech-stack" class="architecture-view">
                <div class="tech-stack-container">
                    <div class="tech-layer">
                        <h3 data-i18n="architecture.tech.frontend">Frontend Technologies</h3>
                        <div class="tech-items">
                            <div class="tech-item">
                                <div class="tech-icon">⚛️</div>
                                <div class="tech-info">
                                    <h4>React 18</h4>
                                    <p>Component-based UI library with hooks</p>
                                </div>
                            </div>
                            <div class="tech-item">
                                <div class="tech-icon">🔷</div>
                                <div class="tech-info">
                                    <h4>TypeScript</h4>
                                    <p>Type-safe JavaScript development</p>
                                </div>
                            </div>
                            <div class="tech-item">
                                <div class="tech-icon">⚡</div>
                                <div class="tech-info">
                                    <h4>Vite</h4>
                                    <p>Fast build tool and development server</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="tech-layer">
                        <h3 data-i18n="architecture.tech.backend">Backend Technologies</h3>
                        <div class="tech-items">
                            <div class="tech-item">
                                <div class="tech-icon">🟢</div>
                                <div class="tech-info">
                                    <h4>Node.js</h4>
                                    <p>JavaScript runtime environment</p>
                                </div>
                            </div>
                            <div class="tech-item">
                                <div class="tech-icon">🚂</div>
                                <div class="tech-info">
                                    <h4>Express.js</h4>
                                    <p>Web application framework</p>
                                </div>
                            </div>
                            <div class="tech-item">
                                <div class="tech-icon">🔐</div>
                                <div class="tech-info">
                                    <h4>JWT</h4>
                                    <p>JSON Web Tokens for authentication</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="tech-layer">
                        <h3 data-i18n="architecture.tech.database">Database & Storage</h3>
                        <div class="tech-items">
                            <div class="tech-item">
                                <div class="tech-icon">🐘</div>
                                <div class="tech-info">
                                    <h4>PostgreSQL</h4>
                                    <p>Relational database management system</p>
                                </div>
                            </div>
                            <div class="tech-item">
                                <div class="tech-icon">🔗</div>
                                <div class="tech-info">
                                    <h4>pg (node-postgres)</h4>
                                    <p>PostgreSQL client for Node.js</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="tech-layer">
                        <h3 data-i18n="architecture.tech.infrastructure">Infrastructure & DevOps</h3>
                        <div class="tech-items">
                            <div class="tech-item">
                                <div class="tech-icon">🚄</div>
                                <div class="tech-info">
                                    <h4>Railway</h4>
                                    <p>Cloud platform for deployment</p>
                                </div>
                            </div>
                            <div class="tech-item">
                                <div class="tech-icon">🔒</div>
                                <div class="tech-info">
                                    <h4>HTTPS/SSL</h4>
                                    <p>Secure communication protocol</p>
                                </div>
                            </div>
                            <div class="tech-item">
                                <div class="tech-icon">📊</div>
                                <div class="tech-info">
                                    <h4>Environment Variables</h4>
                                    <p>Configuration management</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Data Flow View -->
            <div id="arch-data-flow" class="architecture-view">
                <div class="data-flow-container">
                    <h3>Application Data Flow</h3>
                    
                    <div class="flow-section">
                        <h4>1. User Registration Flow</h4>
                        <div class="flow-diagram">
                            <div class="flow-step">
                                <div class="step-box user">User Interface</div>
                                <div class="step-text">User fills registration form</div>
                            </div>
                            <div class="flow-arrow">→</div>
                            <div class="flow-step">
                                <div class="step-box api">API Server</div>
                                <div class="step-text">Validates input data</div>
                            </div>
                            <div class="flow-arrow">→</div>
                            <div class="flow-step">
                                <div class="step-box database">Database</div>
                                <div class="step-text">Stores user record</div>
                            </div>
                        </div>
                    </div>

                    <div class="flow-section">
                        <h4>2. Authentication Flow</h4>
                        <div class="flow-diagram">
                            <div class="flow-step">
                                <div class="step-box user">Login Form</div>
                                <div class="step-text">Email + Password</div>
                            </div>
                            <div class="flow-arrow">→</div>
                            <div class="flow-step">
                                <div class="step-box api">Auth Service</div>
                                <div class="step-text">Validates credentials</div>
                            </div>
                            <div class="flow-arrow">→</div>
                            <div class="flow-step">
                                <div class="step-box external">SMS Gateway</div>
                                <div class="step-text">Sends OTP code</div>
                            </div>
                            <div class="flow-arrow">→</div>
                            <div class="flow-step">
                                <div class="step-box api">JWT Token</div>
                                <div class="step-text">Issues access token</div>
                            </div>
                        </div>
                    </div>

                    <div class="flow-section">
                        <h4>3. Authenticated API Request Flow</h4>
                        <div class="flow-diagram">
                            <div class="flow-step">
                                <div class="step-box user">React App</div>
                                <div class="step-text">API request + JWT</div>
                            </div>
                            <div class="flow-arrow">→</div>
                            <div class="flow-step">
                                <div class="step-box api">Middleware</div>
                                <div class="step-text">Validates JWT</div>
                            </div>
                            <div class="flow-arrow">→</div>
                            <div class="flow-step">
                                <div class="step-box api">Route Handler</div>
                                <div class="step-text">Processes request</div>
                            </div>
                            <div class="flow-arrow">→</div>
                            <div class="flow-step">
                                <div class="step-box database">PostgreSQL</div>
                                <div class="step-text">Query/Update data</div>
                            </div>
                            <div class="flow-arrow">→</div>
                            <div class="flow-step">
                                <div class="step-box user">Response</div>
                                <div class="step-text">JSON data to client</div>
                            </div>
                        </div>
                    </div>

                    <div class="data-flow-legend">
                        <h4>Data Flow Components</h4>
                        <div class="legend-items">
                            <div class="legend-item">
                                <div class="legend-box user">UI</div>
                                <span>User Interface Layer</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-box api">API</div>
                                <span>API/Service Layer</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-box database">DB</div>
                                <span>Database Layer</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-box external">EXT</div>
                                <span>External Services</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Security Architecture View -->
            <div id="arch-security" class="architecture-view">
                <div class="security-arch-container">
                    <h3>Security Architecture Overview</h3>
                    
                    <div class="security-layers">
                        <div class="security-layer">
                            <h4>🌐 Transport Layer Security</h4>
                            <div class="security-items">
                                <div class="security-item implemented">
                                    <span class="status-icon">✅</span>
                                    <div>
                                        <strong>HTTPS/TLS</strong>
                                        <p>All communication encrypted in production via Railway platform</p>
                                    </div>
                                </div>
                                <div class="security-item warning">
                                    <span class="status-icon">⚠️</span>
                                    <div>
                                        <strong>Development HTTP</strong>
                                        <p>Local development uses HTTP - consider HTTPS for consistency</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="security-layer">
                            <h4>🔐 Authentication & Authorization</h4>
                            <div class="security-items">
                                <div class="security-item implemented">
                                    <span class="status-icon">✅</span>
                                    <div>
                                        <strong>JWT Tokens</strong>
                                        <p>Stateless authentication with 24-hour expiration</p>
                                    </div>
                                </div>
                                <div class="security-item warning">
                                    <span class="status-icon">⚠️</span>
                                    <div>
                                        <strong>SMS OTP</strong>
                                        <p>Two-factor authentication implemented but with mock validation</p>
                                    </div>
                                </div>
                                <div class="security-item critical">
                                    <span class="status-icon">❌</span>
                                    <div>
                                        <strong>Password Security</strong>
                                        <p>Password hashing and validation needs implementation</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="security-layer">
                            <h4>🛡️ API Security</h4>
                            <div class="security-items">
                                <div class="security-item warning">
                                    <span class="status-icon">⚠️</span>
                                    <div>
                                        <strong>CORS Configuration</strong>
                                        <p>Allows all origins in production - needs restriction</p>
                                    </div>
                                </div>
                                <div class="security-item missing">
                                    <span class="status-icon">❌</span>
                                    <div>
                                        <strong>Rate Limiting</strong>
                                        <p>No rate limiting implemented - vulnerable to abuse</p>
                                    </div>
                                </div>
                                <div class="security-item missing">
                                    <span class="status-icon">❌</span>
                                    <div>
                                        <strong>Input Validation</strong>
                                        <p>Minimal input validation on API endpoints</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="security-layer">
                            <h4>🗄️ Data Security</h4>
                            <div class="security-items">
                                <div class="security-item implemented">
                                    <span class="status-icon">✅</span>
                                    <div>
                                        <strong>SQL Injection Prevention</strong>
                                        <p>Parameterized queries used throughout application</p>
                                    </div>
                                </div>
                                <div class="security-item critical">
                                    <span class="status-icon">❌</span>
                                    <div>
                                        <strong>Database Credentials</strong>
                                        <p>Hardcoded connection string with credentials in source code</p>
                                    </div>
                                </div>
                                <div class="security-item warning">
                                    <span class="status-icon">⚠️</span>
                                    <div>
                                        <strong>Environment Variables</strong>
                                        <p>Some secrets may be committed to repository</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="security-recommendations">
                        <h4>🎯 Priority Security Improvements</h4>
                        <div class="recommendations-list">
                            <div class="recommendation critical">
                                <span class="priority">CRITICAL</span>
                                <div>
                                    <strong>Remove hardcoded credentials</strong>
                                    <p>Move all database credentials to environment variables</p>
                                </div>
                            </div>
                            <div class="recommendation critical">
                                <span class="priority">CRITICAL</span>
                                <div>
                                    <strong>Implement password hashing</strong>
                                    <p>Use bcrypt for password hashing and validation</p>
                                </div>
                            </div>
                            <div class="recommendation high">
                                <span class="priority">HIGH</span>
                                <div>
                                    <strong>Restrict CORS origins</strong>
                                    <p>Limit allowed origins to trusted domains only</p>
                                </div>
                            </div>
                            <div class="recommendation high">
                                <span class="priority">HIGH</span>
                                <div>
                                    <strong>Add security headers</strong>
                                    <p>Implement helmet.js for security headers</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Deployment Architecture View -->
            <div id="arch-deployment" class="architecture-view">
                <div class="deployment-container">
                    <h3>Deployment Architecture</h3>
                    
                    <div class="environment-section">
                        <h4>🔧 Development Environment</h4>
                        <div class="env-details">
                            <div class="env-item">
                                <strong>Frontend:</strong> Vite dev server on localhost:5173
                            </div>
                            <div class="env-item">
                                <strong>Backend:</strong> Node.js server on localhost:3000
                            </div>
                            <div class="env-item">
                                <strong>Database:</strong> Railway PostgreSQL (shared)
                            </div>
                            <div class="env-item">
                                <strong>API URL:</strong> http://localhost:3000
                            </div>
                        </div>
                    </div>

                    <div class="environment-section">
                        <h4>🚀 Production Environment (Railway)</h4>
                        <div class="env-details">
                            <div class="env-item">
                                <strong>Platform:</strong> Railway Cloud Platform
                            </div>
                            <div class="env-item">
                                <strong>Deployment:</strong> Automatic from Git commits
                            </div>
                            <div class="env-item">
                                <strong>Database:</strong> Managed PostgreSQL instance
                            </div>
                            <div class="env-item">
                                <strong>SSL/TLS:</strong> Automatically provisioned
                            </div>
                            <div class="env-item">
                                <strong>Environment Variables:</strong> Managed via Railway dashboard
                            </div>
                        </div>
                    </div>

                    <div class="deployment-diagram">
                        <h4>Deployment Pipeline</h4>
                        <div class="pipeline-steps">
                            <div class="pipeline-step">
                                <div class="step-icon">📝</div>
                                <div class="step-title">Code Commit</div>
                                <div class="step-desc">Developer pushes to repository</div>
                            </div>
                            <div class="pipeline-arrow">→</div>
                            <div class="pipeline-step">
                                <div class="step-icon">🔍</div>
                                <div class="step-title">Git Integration</div>
                                <div class="step-desc">Railway detects changes</div>
                            </div>
                            <div class="pipeline-arrow">→</div>
                            <div class="pipeline-step">
                                <div class="step-icon">🏗️</div>
                                <div class="step-title">Build Process</div>
                                <div class="step-desc">npm install & build</div>
                            </div>
                            <div class="pipeline-arrow">→</div>
                            <div class="pipeline-step">
                                <div class="step-icon">🚀</div>
                                <div class="step-title">Deployment</div>
                                <div class="step-desc">Live application update</div>
                            </div>
                        </div>
                    </div>

                    <div class="deployment-config">
                        <h4>📋 Configuration Management</h4>
                        <div class="config-section">
                            <h5>Environment Variables</h5>
                            <div class="config-list">
                                <div class="config-item">
                                    <code>DATABASE_URL</code> - PostgreSQL connection string
                                </div>
                                <div class="config-item">
                                    <code>JWT_SECRET</code> - JWT signing secret
                                </div>
                                <div class="config-item">
                                    <code>RAILWAY_ENVIRONMENT</code> - Environment identifier
                                </div>
                                <div class="config-item">
                                    <code>VITE_API_URL</code> - Frontend API endpoint
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Keyboard Help Panel -->
            <div class="keyboard-help" id="keyboard-help">
                <h4>🚀 Keyboard Shortcuts</h4>
                <ul>
                    <li><kbd>+</kbd> / <kbd>=</kbd> Zoom In</li>
                    <li><kbd>-</kbd> Zoom Out</li>
                    <li><kbd>0</kbd> Reset Zoom</li>
                    <li><kbd>←</kbd> / <kbd>→</kbd> Navigate Tabs</li>
                    <li><kbd>Ctrl</kbd> + <kbd>P</kbd> Print</li>
                    <li><kbd>?</kbd> Toggle This Help</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Chart.js for security visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
        let allReports = [];
        let filteredReports = [];
        let currentView = 'grid';

        // Internationalization System
        const translations = {
            en: {
                dashboard: {
                    title: "YouTrack Reports Dashboard",
                    subtitle: "Comprehensive overview of project issues and implementation status",
                    loading: "📁 Loading from youtrackReports/ folder with range-based files"
                },
                tabs: {
                    reports: "Reports",
                    security: "Security Analysis", 
                    architecture: "Architecture"
                },
                architecture: {
                    title: "bankDev2_standalone Application Architecture",
                    subtitle: "Interactive system architecture diagram with detailed component information",
                    nav: {
                        overview: "System Overview",
                        components: "Component Details",
                        techStack: "Technology Stack",
                        dataFlow: "Data Flow",
                        security: "Security Architecture",
                        deployment: "Deployment"
                    },
                    legend: {
                        title: "System Components",
                        frontend: "Frontend Layer - User Interface",
                        api: "API Layer - Request Routing", 
                        services: "Services Layer - Business Logic",
                        data: "Data Layer - Persistent Storage",
                        external: "External Services - Third-party APIs",
                        cloud: "Cloud Infrastructure - Hosting Platform"
                    },
                    components: {
                        frontend: "Frontend Components",
                        backend: "Backend Services",
                        external: "External Integrations"
                    },
                    tech: {
                        frontend: "Frontend Technologies",
                        backend: "Backend Technologies", 
                        database: "Database & Storage",
                        infrastructure: "Infrastructure & DevOps"
                    },
                    steps: {
                        step: "Step",
                        user_request: "User Request",
                        api_routing: "API Routing",
                        business_logic: "Business Logic",
                        data_access: "Data Access",
                        response: "Response"
                    },
                    layers: {
                        presentation: "Presentation Layer",
                        api: "API Gateway Layer",
                        business: "Business Logic Layer",
                        data: "Data Access Layer",
                        infrastructure: "Infrastructure Layer"
                    }
                }
            },
            ru: {
                dashboard: {
                    title: "Панель YouTrack Отчетов",
                    subtitle: "Комплексный обзор проблем проекта и статуса реализации",
                    loading: "📁 Загрузка из папки youtrackReports/ с файлами по диапазонам"
                },
                tabs: {
                    reports: "Отчеты",
                    security: "Анализ Безопасности",
                    architecture: "Архитектура"
                },
                architecture: {
                    title: "Архитектура Приложения bankDev2_standalone",
                    subtitle: "Интерактивная диаграмма системной архитектуры с подробной информацией о компонентах",
                    nav: {
                        overview: "Обзор Системы",
                        components: "Детали Компонентов",
                        techStack: "Технологический Стек",
                        dataFlow: "Поток Данных",
                        security: "Архитектура Безопасности",
                        deployment: "Развертывание"
                    },
                    legend: {
                        title: "Компоненты Системы",
                        frontend: "Фронтенд Слой - Пользовательский Интерфейс",
                        api: "API Слой - Маршрутизация Запросов",
                        services: "Слой Сервисов - Бизнес Логика",
                        data: "Слой Данных - Постоянное Хранилище",
                        external: "Внешние Сервисы - API Третьих Сторон",
                        cloud: "Облачная Инфраструктура - Платформа Хостинга"
                    },
                    components: {
                        frontend: "Фронтенд Компоненты",
                        backend: "Бэкенд Сервисы",
                        external: "Внешние Интеграции"
                    },
                    tech: {
                        frontend: "Фронтенд Технологии",
                        backend: "Бэкенд Технологии",
                        database: "База Данных и Хранилище",
                        infrastructure: "Инфраструктура и DevOps"
                    },
                    steps: {
                        step: "Шаг",
                        user_request: "Запрос Пользователя",
                        api_routing: "API Маршрутизация",
                        business_logic: "Бизнес Логика",
                        data_access: "Доступ к Данным",
                        response: "Ответ"
                    },
                    layers: {
                        presentation: "Уровень Представления",
                        api: "Уровень API Шлюза",
                        business: "Уровень Бизнес Логики",
                        data: "Уровень Доступа к Данным",
                        infrastructure: "Уровень Инфраструктуры"
                    }
                }
            }
        };

        let currentLanguage = 'en';

        // Initialize language from localStorage or default to English
        function initializeLanguage() {
            const savedLanguage = localStorage.getItem('dashboard-language') || 'en';
            currentLanguage = savedLanguage;
            document.getElementById('language-select').value = savedLanguage;
            applyTranslations();
        }

        // Change language function
        function changeLanguage(language) {
            currentLanguage = language;
            localStorage.setItem('dashboard-language', language);
            applyTranslations();
        }

        // Apply translations to the page
        function applyTranslations() {
            const elements = document.querySelectorAll('[data-i18n]');
            elements.forEach(element => {
                const key = element.getAttribute('data-i18n');
                const translation = getTranslation(key);
                if (translation) {
                    element.textContent = translation;
                }
            });
            
            // Update architecture content specifically
            updateArchitectureTranslations();
        }

        // Get translation by key path (e.g., "dashboard.title")
        function getTranslation(key) {
            const keys = key.split('.');
            let value = translations[currentLanguage];
            for (const k of keys) {
                value = value?.[k];
            }
            return value;
        }

        // Update architecture translations
        function updateArchitectureTranslations() {
            // Update SVG text elements with translations
            const svgElements = document.querySelectorAll('#architecture-diagram [data-i18n]');
            svgElements.forEach(element => {
                const key = element.getAttribute('data-i18n');
                const translation = getTranslation(key);
                if (translation) {
                    element.textContent = translation;
                }
            });
        }

        // Zoom and Pan Functionality
        let currentZoom = 1;
        let isPanning = false;
        let panStart = { x: 0, y: 0 };
        let panOffset = { x: 0, y: 0 };

        function zoomDiagram(direction) {
            const diagram = document.getElementById('architecture-diagram');
            const step = 0.2;
            
            if (direction === 'in' && currentZoom < 3) {
                currentZoom += step;
            } else if (direction === 'out' && currentZoom > 0.5) {
                currentZoom -= step;
            }
            
            updateDiagramTransform();
        }

        function resetZoom() {
            currentZoom = 1;
            panOffset = { x: 0, y: 0 };
            updateDiagramTransform();
        }

        function updateDiagramTransform() {
            const diagram = document.getElementById('architecture-diagram');
            diagram.style.transform = `scale(${currentZoom}) translate(${panOffset.x}px, ${panOffset.y}px)`;
        }

        function printArchitecture() {
            const printWindow = window.open('', '_blank');
            const diagramHTML = document.getElementById('architecture-content').innerHTML;
            
            printWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Architecture Diagram - ${getTranslation('architecture.title')}</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; }
                        .architecture-container { display: block !important; }
                        .architecture-controls { display: none; }
                        .architecture-nav { display: none; }
                        svg { width: 100%; height: auto; }
                        @media print {
                            body { margin: 0; }
                            svg { page-break-inside: avoid; }
                        }
                    </style>
                </head>
                <body>
                    ${diagramHTML}
                </body>
                </html>
            `);
            
            printWindow.document.close();
            printWindow.print();
        }

        // Enhanced Tooltips System
        function createTooltip(element, content) {
            const tooltip = document.createElement('div');
            tooltip.className = 'arch-tooltip';
            tooltip.innerHTML = content;
            document.body.appendChild(tooltip);
            
            const rect = element.getBoundingClientRect();
            tooltip.style.left = rect.left + rect.width / 2 + 'px';
            tooltip.style.top = rect.top - 10 + 'px';
            
            // Show tooltip
            setTimeout(() => tooltip.classList.add('visible'), 10);
            
            return tooltip;
        }

        function removeTooltips() {
            document.querySelectorAll('.arch-tooltip').forEach(tooltip => {
                tooltip.classList.remove('visible');
                setTimeout(() => tooltip.remove(), 300);
            });
        }

        // Keyboard Navigation Support
        function initializeKeyboardNavigation() {
            document.addEventListener('keydown', function(e) {
                if (document.getElementById('architecture-content').style.display !== 'none') {
                    switch(e.key) {
                        case '+':
                        case '=':
                            e.preventDefault();
                            zoomDiagram('in');
                            break;
                        case '-':
                            e.preventDefault();
                            zoomDiagram('out');
                            break;
                        case '0':
                            e.preventDefault();
                            resetZoom();
                            break;
                        case 'p':
                        case 'P':
                            if (e.ctrlKey || e.metaKey) {
                                e.preventDefault();
                                printArchitecture();
                            }
                            break;
                        case 'ArrowLeft':
                            e.preventDefault();
                            navigateArchitectureTab('prev');
                            break;
                        case 'ArrowRight':
                            e.preventDefault();
                            navigateArchitectureTab('next');
                            break;
                        case '?':
                            e.preventDefault();
                            toggleKeyboardHelp();
                            break;
                    }
                }
            });
        }

        function navigateArchitectureTab(direction) {
            const tabs = ['overview', 'components', 'tech-stack', 'data-flow', 'security', 'deployment'];
            const currentTab = document.querySelector('.arch-nav-btn.active')?.onclick?.toString().match(/'(\w+(-\w+)?)'/) ?.[1];
            const currentIndex = tabs.indexOf(currentTab);
            
            let nextIndex;
            if (direction === 'next') {
                nextIndex = (currentIndex + 1) % tabs.length;
            } else {
                nextIndex = (currentIndex - 1 + tabs.length) % tabs.length;
            }
            
            showArchitectureView(tabs[nextIndex]);
        }

        // Enhanced hover effects with smooth transitions
        function initializeArchitectureInteractions() {
            const archLayers = document.querySelectorAll('.arch-layer');
            
            archLayers.forEach(layer => {
                layer.addEventListener('mouseenter', function() {
                    const tooltip = this.getAttribute('data-tooltip');
                    if (tooltip) {
                        createTooltip(this, tooltip);
                    }
                    
                    // Add glow effect
                    this.style.filter = 'url(#glowEffect) brightness(1.1)';
                    this.style.transform = 'scale(1.02)';
                });
                
                layer.addEventListener('mouseleave', function() {
                    removeTooltips();
                    this.style.filter = '';
                    this.style.transform = '';
                });
                
                layer.addEventListener('click', function() {
                    const layerType = this.getAttribute('data-layer');
                    showLayerDetails(layerType);
                });
            });
            
            // Add pan functionality to diagram (mouse and touch)
            const diagram = document.getElementById('architecture-diagram');
            
            // Mouse events
            diagram.addEventListener('mousedown', startPan);
            diagram.addEventListener('mousemove', pan);
            diagram.addEventListener('mouseup', endPan);
            diagram.addEventListener('mouseleave', endPan);
            
            // Touch events for mobile
            diagram.addEventListener('touchstart', startPanTouch);
            diagram.addEventListener('touchmove', panTouch);
            diagram.addEventListener('touchend', endPan);
        }

        function startPan(e) {
            if (e.target.closest('.arch-layer')) return; // Don't pan when clicking on components
            
            isPanning = true;
            panStart.x = e.clientX;
            panStart.y = e.clientY;
            document.getElementById('architecture-diagram').style.cursor = 'grabbing';
        }

        function pan(e) {
            if (!isPanning) return;
            
            const deltaX = e.clientX - panStart.x;
            const deltaY = e.clientY - panStart.y;
            
            panOffset.x += deltaX / currentZoom;
            panOffset.y += deltaY / currentZoom;
            
            panStart.x = e.clientX;
            panStart.y = e.clientY;
            
            updateDiagramTransform();
        }

        function endPan() {
            isPanning = false;
            document.getElementById('architecture-diagram').style.cursor = 'grab';
        }

        // Touch event handlers for mobile
        function startPanTouch(e) {
            if (e.target.closest('.arch-layer')) return;
            
            e.preventDefault();
            isPanning = true;
            const touch = e.touches[0];
            panStart.x = touch.clientX;
            panStart.y = touch.clientY;
        }

        function panTouch(e) {
            if (!isPanning) return;
            
            e.preventDefault();
            const touch = e.touches[0];
            const deltaX = touch.clientX - panStart.x;
            const deltaY = touch.clientY - panStart.y;
            
            panOffset.x += deltaX / currentZoom;
            panOffset.y += deltaY / currentZoom;
            
            panStart.x = touch.clientX;
            panStart.y = touch.clientY;
            
            updateDiagramTransform();
        }

        function showLayerDetails(layerType) {
            // Could expand to show detailed layer information
            console.log('Showing details for layer:', layerType);
        }

        function toggleKeyboardHelp() {
            const helpPanel = document.getElementById('keyboard-help');
            helpPanel.classList.toggle('visible');
        }

        // Show keyboard help when architecture tab is active
        function showArchitectureHelp() {
            setTimeout(() => {
                const helpPanel = document.getElementById('keyboard-help');
                helpPanel.classList.add('visible');
                setTimeout(() => helpPanel.classList.remove('visible'), 5000);
            }, 1000);
        }

        // Discover and load all available YouTrack JSON files from youtrackReports folder
        async function discoverFiles() {
            // Only check for files we know exist
            const knownFiles = [
                'youtrackReports/youTrackReports.json',
                'youtrackReports/youTrackReports_136-200.json',
                'youtrackReports/youTrackReports_200-300.json',
                'youtrackReports/youTrackReports_300-400.json',
                'youtrackReports/youTrackReports_400-500.json',
                'youtrackReports/youTrackReports_500-600.json',
                'youtrackReports/youTrackReports_600-628.json',
                'youtrackReports/youTrackReports_625-628.json',
                'youtrackReports/youTrackReports_LK.json'
            ];

            console.log('Loading known YouTrack files...');
            return knownFiles;
        }

        // Load and parse JSON data
        async function loadReports() {
            try {
                document.getElementById('loading').innerHTML = `
                    <div class="spinner"></div>
                    <p>Discovering available YouTrack files...</p>
                `;

                const availableFiles = await discoverFiles();
                console.log('Discovered files:', availableFiles);

                document.getElementById('loading').innerHTML = `
                    <div class="spinner"></div>
                    <p>Loading ${availableFiles.length} YouTrack files...</p>
                `;

                const filePromises = availableFiles.map(async (filePath) => {
                    try {
                        console.log(`Loading ${filePath}...`);
                        const response = await fetch(`./${filePath}`);
                        if (response.ok) {
                            const data = await response.json();
                            const fileName = filePath.split('/').pop(); // Extract just the filename
                            console.log(`✅ Successfully loaded ${filePath}`);
                            return { data, name: fileName, fullPath: filePath };
                        } else {
                            console.error(`❌ Failed to load ${filePath}: HTTP ${response.status}`);
                        }
                        return null;
                    } catch (error) {
                        console.error(`❌ Error loading ${filePath}:`, error);
                        return null;
                    }
                });

                const results = await Promise.all(filePromises);
                const validResults = results.filter(result => result !== null);

                if (validResults.length === 0) {
                    console.error('No valid results loaded');
                    throw new Error('No YouTrack files could be loaded. Please check the file paths and server configuration.');
                }
                
                console.log('Valid results:', validResults);

                // Parse reports from all loaded files
                allReports = [];
                validResults.forEach(result => {
                    // Handle different JSON structures
                    let reports = [];
                    
                    // Check if data has 'issues' array (most common format)
                    if (result.data.issues && Array.isArray(result.data.issues)) {
                        reports = result.data.issues.map(issue => ({
                            id: issue.issue_id || issue.idReadable || issue.id,
                            ...issue,
                            source: result.name
                        }));
                    } 
                    // Check if data has 'reports' object (older format)
                    else if (result.data.reports && typeof result.data.reports === 'object') {
                        reports = Object.entries(result.data.reports).map(([id, report]) => ({
                            id,
                            ...report,
                            source: result.name
                        }));
                    }
                    // Check if the data itself is an array of issues
                    else if (Array.isArray(result.data)) {
                        reports = result.data.map(issue => ({
                            id: issue.issue_id || issue.idReadable || issue.id,
                            ...issue,
                            source: result.name
                        }));
                    }
                    
                    // Also check for individual issue keys (like LK-165, OS-94, etc.)
                    // This handles files with mixed structure
                    Object.keys(result.data).forEach(key => {
                        if (key.match(/^(LK|OS|DOC|REP)-\d+$/)) {
                            const issue = result.data[key];
                            if (typeof issue === 'object' && issue !== null) {
                                reports.push({
                                    id: key,
                                    ...issue,
                                    source: result.name
                                });
                            }
                        }
                    });
                    
                    console.log(`Parsed ${reports.length} reports from ${result.name}`);
                    
                    // Debug: show sample report structure
                    if (reports.length > 0) {
                        console.log(`Sample report from ${result.name}:`, reports[0]);
                    }
                    
                    allReports = [...allReports, ...reports];
                });

                console.log(`Loaded ${allReports.length} reports from ${validResults.length} files:`, 
                    validResults.map(r => r.name).join(', '));
                
                // Debug: show all unique statuses
                const uniqueStatuses = [...new Set(allReports.map(r => r.status))].filter(Boolean);
                console.log('Unique statuses found:', uniqueStatuses);
                
                filteredReports = [...allReports];

                // Update source filter dropdown with discovered files
                updateSourceFilter(validResults.map(r => r.name));

                // Show loaded files in header with categorization
                const mainFiles = validResults.filter(r => r.name === 'youTrackReports.json');
                const rangeFiles = validResults.filter(r => r.name.match(/\d+-\d+/));
                const otherFiles = validResults.filter(r => !mainFiles.includes(r) && !rangeFiles.includes(r));
                
                let summaryText = `📁 Successfully loaded ${validResults.length} YouTrack files`;
                if (rangeFiles.length > 0) {
                    summaryText += ` (${rangeFiles.length} range files, ${otherFiles.length} other files)`;
                }
                
                const filesList = validResults.map(r => r.name).join(', ');
                document.getElementById('files-loaded').innerHTML = 
                    `${summaryText}: ${filesList}`;

                updateStats();
                renderReports();
                
                document.getElementById('loading').style.display = 'none';
                document.getElementById('reports-grid').style.display = 'grid';

            } catch (error) {
                console.error('Error loading reports:', error);
                document.getElementById('loading').innerHTML = `
                    <div style="color: #dc3545; text-align: center;">
                        <h3>Error loading reports</h3>
                        <p>Could not load YouTrack files. Expected files:</p>
                        <ul style="list-style: none; padding: 0;">
                            <li>youTrackReports.json</li>
                            <li>youTrackReports_136-200.json</li>
                            <li>youTrackReports_200-300.json</li>
                            <li>youTrackReports_300-400.json</li>
                            <li>youTrackReports_500-600.json</li>
                            <li>youTrackReports_600-628.json</li>
                            <li>youTrackReports_625-628.json</li>
                            <li>youTrackReports_LK.json</li>
                        </ul>
                        <p style="font-size: 0.9rem; color: #6c757d;">Check console for detailed error messages.</p>
                    </div>
                `;
            }
        }

        // Update source filter dropdown with discovered files
        function updateSourceFilter(fileNames) {
            const sourceFilter = document.getElementById('source-filter');
            
            // Clear existing options except "All Sources"
            sourceFilter.innerHTML = '<option value="">All Sources</option>';
            
            // Sort files for better organization
            const sortedFiles = fileNames.sort((a, b) => {
                // Main file first
                if (a === 'youTrackReports.json') return -1;
                if (b === 'youTrackReports.json') return 1;
                
                // Range files by their start number
                const rangeA = a.match(/(\d+)-(\d+)/);
                const rangeB = b.match(/(\d+)-(\d+)/);
                
                if (rangeA && rangeB) {
                    return parseInt(rangeA[1]) - parseInt(rangeB[1]);
                }
                
                // Backup and special files at the end
                if (a.includes('backup')) return 1;
                if (b.includes('backup')) return -1;
                
                // Default alphabetical
                return a.localeCompare(b);
            });
            
            // Add discovered files
            sortedFiles.forEach(fileName => {
                const option = document.createElement('option');
                option.value = fileName;
                option.textContent = fileName;
                sourceFilter.appendChild(option);
            });
        }

        // Update statistics
        function updateStats() {
            const total = filteredReports.length;
            const done = filteredReports.filter(r => {
                const status = (r.status || '').toLowerCase();
                return status === 'done' || 
                       status === '✅ done' || 
                       status === '✅ perfectly done' ||
                       status.includes('done');
            }).length;
            const notDone = filteredReports.filter(r => {
                const status = (r.status || '').toLowerCase();
                return status === '❌ not done' || 
                       status === 'not done' ||
                       status.includes('not done');
            }).length;
            const pending = filteredReports.filter(r => {
                const status = (r.status || '').toLowerCase();
                return status === 'pending_confirmation' || 
                       status === 'implementation_complete_ready_for_testing' ||
                       status === 'sequential_analysis_complete' ||
                       status === 'substantially_complete' ||
                       status.includes('pending') ||
                       status.includes('ready for testing');
            }).length;
            const ignored = filteredReports.filter(r => r.is_ignore === true).length;
            const completionRate = total > 0 ? Math.round((done / total) * 100) : 0;

            document.getElementById('total-issues').textContent = total;
            document.getElementById('done-issues').textContent = done;
            document.getElementById('not-done-issues').textContent = notDone;
            document.getElementById('pending-issues').textContent = pending;
            document.getElementById('ignored-issues').textContent = ignored;
            document.getElementById('completion-rate').textContent = completionRate + '%';
        }

        // Get status badge class
        function getStatusClass(status) {
            const statusLower = (status || '').toLowerCase();
            if (statusLower === 'done' || 
                statusLower === '✅ done' || 
                statusLower === '✅ perfectly done' ||
                statusLower.includes('done')) return 'status-done';
            if (statusLower === '❌ not done' || 
                statusLower === 'not done' ||
                statusLower.includes('not done')) return 'status-not-done';
            if (statusLower === 'pending_confirmation' ||
                statusLower.includes('pending')) return 'status-pending';
            if (statusLower === 'implementation_complete_ready_for_testing' || 
                statusLower === 'sequential_analysis_complete' ||
                statusLower === 'substantially_complete' ||
                statusLower.includes('ready for testing') ||
                statusLower.includes('complete')) return 'status-complete';
            return 'status-default';
        }

        // Get quality score color
        function getScoreColor(score) {
            if (score >= 9) return '#28a745';
            if (score >= 7) return '#ffc107';
            if (score >= 5) return '#fd7e14';
            return '#dc3545';
        }

        // Format date
        function formatDate(dateString) {
            if (!dateString) return 'N/A';
            try {
                return new Date(dateString).toLocaleDateString();
            } catch {
                return dateString;
            }
        }

        // Render reports in grid view
        function renderGridView() {
            const container = document.getElementById('reports-grid');
            container.innerHTML = '';

            if (filteredReports.length === 0) {
                document.getElementById('no-results').style.display = 'block';
                return;
            } else {
                document.getElementById('no-results').style.display = 'none';
            }

            filteredReports.forEach(report => {
                const statusClass = getStatusClass(report.status);
                const qualityScore = report.implementation_quality?.overall_score || 
                                  report.implementation_quality?.overall || 
                                  report.quality_score ||
                                  (report.actions_completed && report.total_actions ? 
                                    Math.round((report.actions_completed / report.total_actions) * 10) : 0);
                const scoreColor = getScoreColor(qualityScore);
                const totalActions = report.total_actions || report.actions_required || 0;
                const completedActions = report.actions_completed || 0;
                const completionPercentage = totalActions ? 
                    Math.round((completedActions / totalActions) * 100) : 
                    (report.completion_percentage || 0);

                const card = document.createElement('div');
                card.className = `report-card ${statusClass} ${report.is_ignore === true ? 'ignored' : ''}`;
                card.innerHTML = `
                    <div class="report-header">
                        <div class="report-id">
                            ${report.id}
                            ${report.is_ignore === true ? '<span style="color: #6c757d; font-size: 0.8rem; margin-left: 8px;">🚫 IGNORED</span>' : ''}
                        </div>
                        <div class="report-title">${report.issue_title || report.title || 'No title available'}</div>
                    </div>
                    <div class="report-body">
                        <span class="status-badge ${statusClass}">${report.status || 'Unknown'}</span>
                        
                        <div class="report-details">
                            <div class="detail-item">
                                <span class="detail-label">Total Actions</span>
                                <span class="detail-value">${totalActions || 'N/A'}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Completed</span>
                                <span class="detail-value">${completedActions || 'N/A'}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Analysis Date</span>
                                <span class="detail-value">${formatDate(report.analysis_date || report.last_check_date || report.generated_date)}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Source</span>
                                <span class="detail-value" title="${report.source}">${report.source.replace('youTrackReports_', '').replace('.json', '')}</span>
                            </div>
                        </div>

                        ${totalActions ? `
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${completionPercentage}%"></div>
                            </div>
                        ` : ''}

                        ${qualityScore ? `
                            <div class="quality-score">
                                <div class="score-circle" style="background: ${scoreColor}">
                                    ${qualityScore}
                                </div>
                                <span>Quality Score</span>
                            </div>
                        ` : ''}

                        <div class="report-actions">
                            ${report.figma_url ? `<a href="${report.figma_url}" target="_blank" class="btn btn-primary">View Design</a>` : ''}
                            ${report.page_url ? `<a href="${report.page_url}" class="btn btn-secondary">View Page</a>` : ''}
                        </div>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        // Render reports in table view
        function renderTableView() {
            const tbody = document.getElementById('table-body');
            tbody.innerHTML = '';

            if (filteredReports.length === 0) {
                document.getElementById('no-results').style.display = 'block';
                return;
            } else {
                document.getElementById('no-results').style.display = 'none';
            }

            filteredReports.forEach(report => {
                const statusClass = getStatusClass(report.status);
                const qualityScore = report.implementation_quality?.overall_score || 
                                  report.implementation_quality?.overall || 
                                  report.quality_score ||
                                  (report.actions_completed && report.total_actions ? 
                                    Math.round((report.actions_completed / report.total_actions) * 10) : 0);
                const totalActions = report.total_actions || report.actions_required || 0;
                const completedActions = report.actions_completed || 0;

                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><strong>${report.id}</strong></td>
                    <td>${(report.issue_title || report.title || 'No title available').substring(0, 60)}...</td>
                    <td><span class="status-badge ${statusClass}">${report.status || 'Unknown'}</span></td>
                    <td>${totalActions || 'N/A'} / ${completedActions || 'N/A'}</td>
                    <td>${qualityScore || 'N/A'}</td>
                    <td>${formatDate(report.analysis_date || report.last_check_date || report.generated_date)}</td>
                    <td>${report.source.replace('youTrackReports_', '').replace('.json', '')}</td>
                    <td>${report.is_ignore === true ? '🚫 Yes' : '✅ No'}</td>
                `;
                tbody.appendChild(row);
            });
        }

        // Render reports based on current view
        function renderReports() {
            if (currentView === 'grid') {
                renderGridView();
            } else {
                renderTableView();
            }
            updateStats();
        }

        // Set view mode
        function setView(view) {
            currentView = view;
            
            document.getElementById('grid-view').classList.toggle('active', view === 'grid');
            document.getElementById('table-view').classList.toggle('active', view === 'table');
            
            document.getElementById('reports-grid').style.display = view === 'grid' ? 'grid' : 'none';
            document.getElementById('reports-table').style.display = view === 'table' ? 'block' : 'none';
            
            renderReports();
        }

        // Filter reports
        function filterReports() {
            const statusFilter = document.getElementById('status-filter').value;
            const searchTerm = document.getElementById('search-box').value.toLowerCase();
            const sourceFilter = document.getElementById('source-filter').value;
            const ignoreFilter = document.getElementById('ignore-filter').value;

            filteredReports = allReports.filter(report => {
                let statusMatch = true;
                if (statusFilter) {
                    const reportStatus = (report.status || '').toLowerCase();
                    const filterStatus = statusFilter.toLowerCase();
                    
                    // Special handling for different status formats
                    if (filterStatus === 'done') {
                        statusMatch = reportStatus === 'done' || 
                                    reportStatus === '✅ done' || 
                                    reportStatus === '✅ perfectly done' ||
                                    reportStatus.includes('done');
                    } else if (filterStatus === '❌ not done') {
                        statusMatch = reportStatus === '❌ not done' || 
                                    reportStatus === 'not done' ||
                                    reportStatus.includes('not done');
                    } else if (filterStatus === '✅ perfectly done') {
                        statusMatch = reportStatus.includes('perfectly done');
                    } else if (filterStatus === '✅ fully implemented') {
                        statusMatch = reportStatus.includes('fully implemented');
                    } else if (filterStatus === '🔶 partially implemented') {
                        statusMatch = reportStatus.includes('partially implemented');
                    } else if (filterStatus === '⚠️ mostly implemented') {
                        statusMatch = reportStatus.includes('mostly implemented');
                    } else if (filterStatus === '⚠️ mostly done') {
                        statusMatch = reportStatus.includes('mostly done');
                    } else if (filterStatus === '🔴 critical gaps') {
                        statusMatch = reportStatus.includes('critical gaps');
                    } else if (filterStatus === '⚠️ backend task') {
                        statusMatch = reportStatus.includes('backend task');
                    } else if (filterStatus === '⚠️ requires investigation') {
                        statusMatch = reportStatus.includes('requires investigation');
                    } else if (filterStatus === '⚠️ not found') {
                        statusMatch = reportStatus.includes('not found');
                    } else {
                        statusMatch = reportStatus === filterStatus || reportStatus.includes(filterStatus);
                    }
                }
                
                const searchMatch = !searchTerm || 
                    (report.id || '').toLowerCase().includes(searchTerm) ||
                    (report.issue_title || report.title || '').toLowerCase().includes(searchTerm) ||
                    (report.key_findings || '').toLowerCase().includes(searchTerm) ||
                    (report.description || '').toLowerCase().includes(searchTerm);
                const sourceMatch = !sourceFilter || report.source === sourceFilter;
                const ignoreMatch = !ignoreFilter || 
                    (ignoreFilter === 'true' && report.is_ignore === true) ||
                    (ignoreFilter === 'false' && (report.is_ignore === false || report.is_ignore === undefined));

                return statusMatch && searchMatch && sourceMatch && ignoreMatch;
            });

            renderReports();
        }

        // Clear all filters
        function clearFilters() {
            document.getElementById('status-filter').value = '';
            document.getElementById('search-box').value = '';
            document.getElementById('source-filter').value = '';
            document.getElementById('ignore-filter').value = '';
            filteredReports = [...allReports];
            renderReports();
        }

        // Event listeners
        document.getElementById('status-filter').addEventListener('change', filterReports);
        document.getElementById('search-box').addEventListener('input', filterReports);
        document.getElementById('source-filter').addEventListener('change', filterReports);
        document.getElementById('ignore-filter').addEventListener('change', filterReports);

        // Initialize
        loadReports();

        // Tab switching functionality
        function switchTab(tabName) {
            // Update tab active state
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');

            // Show/hide content
            if (tabName === 'reports') {
                document.getElementById('reports-stats').style.display = 'flex';
                document.getElementById('reports-controls').style.display = 'block';
                document.getElementById('reports-content').style.display = 'block';
                document.getElementById('security-content').style.display = 'none';
                document.getElementById('architecture-content').style.display = 'none';
            } else if (tabName === 'security') {
                document.getElementById('reports-stats').style.display = 'none';
                document.getElementById('reports-controls').style.display = 'none';
                document.getElementById('reports-content').style.display = 'none';
                document.getElementById('security-content').style.display = 'block';
                document.getElementById('architecture-content').style.display = 'none';
                
                // Load security analysis if not already loaded
                if (!window.securityAnalysisLoaded) {
                    performSecurityAnalysis();
                }
            } else if (tabName === 'architecture') {
                document.getElementById('reports-stats').style.display = 'none';
                document.getElementById('reports-controls').style.display = 'none';
                document.getElementById('reports-content').style.display = 'none';
                document.getElementById('security-content').style.display = 'none';
                document.getElementById('architecture-content').style.display = 'block';
                
                // Initialize architecture interactions if not already done
                if (!window.architectureInitialized) {
                    initializeArchitecture();
                }
            }
        }

        // Security Analysis Functions
        let securityChart = null;
        window.securityAnalysisLoaded = false;

        async function performSecurityAnalysis() {
            console.log('Starting security analysis...');
            document.getElementById('security-loading').style.display = 'block';
            document.getElementById('security-results').style.display = 'none';

            // Simulate gathering security data from the bankDev2_standalone project
            const securityIssues = await analyzeProjectSecurity();
            
            // Display results
            displaySecurityResults(securityIssues);
            window.securityAnalysisLoaded = true;
        }

        async function analyzeProjectSecurity() {
            // This simulates a comprehensive security analysis
            // In a real implementation, this would scan actual files
            const issues = [];

            // Authentication & Authorization Issues
            issues.push({
                category: 'Authentication',
                severity: 'critical',
                title: 'Hardcoded Database Connection String',
                description: 'Database connection string with credentials is hardcoded in server-db.js',
                location: '/server-db.js:15',
                code: "connectionString: process.env.DATABASE_URL || 'postgresql://postgres:lgqPEzvVbSCviTybKqMbzJkYvOUetJjt@maglev.proxy.rlwy.net:43809/railway'",
                remediation: 'Move all credentials to environment variables and never commit them to version control. Use a .env file for local development and secure environment variables for production.'
            });

            issues.push({
                category: 'Authentication',
                severity: 'critical',
                title: 'Weak JWT Secret',
                description: 'JWT tokens are signed with a weak default secret "secret" when JWT_SECRET env var is not set',
                location: '/server-db.js:216',
                code: "process.env.JWT_SECRET || 'secret'",
                remediation: 'Always use a strong, randomly generated JWT secret. Never use default values. Generate with: openssl rand -base64 32'
            });

            issues.push({
                category: 'Authentication',
                severity: 'high',
                title: 'No Password Verification',
                description: 'Email login endpoint does not verify passwords - any password is accepted',
                location: '/server-db.js:188-239',
                code: 'app.post("/api/login", async (req, res) => { // No password check })',
                remediation: 'Implement proper password hashing using bcrypt and verify passwords before issuing tokens'
            });

            issues.push({
                category: 'Authentication',
                severity: 'high',
                title: 'SMS OTP Always Accepted',
                description: 'Any 4-digit code is accepted for SMS verification without actual validation',
                location: '/server-db.js:268-315',
                code: 'if (!code || !mobile_number || code.length !== 4) { // Only checks length }',
                remediation: 'Store OTP codes in database/cache with expiration and validate the actual code value'
            });

            // CORS & Security Headers
            issues.push({
                category: 'CORS',
                severity: 'high',
                title: 'Overly Permissive CORS in Production',
                description: 'CORS allows all origins (*) in production environment',
                location: '/server-db.js:28-33',
                code: 'if (process.env.RAILWAY_ENVIRONMENT === "production") { return true; // Allow all origins }',
                remediation: 'Restrict CORS to specific allowed domains even in production. Use a whitelist of trusted origins.'
            });

            issues.push({
                category: 'Security Headers',
                severity: 'medium',
                title: 'Missing Security Headers',
                description: 'Application lacks important security headers like X-Frame-Options, X-Content-Type-Options, CSP',
                location: 'Global middleware configuration',
                remediation: 'Use helmet.js middleware to set security headers: app.use(helmet())'
            });

            // SQL Injection
            issues.push({
                category: 'SQL Injection',
                severity: 'low',
                title: 'Parameterized Queries Used',
                description: 'Good: SQL queries use parameterized statements preventing SQL injection',
                location: '/server-db.js',
                code: 'pool.query("SELECT * FROM users WHERE email = $1", [email])',
                remediation: 'Continue using parameterized queries for all database operations'
            });

            // Input Validation
            issues.push({
                category: 'Input Validation',
                severity: 'medium',
                title: 'Insufficient Input Validation',
                description: 'API endpoints have minimal input validation, accepting any data format',
                location: 'Multiple endpoints',
                remediation: 'Implement comprehensive input validation using a library like joi or express-validator'
            });

            // XSS Prevention
            issues.push({
                category: 'XSS',
                severity: 'medium',
                title: 'No XSS Protection Middleware',
                description: 'Application does not implement XSS protection middleware',
                location: 'Server configuration',
                remediation: 'Use xss-clean middleware and implement Content Security Policy (CSP) headers'
            });

            // Secrets Management
            issues.push({
                category: 'Secrets',
                severity: 'high',
                title: 'Environment Variables in Repository',
                description: '.env files with sensitive data may be committed to repository',
                location: '/.env, /.env.production',
                remediation: 'Add .env files to .gitignore and use environment-specific configuration management'
            });

            // Rate Limiting
            issues.push({
                category: 'API Security',
                severity: 'medium',
                title: 'No Rate Limiting',
                description: 'API endpoints lack rate limiting, vulnerable to brute force and DoS attacks',
                location: 'All API endpoints',
                remediation: 'Implement rate limiting using express-rate-limit middleware'
            });

            // HTTPS
            issues.push({
                category: 'Transport Security',
                severity: 'high',
                title: 'HTTP Used in Development',
                description: 'Development environment uses HTTP instead of HTTPS',
                location: 'VITE_API_URL configuration',
                remediation: 'Use HTTPS even in development with self-signed certificates'
            });

            // Session Management
            issues.push({
                category: 'Session Management',
                severity: 'medium',
                title: 'No Token Refresh Mechanism',
                description: 'JWT tokens have 24h expiry but no refresh token mechanism',
                location: 'Authentication flow',
                remediation: 'Implement refresh tokens for better security and user experience'
            });

            // Error Handling
            issues.push({
                category: 'Information Disclosure',
                severity: 'low',
                title: 'Verbose Error Messages',
                description: 'Stack traces and detailed errors may be exposed to clients',
                location: 'Error handling middleware',
                remediation: 'Implement proper error handling that logs details server-side but returns generic messages to clients'
            });

            // Dependencies
            issues.push({
                category: 'Dependencies',
                severity: 'medium',
                title: 'Outdated Dependencies',
                description: 'Several dependencies may have known vulnerabilities',
                location: 'package.json',
                remediation: 'Run npm audit and update vulnerable dependencies regularly'
            });

            return issues;
        }

        function displaySecurityResults(issues) {
            // Calculate security score
            const severityWeights = {
                critical: 10,
                high: 5,
                medium: 2,
                low: 1
            };

            let totalWeight = 0;
            const severityCounts = {
                critical: 0,
                high: 0,
                medium: 0,
                low: 0
            };

            issues.forEach(issue => {
                severityCounts[issue.severity]++;
                totalWeight += severityWeights[issue.severity];
            });

            // Calculate score (100 - penalties)
            const maxPenalty = 100;
            const score = Math.max(0, Math.round(100 - (totalWeight / maxPenalty) * 100));

            // Update score display
            const scoreElement = document.getElementById('security-score');
            scoreElement.textContent = score;
            scoreElement.className = 'security-score';
            
            let grade, gradeClass;
            if (score >= 90) {
                grade = 'Excellent Security';
                gradeClass = 'score-excellent';
            } else if (score >= 70) {
                grade = 'Good Security';
                gradeClass = 'score-good';
            } else if (score >= 50) {
                grade = 'Fair Security';
                gradeClass = 'score-fair';
            } else if (score >= 30) {
                grade = 'Poor Security';
                gradeClass = 'score-poor';
            } else {
                grade = 'Critical Security Issues';
                gradeClass = 'score-critical';
            }

            scoreElement.classList.add(gradeClass);
            document.getElementById('security-grade').textContent = grade;
            document.getElementById('security-progress').style.width = score + '%';

            // Update summary counts
            document.getElementById('critical-count').textContent = severityCounts.critical;
            document.getElementById('high-count').textContent = severityCounts.high;
            document.getElementById('medium-count').textContent = severityCounts.medium;
            document.getElementById('low-count').textContent = severityCounts.low;

            // Create security chart
            const ctx = document.getElementById('security-chart').getContext('2d');
            if (securityChart) {
                securityChart.destroy();
            }

            securityChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Critical', 'High', 'Medium', 'Low'],
                    datasets: [{
                        data: [severityCounts.critical, severityCounts.high, severityCounts.medium, severityCounts.low],
                        backgroundColor: ['#dc3545', '#fd7e14', '#ffc107', '#17a2b8'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                font: {
                                    size: 14
                                }
                            }
                        }
                    }
                }
            });

            // Group issues by category
            const categorizedIssues = {};
            issues.forEach(issue => {
                if (!categorizedIssues[issue.category]) {
                    categorizedIssues[issue.category] = [];
                }
                categorizedIssues[issue.category].push(issue);
            });

            // Display categorized issues
            const categoriesContainer = document.getElementById('security-categories');
            categoriesContainer.innerHTML = '';

            Object.entries(categorizedIssues).forEach(([category, categoryIssues]) => {
                // Determine highest severity in category
                const severityOrder = ['critical', 'high', 'medium', 'low'];
                const highestSeverity = severityOrder.find(sev => 
                    categoryIssues.some(issue => issue.severity === sev)
                );

                const categoryDiv = document.createElement('div');
                categoryDiv.className = `security-category category-${highestSeverity}`;
                
                const categoryHTML = `
                    <div class="category-header">
                        <h3 class="category-title">${category}</h3>
                        <span class="category-count">${categoryIssues.length}</span>
                    </div>
                    <div class="category-issues">
                        ${categoryIssues.map(issue => `
                            <div class="security-issue">
                                <div class="issue-title">
                                    <span class="status-badge status-${issue.severity === 'critical' ? 'not-done' : 
                                        issue.severity === 'high' ? 'pending' : 
                                        issue.severity === 'medium' ? 'default' : 'complete'}">
                                        ${issue.severity.toUpperCase()}
                                    </span>
                                    ${issue.title}
                                </div>
                                <div class="issue-description">${issue.description}</div>
                                ${issue.location ? `<div class="issue-location">${issue.location}</div>` : ''}
                                ${issue.code ? `<div class="issue-location">${escapeHtml(issue.code)}</div>` : ''}
                                <div class="issue-remediation">
                                    <strong>Remediation:</strong> ${issue.remediation}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
                
                categoryDiv.innerHTML = categoryHTML;
                categoriesContainer.appendChild(categoryDiv);
            });

            // Hide loading, show results
            document.getElementById('security-loading').style.display = 'none';
            document.getElementById('security-results').style.display = 'block';
        }

        function escapeHtml(unsafe) {
            return unsafe
                .replace(/&/g, "&amp;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;")
                .replace(/"/g, "&quot;")
                .replace(/'/g, "&#039;");
        }

        // Initialize
        loadReports();
        
        // Initialize language system
        initializeLanguage();
        
        // Initialize interactive features
        initializeKeyboardNavigation();
        
        // Initialize architecture interactions when architecture tab is shown
        setTimeout(() => {
            initializeArchitectureInteractions();
        }, 1000);

        // Architecture Functions
        window.architectureInitialized = false;

        function initializeArchitecture() {
            console.log('Initializing architecture interactions...');
            
            // Mark as initialized to avoid duplicate initialization
            if (window.architectureInitialized) return;
            window.architectureInitialized = true;
            
            // Initialize enhanced interactions
            initializeArchitectureInteractions();
            
            // Show keyboard help briefly when architecture loads
            showArchitectureHelp();

            // Add smooth scrolling animations
            addArchitectureAnimations();
            
            window.architectureInitialized = true;
        }

        function showArchitectureView(viewName) {
            // Update navigation buttons
            document.querySelectorAll('.arch-nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            // Hide all views
            document.querySelectorAll('.architecture-view').forEach(view => {
                view.classList.remove('active');
            });

            // Show selected view
            const targetView = document.getElementById('arch-' + viewName);
            if (targetView) {
                targetView.classList.add('active');
                
                // Trigger any view-specific animations
                if (viewName === 'overview') {
                    animateArchitectureDiagram();
                } else if (viewName === 'data-flow') {
                    animateDataFlow();
                }
            }
        }

        function showComponentTooltip(element, layerType) {
            // Remove any existing tooltips
            document.querySelectorAll('.arch-tooltip').forEach(t => t.remove());

            const tooltip = document.createElement('div');
            tooltip.className = 'arch-tooltip';
            tooltip.style.cssText = `
                position: absolute;
                background: #2c3e50;
                color: white;
                padding: 12px 16px;
                border-radius: 8px;
                font-size: 0.9rem;
                z-index: 1000;
                max-width: 250px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                pointer-events: none;
                opacity: 0;
                transition: opacity 0.3s ease;
            `;

            const rect = element.getBoundingClientRect();
            tooltip.style.left = (rect.left + rect.width / 2) + 'px';
            tooltip.style.top = (rect.top - 10) + 'px';
            tooltip.style.transform = 'translateX(-50%) translateY(-100%)';

            // Set tooltip content based on layer type
            const tooltipContent = getTooltipContent(layerType);
            tooltip.innerHTML = tooltipContent;

            document.body.appendChild(tooltip);
            
            // Trigger fade in
            setTimeout(() => {
                tooltip.style.opacity = '1';
            }, 10);

            // Auto remove after delay
            setTimeout(() => {
                if (tooltip.parentNode) {
                    tooltip.style.opacity = '0';
                    setTimeout(() => tooltip.remove(), 300);
                }
            }, 3000);
        }

        function getTooltipContent(layerType) {
            const tooltips = {
                'user': '<strong>Frontend Layer</strong><br/>React application with TypeScript running on Vite development server',
                'api': '<strong>API Gateway</strong><br/>Express.js server handling all API requests with CORS and authentication',
                'backend': '<strong>Business Logic</strong><br/>Core services for authentication, data processing, and file management',
                'database': '<strong>Data Storage</strong><br/>PostgreSQL database hosted on Railway cloud platform',
                'external': '<strong>External Services</strong><br/>Third-party integrations for SMS and email services',
                'cloud': '<strong>Cloud Infrastructure</strong><br/>Railway platform providing hosting, deployment, and monitoring'
            };
            return tooltips[layerType] || '<strong>System Component</strong><br/>Part of the bankDev2_standalone architecture';
        }

        function animateArchitectureDiagram() {
            const layers = document.querySelectorAll('.arch-layer');
            layers.forEach((layer, index) => {
                layer.style.opacity = '0';
                layer.style.transform = 'translateY(20px)';
                
                setTimeout(() => {
                    layer.style.transition = 'all 0.6s ease';
                    layer.style.opacity = '1';
                    layer.style.transform = 'translateY(0)';
                }, index * 150);
            });

            // Animate connections after layers
            setTimeout(() => {
                const connections = document.querySelector('.arch-connections');
                if (connections) {
                    connections.style.opacity = '0';
                    connections.style.transition = 'opacity 0.8s ease';
                    setTimeout(() => {
                        connections.style.opacity = '1';
                    }, 100);
                }
            }, layers.length * 150 + 300);
        }

        function animateDataFlow() {
            const flowSteps = document.querySelectorAll('.flow-step');
            flowSteps.forEach((step, index) => {
                step.style.opacity = '0';
                step.style.transform = 'scale(0.8)';
                
                setTimeout(() => {
                    step.style.transition = 'all 0.5s ease';
                    step.style.opacity = '1';
                    step.style.transform = 'scale(1)';
                }, index * 200);
            });
        }

        function addArchitectureAnimations() {
            // Add hover effects and animations
            const componentCards = document.querySelectorAll('.component-card');
            componentCards.forEach(card => {
                card.addEventListener('mouseenter', function() {
                    this.style.transform = 'translateY(-4px) scale(1.02)';
                });
                
                card.addEventListener('mouseleave', function() {
                    this.style.transform = 'translateY(0) scale(1)';
                });
            });

            // Add tech item animations
            const techItems = document.querySelectorAll('.tech-item');
            techItems.forEach(item => {
                item.addEventListener('mouseenter', function() {
                    const icon = this.querySelector('.tech-icon');
                    if (icon) {
                        icon.style.transform = 'scale(1.1) rotate(5deg)';
                        icon.style.transition = 'transform 0.3s ease';
                    }
                });
                
                item.addEventListener('mouseleave', function() {
                    const icon = this.querySelector('.tech-icon');
                    if (icon) {
                        icon.style.transform = 'scale(1) rotate(0deg)';
                    }
                });
            });
        }

        // Add click outside handler for tooltips
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.arch-layer')) {
                document.querySelectorAll('.arch-tooltip').forEach(t => {
                    t.style.opacity = '0';
                    setTimeout(() => t.remove(), 300);
                });
            }
        });
    </script>
</body>
</html>